**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 1 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.202482e+04    0.000e+00    2.118e+03
User objective function returned Inf; trying a new point...
    1      39    1.033014e+04    0.000e+00    4.887e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.475858e+03    0.000e+00    2.772e+02    9.999e-01
User objective function returned Inf; trying a new point...
    3      81    8.359155e+03    0.000e+00    9.825e+02    4.999e-01
User objective function returned Inf; trying a new point...
    4      99    8.248760e+03    0.000e+00    1.071e+03    9.999e-01
User objective function returned Inf; trying a new point...
    5     122    8.213110e+03    0.000e+00    4.588e+02    4.999e-01
User objective function returned Inf; trying a new point...
    6     140    8.208042e+03    0.000e+00    2.383e+02    5.000e-01
User objective function returned Inf; trying a new point...
    7     161    8.181693e+03    0.000e+00    3.283e+02    9.999e-01
User objective function returned Inf; trying a new point...
    8     179    8.130650e+03    0.000e+00    3.926e+02    9.999e-01
User objective function returned Inf; trying a new point...
    9     201    8.052564e+03    0.000e+00    6.633e+02    9.999e-01
User objective function returned Inf; trying a new point...
   10     220    8.030704e+03    0.000e+00    1.953e+02    9.999e-01
User objective function returned Inf; trying a new point...
   11     242    7.942304e+03    0.000e+00    8.239e+02    9.999e-01
User objective function returned Inf; trying a new point...
   12     266    7.936550e+03    0.000e+00    6.815e+02    2.500e-01
User objective function returned Inf; trying a new point...
   13     284    7.933485e+03    0.000e+00    6.483e+02    2.500e-01
User objective function returned Inf; trying a new point...
   14     305    7.899504e+03    0.000e+00    2.024e+02    4.999e-01
User objective function returned Inf; trying a new point...
   15     324    7.895110e+03    0.000e+00    4.639e+02    4.999e-01
User objective function returned Inf; trying a new point...
   16     346    7.878211e+03    0.000e+00    1.121e+02    5.000e-01
User objective function returned Inf; trying a new point...
   17     369    7.872264e+03    0.000e+00    2.847e+02    2.500e-01
User objective function returned Inf; trying a new point...
   18     388    7.872102e+03    0.000e+00    2.536e+02    2.500e-01
User objective function returned Inf; trying a new point...
   19     410    7.867761e+03    0.000e+00    1.219e+02    2.500e-01
User objective function returned Inf; trying a new point...
   20     433    7.865226e+03    0.000e+00    3.613e+01    1.250e-01
User objective function returned Inf; trying a new point...
   21     456    7.864327e+03    0.000e+00    2.974e+01    6.249e-02
   22     475    7.864232e+03    0.000e+00    3.165e+01    6.249e-02
   23     497    7.864130e+03    0.000e+00    4.086e+01    6.249e-02
   24     517    7.864128e+03    0.000e+00    4.474e+01    1.562e-02
   25     538    7.863878e+03    0.000e+00    2.369e+01    2.857e-02
   26     562    7.863798e+03    0.000e+00    3.841e+01    2.500e-02
   27     585    7.863762e+03    0.000e+00    3.247e+01    4.375e-02
   28     603    7.863750e+03    0.000e+00    3.697e+01    4.375e-02
   29     624    7.863611e+03    0.000e+00    3.316e+01    8.750e-02
   30     643    7.863583e+03    0.000e+00    2.444e+01    4.375e-02

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     664    7.863072e+03    0.000e+00    1.585e+01    8.750e-02
User objective function returned Inf; trying a new point...
   32     684    7.862805e+03    0.000e+00    2.138e+01    4.375e-02
   33     705    7.862720e+03    0.000e+00    1.203e+01    8.750e-02
   34     723    7.862653e+03    0.000e+00    1.416e+01    8.750e-02
   35     743    7.862614e+03    0.000e+00    2.695e+01    7.455e-02
   36     761    7.862422e+03    0.000e+00    1.440e+01    1.028e-01
   37     778    7.861984e+03    0.000e+00    4.957e+00    5.337e-02
   38     795    7.861976e+03    0.000e+00    2.368e+00    6.498e-03
   39     812    7.861974e+03    0.000e+00    5.728e-01    4.469e-03
   40     829    7.861974e+03    0.000e+00    7.282e-02    5.450e-04
   41     846    7.861974e+03    0.000e+00    1.752e-02    2.467e-04

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',8.441403e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 1.7295 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

   -0.0084
   -0.0112
   -0.0021
   -0.0036
    0.0002
   -0.0066
   -0.0181
    0.0013
    0.0018
    0.0024
    0.0029
    0.0024
    0.0013
   -0.0019
    0.0035
    0.0001

Value of the log-likelihood function at convergence: -7861.9742
 
                      AIC                      BIC
              ------------------   -----------------------
                  15755.9484               15826.2992
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 1.233e-07
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS          0.6850     0.0523    13.1080
A_SnGo         0.3816     0.0389     9.8117
A_AgeLT40      0.3591     0.0540     6.6480
A_ExpLT8       0.6090     0.0564    10.7974
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1          -1.5760     0.1242   -12.6917
Bc_2          -1.7405     0.1234   -14.1056
LV_Load        0.9732     0.0489    19.9167
Mu_12         -0.5899     0.0569   -10.3634
Mu_13         -0.6183     0.0531   -11.6480
Mu_14         -0.9508     0.0654   -14.5411
Mu_22         -0.5379     0.0534   -10.0769
Mu_23         -0.6740     0.0555   -12.1400
Mu_24         -0.8793     0.0646   -13.6188
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -0.8317     0.0347   -23.9808
C_VRC         -0.6169     0.0563   -10.9521
C_LV          -0.5144     0.0694    -7.4148
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    1.9472    0.9472
    0.9472    1.9472

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

    0.6850    0.3816    0.3591    0.6090   -1.5760   -1.7405    0.9732   -0.5899   -0.6183   -0.9508   -0.5379

  Columns 12 through 16

   -0.6740   -0.8793   -0.8317   -0.6169   -0.5144

The covariance matrix for these parameters is:

ihess =

  Columns 1 through 11

    0.0027    0.0002    0.0002    0.0004   -0.0030   -0.0029   -0.0011   -0.0004   -0.0004   -0.0004   -0.0003
    0.0002    0.0015    0.0002    0.0001   -0.0024   -0.0022   -0.0005   -0.0002   -0.0001   -0.0002   -0.0001
    0.0002    0.0002    0.0029    0.0003   -0.0011   -0.0010   -0.0005   -0.0002   -0.0001   -0.0002   -0.0001
    0.0004    0.0001    0.0003    0.0032   -0.0005   -0.0006   -0.0009   -0.0001   -0.0002   -0.0000   -0.0004
   -0.0030   -0.0024   -0.0011   -0.0005    0.0154    0.0140   -0.0017   -0.0001   -0.0004   -0.0002   -0.0010
   -0.0029   -0.0022   -0.0010   -0.0006    0.0140    0.0152   -0.0019   -0.0011   -0.0010   -0.0008   -0.0002
   -0.0011   -0.0005   -0.0005   -0.0009   -0.0017   -0.0019    0.0024    0.0010    0.0009    0.0009    0.0009
   -0.0004   -0.0002   -0.0002   -0.0001   -0.0001   -0.0011    0.0010    0.0032    0.0001    0.0004    0.0003
   -0.0004   -0.0001   -0.0001   -0.0002   -0.0004   -0.0010    0.0009    0.0001    0.0028    0.0001    0.0003
   -0.0004   -0.0002   -0.0002   -0.0000   -0.0002   -0.0008    0.0009    0.0004    0.0001    0.0043    0.0003
   -0.0003   -0.0001   -0.0001   -0.0004   -0.0010   -0.0002    0.0009    0.0003    0.0003    0.0003    0.0028
   -0.0004   -0.0002   -0.0002   -0.0003   -0.0009   -0.0005    0.0010    0.0005    0.0004    0.0004    0.0001
   -0.0005   -0.0001   -0.0002   -0.0003   -0.0009   -0.0007    0.0010    0.0005    0.0004    0.0004    0.0002
    0.0001   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000   -0.0000    0.0000   -0.0001
    0.0001   -0.0002    0.0000    0.0001    0.0004    0.0002   -0.0001   -0.0000    0.0000    0.0000   -0.0001
    0.0012    0.0009    0.0002    0.0001   -0.0025   -0.0023   -0.0007   -0.0002   -0.0002   -0.0003   -0.0002

  Columns 12 through 16

   -0.0004   -0.0005    0.0001    0.0001    0.0012
   -0.0002   -0.0001   -0.0000   -0.0002    0.0009
   -0.0002   -0.0002   -0.0000    0.0000    0.0002
   -0.0003   -0.0003   -0.0000    0.0001    0.0001
   -0.0009   -0.0009   -0.0000    0.0004   -0.0025
   -0.0005   -0.0007   -0.0000    0.0002   -0.0023
    0.0010    0.0010    0.0000   -0.0001   -0.0007
    0.0005    0.0005    0.0000   -0.0000   -0.0002
    0.0004    0.0004   -0.0000    0.0000   -0.0002
    0.0004    0.0004    0.0000    0.0000   -0.0003
    0.0001    0.0002   -0.0001   -0.0001   -0.0002
    0.0031    0.0001    0.0000   -0.0000   -0.0002
    0.0001    0.0042   -0.0000   -0.0002   -0.0002
    0.0000   -0.0000    0.0012    0.0006    0.0002
   -0.0000   -0.0002    0.0006    0.0032    0.0001
   -0.0002   -0.0002    0.0002    0.0001    0.0048

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 2 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.262477e+04    0.000e+00    2.448e+03
User objective function returned Inf; trying a new point...
    1      39    1.007885e+04    0.000e+00    4.629e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.424730e+03    0.000e+00    6.489e+02    9.999e-01
User objective function returned Inf; trying a new point...
    3      80    8.373836e+03    0.000e+00    1.411e+03    9.999e-01
User objective function returned Inf; trying a new point...
    4      98    8.185789e+03    0.000e+00    2.094e+03    9.999e-01
User objective function returned Inf; trying a new point...
    5     120    8.109029e+03    0.000e+00    8.457e+02    9.999e-01
User objective function returned Inf; trying a new point...
    6     139    8.052091e+03    0.000e+00    6.332e+02    4.999e-01
User objective function returned Inf; trying a new point...
    7     160    7.930558e+03    0.000e+00    3.482e+02    9.999e-01
User objective function returned Inf; trying a new point...
    8     179    7.768277e+03    0.000e+00    6.806e+02    9.999e-01
User objective function returned Inf; trying a new point...
    9     204    7.731203e+03    0.000e+00    3.453e+02    1.250e-01
User objective function returned Inf; trying a new point...
   10     222    7.697347e+03    0.000e+00    3.376e+02    2.500e-01
User objective function returned Inf; trying a new point...
   11     243    7.656126e+03    0.000e+00    3.400e+02    4.999e-01
User objective function returned Inf; trying a new point...
   12     263    7.647889e+03    0.000e+00    3.574e+02    2.500e-01
User objective function returned Inf; trying a new point...
   13     284    7.616494e+03    0.000e+00    1.549e+02    4.999e-01
User objective function returned Inf; trying a new point...
   14     303    7.604546e+03    0.000e+00    4.096e+02    5.000e-01
User objective function returned Inf; trying a new point...
   15     325    7.579170e+03    0.000e+00    8.224e+01    4.999e-01
User objective function returned Inf; trying a new point...
   16     348    7.575770e+03    0.000e+00    3.455e+02    2.500e-01
User objective function returned Inf; trying a new point...
   17     366    7.574147e+03    0.000e+00    2.822e+02    2.500e-01
User objective function returned Inf; trying a new point...
   18     388    7.566216e+03    0.000e+00    7.500e+01    2.500e-01
User objective function returned Inf; trying a new point...
   19     408    7.564939e+03    0.000e+00    1.227e+02    1.250e-01
User objective function returned Inf; trying a new point...
   20     429    7.564378e+03    0.000e+00    1.385e+02    2.500e-01
   21     448    7.563686e+03    0.000e+00    1.741e+02    1.250e-01
User objective function returned Inf; trying a new point...
   22     470    7.560635e+03    0.000e+00    4.579e+01    1.250e-01
User objective function returned Inf; trying a new point...
   23     490    7.560499e+03    0.000e+00    6.831e+01    6.249e-02
   24     511    7.559730e+03    0.000e+00    5.832e+01    1.250e-01
User objective function returned Inf; trying a new point...
   25     530    7.559685e+03    0.000e+00    1.041e+02    1.250e-01
   26     552    7.559513e+03    0.000e+00    6.131e+01    1.250e-01
User objective function returned Inf; trying a new point...
   27     570    7.559333e+03    0.000e+00    6.166e+01    1.250e-01
   28     592    7.557855e+03    0.000e+00    5.525e+01    1.250e-01
User objective function returned Inf; trying a new point...
   29     611    7.557597e+03    0.000e+00    8.765e+01    1.250e-01
   30     628    7.556104e+03    0.000e+00    5.293e+01    7.589e-02
User objective function returned Inf; trying a new point...

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     649    7.553685e+03    0.000e+00    1.554e+02    1.518e-01
   32     668    7.553283e+03    0.000e+00    2.329e+02    1.518e-01
   33     685    7.548330e+03    0.000e+00    1.589e+02    1.018e-01
   34     702    7.543760e+03    0.000e+00    2.007e+02    2.297e-01
   35     719    7.543307e+03    0.000e+00    8.325e+01    1.895e-01
   36     736    7.541642e+03    0.000e+00    8.546e+01    1.139e-01
   37     753    7.541258e+03    0.000e+00    6.070e+01    4.692e-02
   38     770    7.540951e+03    0.000e+00    2.444e+01    7.138e-02
   39     787    7.540901e+03    0.000e+00    4.507e+00    2.020e-02
   40     804    7.540896e+03    0.000e+00    1.198e+00    8.239e-03
   41     821    7.540895e+03    0.000e+00    3.486e-01    2.308e-03
   42     838    7.540895e+03    0.000e+00    2.300e-01    7.118e-04
   43     855    7.540895e+03    0.000e+00    3.920e-02    2.093e-04
   44     872    7.540895e+03    0.000e+00    1.727e-02    6.430e-05

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',4.205253e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 1.7636 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

   -0.0161
   -0.0173
   -0.0005
   -0.0016
   -0.0029
   -0.0039
   -0.0165
    0.0024
    0.0002
   -0.0007
    0.0028
    0.0006
    0.0006
    0.0034
   -0.0017
    0.0002

Value of the log-likelihood function at convergence: -7540.8954
 
                      AIC                      BIC
              ------------------   -----------------------
                  15113.7908               15184.1417
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 1.7363e-07
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS          0.6478     0.0513    12.6187
A_SnGo         0.3319     0.0442     7.5055
A_AgeLT40      1.0818     0.0666    16.2543
A_ExpLT8       1.0205     0.0640    15.9336
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1          -1.5197     0.1175   -12.9299
Bc_2          -1.7178     0.1182   -14.5387
LV_Load        0.9443     0.0466    20.2661
Mu_12         -0.6475     0.0610   -10.6200
Mu_13         -0.5627     0.0537   -10.4877
Mu_14         -0.5461     0.0546   -10.0003
Mu_22         -0.3031     0.0496    -6.1054
Mu_23         -0.4528     0.0509    -8.8978
Mu_24         -1.0260     0.0685   -14.9673
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -0.9795     0.0376   -26.0510
C_VRC         -0.8350     0.0602   -13.8803
C_LV          -0.0822     0.0618    -1.3299
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    1.8917    0.8917
    0.8917    1.8917

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

    0.6478    0.3319    1.0818    1.0205   -1.5197   -1.7178    0.9443   -0.6475   -0.5627   -0.5461   -0.3031

  Columns 12 through 16

   -0.4528   -1.0260   -0.9795   -0.8350   -0.0822

The covariance matrix for these parameters is:

ihess =

  Columns 1 through 11

    0.0026   -0.0000    0.0006    0.0005   -0.0029   -0.0029   -0.0007   -0.0002   -0.0002   -0.0002   -0.0002
   -0.0000    0.0020    0.0006    0.0004   -0.0024   -0.0023   -0.0007   -0.0001   -0.0002   -0.0002   -0.0003
    0.0006    0.0006    0.0044    0.0010   -0.0005   -0.0004   -0.0016   -0.0006   -0.0004   -0.0004   -0.0006
    0.0005    0.0004    0.0010    0.0041   -0.0003   -0.0002   -0.0015   -0.0005   -0.0005   -0.0003   -0.0004
   -0.0029   -0.0024   -0.0005   -0.0003    0.0138    0.0127   -0.0012   -0.0000   -0.0002   -0.0005   -0.0009
   -0.0029   -0.0023   -0.0004   -0.0002    0.0127    0.0140   -0.0014   -0.0010   -0.0008   -0.0008   -0.0001
   -0.0007   -0.0007   -0.0016   -0.0015   -0.0012   -0.0014    0.0022    0.0009    0.0008    0.0008    0.0010
   -0.0002   -0.0001   -0.0006   -0.0005   -0.0000   -0.0010    0.0009    0.0037   -0.0000    0.0002    0.0005
   -0.0002   -0.0002   -0.0004   -0.0005   -0.0002   -0.0008    0.0008   -0.0000    0.0029    0.0001    0.0005
   -0.0002   -0.0002   -0.0004   -0.0003   -0.0005   -0.0008    0.0008    0.0002    0.0001    0.0030    0.0005
   -0.0002   -0.0003   -0.0006   -0.0004   -0.0009   -0.0001    0.0010    0.0005    0.0005    0.0005    0.0025
   -0.0001   -0.0003   -0.0006   -0.0005   -0.0008   -0.0004    0.0008    0.0004    0.0003    0.0003    0.0000
   -0.0001   -0.0002   -0.0005   -0.0005   -0.0007   -0.0005    0.0008    0.0003    0.0003    0.0003    0.0002
   -0.0000    0.0000   -0.0000    0.0001   -0.0002   -0.0002    0.0001    0.0000    0.0001    0.0002    0.0000
    0.0000    0.0000    0.0000    0.0000    0.0001    0.0001   -0.0001   -0.0000   -0.0000   -0.0001   -0.0001
   -0.0002    0.0007    0.0002    0.0001   -0.0007   -0.0006   -0.0002    0.0001    0.0000    0.0000   -0.0000

  Columns 12 through 16

   -0.0001   -0.0001   -0.0000    0.0000   -0.0002
   -0.0003   -0.0002    0.0000    0.0000    0.0007
   -0.0006   -0.0005   -0.0000    0.0000    0.0002
   -0.0005   -0.0005    0.0001    0.0000    0.0001
   -0.0008   -0.0007   -0.0002    0.0001   -0.0007
   -0.0004   -0.0005   -0.0002    0.0001   -0.0006
    0.0008    0.0008    0.0001   -0.0001   -0.0002
    0.0004    0.0003    0.0000   -0.0000    0.0001
    0.0003    0.0003    0.0001   -0.0000    0.0000
    0.0003    0.0003    0.0002   -0.0001    0.0000
    0.0000    0.0002    0.0000   -0.0001   -0.0000
    0.0026   -0.0001    0.0001   -0.0001   -0.0001
   -0.0001    0.0047    0.0000   -0.0001   -0.0001
    0.0001    0.0000    0.0014    0.0009    0.0001
   -0.0001   -0.0001    0.0009    0.0036    0.0003
   -0.0001   -0.0001    0.0001    0.0003    0.0038

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 3 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.218459e+04    0.000e+00    2.194e+03
User objective function returned Inf; trying a new point...
    1      39    1.042303e+04    0.000e+00    5.087e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.526855e+03    0.000e+00    3.551e+02    9.999e-01
User objective function returned Inf; trying a new point...
    3      81    8.350906e+03    0.000e+00    8.814e+02    4.999e-01
User objective function returned Inf; trying a new point...
    4      99    8.150854e+03    0.000e+00    3.724e+02    9.999e-01
User objective function returned Inf; trying a new point...
    5     123    8.117921e+03    0.000e+00    1.141e+02    2.500e-01
User objective function returned Inf; trying a new point...
    6     141    8.097374e+03    0.000e+00    1.676e+02    4.999e-01
User objective function returned Inf; trying a new point...
    7     162    8.097231e+03    0.000e+00    3.435e+02    9.999e-01
User objective function returned Inf; trying a new point...
    8     181    8.079151e+03    0.000e+00    5.674e+02    5.000e-01
User objective function returned Inf; trying a new point...
    9     203    8.022476e+03    0.000e+00    8.580e+02    5.000e-01
User objective function returned Inf; trying a new point...
   10     222    8.011424e+03    0.000e+00    4.137e+02    4.999e-01
User objective function returned Inf; trying a new point...
   11     244    7.982523e+03    0.000e+00    1.839e+02    5.000e-01
User objective function returned Inf; trying a new point...
   12     264    7.977137e+03    0.000e+00    7.592e+01    2.500e-01
User objective function returned Inf; trying a new point...
   13     286    7.966866e+03    0.000e+00    6.792e+01    2.500e-01
User objective function returned Inf; trying a new point...
   14     306    7.965982e+03    0.000e+00    7.093e+01    1.250e-01
User objective function returned Inf; trying a new point...
   15     327    7.963599e+03    0.000e+00    4.514e+01    2.500e-01
User objective function returned Inf; trying a new point...
   16     347    7.962471e+03    0.000e+00    2.579e+01    1.250e-01
User objective function returned Inf; trying a new point...
   17     369    7.960625e+03    0.000e+00    3.490e+01    1.250e-01
User objective function returned Inf; trying a new point...
   18     389    7.960313e+03    0.000e+00    4.773e+01    6.249e-02
   19     411    7.959903e+03    0.000e+00    3.274e+01    6.249e-02
User objective function returned Inf; trying a new point...
   20     430    7.959854e+03    0.000e+00    1.783e+01    6.249e-02
   21     451    7.959526e+03    0.000e+00    2.093e+01    1.250e-01
User objective function returned Inf; trying a new point...
   22     475    7.959305e+03    0.000e+00    4.039e+01    3.125e-02
   23     494    7.959288e+03    0.000e+00    3.962e+01    3.125e-02
   24     515    7.959129e+03    0.000e+00    2.392e+01    6.249e-02
   25     538    7.959009e+03    0.000e+00    1.430e+01    3.125e-02
   26     558    7.959008e+03    0.000e+00    1.421e+01    1.562e-02
   27     579    7.958770e+03    0.000e+00    1.589e+01    3.125e-02
   28     603    7.958652e+03    0.000e+00    1.124e+01    2.734e-02
   29     625    7.958521e+03    0.000e+00    6.023e+00    2.734e-02
   30     649    7.958511e+03    0.000e+00    5.821e+00    2.392e-02

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     669    7.958511e+03    0.000e+00    5.368e+00    5.981e-03
   32     690    7.958482e+03    0.000e+00    4.082e+00    1.196e-02
   33     709    7.958473e+03    0.000e+00    4.206e+00    1.196e-02
   34     731    7.958468e+03    0.000e+00    2.546e+00    1.196e-02
   35     750    7.958467e+03    0.000e+00    2.255e+00    5.981e-03
   36     768    7.958461e+03    0.000e+00    1.133e+00    1.058e-02
   37     785    7.958460e+03    0.000e+00    6.583e-02    1.638e-03
   38     802    7.958460e+03    0.000e+00    3.821e-02    2.824e-04
   39     819    7.958460e+03    0.000e+00    2.137e-03    1.669e-05

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',8.034587e-06,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 1.7362 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

   -0.0018
   -0.0021
   -0.0007
   -0.0006
   -0.0004
   -0.0010
   -0.0013
    0.0001
         0
    0.0002
    0.0004
    0.0003
         0
   -0.0001
   -0.0001
   -0.0002

Value of the log-likelihood function at convergence: -7958.46
 
                      AIC                      BIC
              ------------------   -----------------------
                  15948.9200               16019.2709
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 3.0975e-09
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS          0.5851     0.0525    11.1492
A_SnGo        -0.0761     0.0268    -2.8419
A_AgeLT40      0.6176     0.0569    10.8533
A_ExpLT8       0.3618     0.0528     6.8540
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1          -0.4171     0.1059    -3.9384
Bc_2          -0.4662     0.1062    -4.3881
LV_Load        0.9399     0.0462    20.3588
Mu_12         -0.6328     0.0545   -11.6112
Mu_13         -0.8430     0.0586   -14.3832
Mu_14         -0.4960     0.0511    -9.7030
Mu_22         -0.4989     0.0503    -9.9160
Mu_23         -0.6733     0.0556   -12.0991
Mu_24         -0.7185     0.0577   -12.4546
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -1.0158     0.0397   -25.5856
C_VRC         -0.8937     0.0634   -14.0993
C_LV          -1.1624     0.1499    -7.7540
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    1.8834    0.8834
    0.8834    1.8834

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

    0.5851   -0.0761    0.6176    0.3618   -0.4171   -0.4662    0.9399   -0.6328   -0.8430   -0.4960   -0.4989

  Columns 12 through 16

   -0.6733   -0.7185   -1.0158   -0.8937   -1.1624

The covariance matrix for these parameters is:

ihess =

  Columns 1 through 11

    0.0028   -0.0001    0.0003    0.0001   -0.0037   -0.0038   -0.0008   -0.0002   -0.0003   -0.0002   -0.0002
   -0.0001    0.0007    0.0000   -0.0001   -0.0013   -0.0012    0.0001    0.0000    0.0001    0.0000    0.0000
    0.0003    0.0000    0.0032    0.0003   -0.0011   -0.0010   -0.0009   -0.0003   -0.0003   -0.0003   -0.0002
    0.0001   -0.0001    0.0003    0.0028   -0.0010   -0.0010   -0.0005   -0.0002   -0.0002   -0.0001   -0.0001
   -0.0037   -0.0013   -0.0011   -0.0010    0.0112    0.0100   -0.0005    0.0005    0.0002   -0.0000   -0.0003
   -0.0038   -0.0012   -0.0010   -0.0010    0.0100    0.0113   -0.0005   -0.0004   -0.0004   -0.0004    0.0004
   -0.0008    0.0001   -0.0009   -0.0005   -0.0005   -0.0005    0.0021    0.0009    0.0009    0.0009    0.0009
   -0.0002    0.0000   -0.0003   -0.0002    0.0005   -0.0004    0.0009    0.0030    0.0000    0.0002    0.0003
   -0.0003    0.0001   -0.0003   -0.0002    0.0002   -0.0004    0.0009    0.0000    0.0034    0.0001    0.0003
   -0.0002    0.0000   -0.0003   -0.0001   -0.0000   -0.0004    0.0009    0.0002    0.0001    0.0026    0.0004
   -0.0002    0.0000   -0.0002   -0.0001   -0.0003    0.0004    0.0009    0.0003    0.0003    0.0004    0.0025
   -0.0003    0.0001   -0.0003   -0.0002   -0.0003    0.0001    0.0009    0.0004    0.0004    0.0004    0.0001
   -0.0002    0.0000   -0.0003   -0.0002   -0.0004   -0.0001    0.0009    0.0004    0.0004    0.0004    0.0002
    0.0000    0.0000    0.0001    0.0000   -0.0001   -0.0001   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000
   -0.0000   -0.0000    0.0000    0.0000    0.0001    0.0001   -0.0000    0.0000   -0.0000   -0.0000   -0.0000
    0.0055   -0.0000    0.0008    0.0003   -0.0077   -0.0077   -0.0016   -0.0004   -0.0005   -0.0007   -0.0004

  Columns 12 through 16

   -0.0003   -0.0002    0.0000   -0.0000    0.0055
    0.0001    0.0000    0.0000   -0.0000   -0.0000
   -0.0003   -0.0003    0.0001    0.0000    0.0008
   -0.0002   -0.0002    0.0000    0.0000    0.0003
   -0.0003   -0.0004   -0.0001    0.0001   -0.0077
    0.0001   -0.0001   -0.0001    0.0001   -0.0077
    0.0009    0.0009   -0.0000   -0.0000   -0.0016
    0.0004    0.0004   -0.0000    0.0000   -0.0004
    0.0004    0.0004   -0.0000   -0.0000   -0.0005
    0.0004    0.0004   -0.0000   -0.0000   -0.0007
    0.0001    0.0002   -0.0000   -0.0000   -0.0004
    0.0031    0.0001   -0.0000    0.0001   -0.0007
    0.0001    0.0033   -0.0000   -0.0000   -0.0005
   -0.0000   -0.0000    0.0016    0.0011    0.0013
    0.0001   -0.0000    0.0011    0.0040    0.0013
   -0.0007   -0.0005    0.0013    0.0013    0.0225

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 4 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.181091e+04    0.000e+00    2.185e+03
User objective function returned Inf; trying a new point...
    1      39    1.043418e+04    0.000e+00    5.031e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.532212e+03    0.000e+00    2.953e+02    9.999e-01
User objective function returned Inf; trying a new point...
    3      80    8.410483e+03    0.000e+00    1.542e+03    9.999e-01
User objective function returned Inf; trying a new point...
    4      99    8.307710e+03    0.000e+00    1.467e+03    9.999e-01
User objective function returned Inf; trying a new point...
    5     122    8.129381e+03    0.000e+00    2.828e+02    4.999e-01
User objective function returned Inf; trying a new point...
    6     142    8.109644e+03    0.000e+00    1.615e+02    2.500e-01
User objective function returned Inf; trying a new point...
    7     163    8.069667e+03    0.000e+00    5.326e+02    4.999e-01
User objective function returned Inf; trying a new point...
    8     182    8.051310e+03    0.000e+00    5.264e+02    4.999e-01
User objective function returned Inf; trying a new point...
    9     203    8.015878e+03    0.000e+00    2.403e+02    9.999e-01
User objective function returned Inf; trying a new point...
   10     226    7.982298e+03    0.000e+00    1.533e+02    4.999e-01
User objective function returned Inf; trying a new point...
   11     246    7.980738e+03    0.000e+00    2.234e+02    2.500e-01
User objective function returned Inf; trying a new point...
   12     267    7.963346e+03    0.000e+00    2.079e+02    5.000e-01
User objective function returned Inf; trying a new point...
   13     287    7.958988e+03    0.000e+00    2.984e+02    2.500e-01
User objective function returned Inf; trying a new point...
   14     308    7.936435e+03    0.000e+00    1.240e+02    5.000e-01
User objective function returned Inf; trying a new point...
   15     326    7.889092e+03    0.000e+00    1.759e+02    9.999e-01
User objective function returned Inf; trying a new point...
   16     348    7.826077e+03    0.000e+00    2.890e+02    9.999e-01
User objective function returned Inf; trying a new point...
   17     368    7.823060e+03    0.000e+00    3.065e+02    4.999e-01
User objective function returned Inf; trying a new point...
   18     390    7.815894e+03    0.000e+00    4.868e+02    4.999e-01
User objective function returned Inf; trying a new point...
   19     410    7.811885e+03    0.000e+00    3.569e+02    1.250e-01
User objective function returned Inf; trying a new point...
   20     431    7.773095e+03    0.000e+00    3.787e+01    2.500e-01
User objective function returned Inf; trying a new point...
   21     455    7.771064e+03    0.000e+00    4.631e+01    2.187e-01
   22     475    7.770972e+03    0.000e+00    4.839e+01    5.468e-02
   23     496    7.767332e+03    0.000e+00    2.301e+01    1.094e-01
User objective function returned Inf; trying a new point...
   24     515    7.767311e+03    0.000e+00    3.425e+01    1.094e-01
User objective function returned Inf; trying a new point...
   25     536    7.764643e+03    0.000e+00    6.770e+01    2.187e-01
User objective function returned Inf; trying a new point...
   26     558    7.763426e+03    0.000e+00    2.663e+01    2.187e-01
User objective function returned Inf; trying a new point...
   27     580    7.761440e+03    0.000e+00    1.902e+01    2.187e-01
User objective function returned Inf; trying a new point...
   28     603    7.759845e+03    0.000e+00    4.006e+01    1.094e-01
   29     625    7.759781e+03    0.000e+00    5.080e+01    1.094e-01
   30     644    7.759610e+03    0.000e+00    4.746e+01    5.468e-02

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     665    7.758704e+03    0.000e+00    1.944e+01    1.094e-01
   32     688    7.758425e+03    0.000e+00    1.977e+01    5.468e-02
   33     710    7.758256e+03    0.000e+00    1.131e+01    5.468e-02
   34     730    7.758226e+03    0.000e+00    1.455e+01    2.734e-02
   35     751    7.758135e+03    0.000e+00    1.250e+01    5.468e-02
   36     774    7.758049e+03    0.000e+00    2.749e+00    2.734e-02
   37     799    7.758041e+03    0.000e+00    6.095e+00    1.196e-02
   38     820    7.758040e+03    0.000e+00    4.292e+00    2.392e-02
   39     839    7.758039e+03    0.000e+00    4.506e+00    1.196e-02
   40     856    7.758029e+03    0.000e+00    1.808e+00    1.519e-02
   41     873    7.758026e+03    0.000e+00    4.553e+00    7.086e-03
   42     890    7.758024e+03    0.000e+00    3.862e+00    2.266e-03
   43     907    7.758017e+03    0.000e+00    1.613e+00    6.830e-03
   44     924    7.758011e+03    0.000e+00    1.463e+00    6.323e-03
   45     941    7.758009e+03    0.000e+00    4.170e-01    5.494e-03
   46     958    7.758008e+03    0.000e+00    3.213e-01    1.873e-03
   47     975    7.758008e+03    0.000e+00    1.054e-01    6.029e-04
   48     992    7.758008e+03    0.000e+00    1.667e-03    1.159e-04

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',4.367460e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 2.0296 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

    0.0004
    0.0013
    0.0002
   -0.0001
   -0.0003
    0.0008
    0.0016
   -0.0007
   -0.0012
   -0.0002
   -0.0002
   -0.0002
   -0.0004
   -0.0015
    0.0001
    0.0001

Value of the log-likelihood function at convergence: -7758.0083
 
                      AIC                      BIC
              ------------------   -----------------------
                  15548.0167               15618.3676
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 1.1446e-08
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS          0.6596     0.0491    13.4332
A_SnGo         0.2577     0.0317     8.1242
A_AgeLT40      0.5237     0.0542     9.6566
A_ExpLT8       0.7726     0.0571    13.5396
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1          -1.3322     0.1228   -10.8454
Bc_2          -1.6139     0.1255   -12.8622
LV_Load        0.9595     0.0473    20.2961
Mu_12         -0.7038     0.0592   -11.8826
Mu_13         -0.6916     0.0575   -12.0358
Mu_14         -0.5107     0.0538    -9.4959
Mu_22         -0.5315     0.0514   -10.3420
Mu_23         -0.3579     0.0471    -7.5998
Mu_24         -0.9711     0.0686   -14.1569
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -0.9938     0.0406   -24.4791
C_VRC         -0.8923     0.0633   -14.1070
C_LV          -0.9497     0.1068    -8.8883
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    1.9207    0.9207
    0.9207    1.9207

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

    0.6596    0.2577    0.5237    0.7726   -1.3322   -1.6139    0.9595   -0.7038   -0.6916   -0.5107   -0.5315

  Columns 12 through 16

   -0.3579   -0.9711   -0.9938   -0.8923   -0.9497

The covariance matrix for these parameters is:

ihess =

  Columns 1 through 11

    0.0024    0.0006    0.0005    0.0006   -0.0037   -0.0036   -0.0010   -0.0004   -0.0003   -0.0003   -0.0003
    0.0006    0.0010    0.0003    0.0000   -0.0023   -0.0023   -0.0003   -0.0001   -0.0001   -0.0001   -0.0002
    0.0005    0.0003    0.0029    0.0003   -0.0013   -0.0013   -0.0007   -0.0002   -0.0002   -0.0002   -0.0003
    0.0006    0.0000    0.0003    0.0033   -0.0006   -0.0005   -0.0011   -0.0003   -0.0004   -0.0003   -0.0003
   -0.0037   -0.0023   -0.0013   -0.0006    0.0151    0.0141   -0.0012    0.0003   -0.0003   -0.0006   -0.0006
   -0.0036   -0.0023   -0.0013   -0.0005    0.0141    0.0157   -0.0015   -0.0008   -0.0010   -0.0011    0.0000
   -0.0010   -0.0003   -0.0007   -0.0011   -0.0012   -0.0015    0.0022    0.0009    0.0009    0.0009    0.0009
   -0.0004   -0.0001   -0.0002   -0.0003    0.0003   -0.0008    0.0009    0.0035    0.0001    0.0001    0.0004
   -0.0003   -0.0001   -0.0002   -0.0004   -0.0003   -0.0010    0.0009    0.0001    0.0033    0.0001    0.0004
   -0.0003   -0.0001   -0.0002   -0.0003   -0.0006   -0.0011    0.0009    0.0001    0.0001    0.0029    0.0004
   -0.0003   -0.0002   -0.0003   -0.0003   -0.0006    0.0000    0.0009    0.0004    0.0004    0.0004    0.0026
   -0.0002   -0.0001   -0.0002   -0.0003   -0.0008   -0.0005    0.0009    0.0004    0.0004    0.0003    0.0000
   -0.0003   -0.0002   -0.0003   -0.0004   -0.0005   -0.0004    0.0009    0.0004    0.0005    0.0004    0.0002
   -0.0000    0.0001    0.0000    0.0000   -0.0001   -0.0000   -0.0000   -0.0001   -0.0000   -0.0000    0.0000
   -0.0001    0.0001    0.0000   -0.0001    0.0001    0.0000    0.0000    0.0000    0.0001   -0.0000    0.0000
    0.0031    0.0016    0.0008    0.0008   -0.0062   -0.0061   -0.0014   -0.0005   -0.0004   -0.0004   -0.0005

  Columns 12 through 16

   -0.0002   -0.0003   -0.0000   -0.0001    0.0031
   -0.0001   -0.0002    0.0001    0.0001    0.0016
   -0.0002   -0.0003    0.0000    0.0000    0.0008
   -0.0003   -0.0004    0.0000   -0.0001    0.0008
   -0.0008   -0.0005   -0.0001    0.0001   -0.0062
   -0.0005   -0.0004   -0.0000    0.0000   -0.0061
    0.0009    0.0009   -0.0000    0.0000   -0.0014
    0.0004    0.0004   -0.0001    0.0000   -0.0005
    0.0004    0.0005   -0.0000    0.0001   -0.0004
    0.0003    0.0004   -0.0000   -0.0000   -0.0004
    0.0000    0.0002    0.0000    0.0000   -0.0005
    0.0022    0.0000    0.0000    0.0000   -0.0004
    0.0000    0.0047   -0.0000    0.0001   -0.0005
    0.0000   -0.0000    0.0016    0.0010    0.0010
    0.0000    0.0001    0.0010    0.0040    0.0009
   -0.0004   -0.0005    0.0010    0.0009    0.0114

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 5 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.205560e+04    0.000e+00    2.208e+03
User objective function returned Inf; trying a new point...
    1      39    1.051659e+04    0.000e+00    5.106e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.646571e+03    0.000e+00    3.512e+02    9.999e-01
User objective function returned Inf; trying a new point...
    3      81    8.450711e+03    0.000e+00    7.694e+02    4.999e-01
User objective function returned Inf; trying a new point...
    4     100    8.313551e+03    0.000e+00    1.743e+02    1.750e+00
User objective function returned Inf; trying a new point...
    5     123    8.271754e+03    0.000e+00    8.063e+02    8.749e-01
User objective function returned Inf; trying a new point...
    6     143    8.255162e+03    0.000e+00    9.209e+02    2.187e-01
User objective function returned Inf; trying a new point...
    7     164    8.185316e+03    0.000e+00    1.931e+02    4.375e-01
User objective function returned Inf; trying a new point...
    8     182    8.179876e+03    0.000e+00    4.445e+02    8.749e-01
User objective function returned Inf; trying a new point...
    9     204    8.141832e+03    0.000e+00    3.395e+02    8.749e-01
User objective function returned Inf; trying a new point...
   10     223    8.124972e+03    0.000e+00    3.375e+02    4.375e-01
User objective function returned Inf; trying a new point...
   11     244    8.048457e+03    0.000e+00    2.504e+02    8.749e-01
User objective function returned Inf; trying a new point...
   12     269    8.043286e+03    0.000e+00    3.076e+02    1.094e-01
User objective function returned Inf; trying a new point...
   13     287    8.035903e+03    0.000e+00    2.903e+02    1.094e-01
User objective function returned Inf; trying a new point...
   14     308    8.018545e+03    0.000e+00    1.455e+02    2.187e-01
User objective function returned Inf; trying a new point...
   15     328    8.016087e+03    0.000e+00    1.139e+02    1.094e-01
User objective function returned Inf; trying a new point...
   16     349    8.010228e+03    0.000e+00    7.779e+01    2.187e-01
User objective function returned Inf; trying a new point...
   17     369    8.005545e+03    0.000e+00    7.665e+01    3.828e-01
User objective function returned Inf; trying a new point...
   18     392    8.002675e+03    0.000e+00    6.432e+01    1.914e-01
User objective function returned Inf; trying a new point...
   19     412    8.002286e+03    0.000e+00    9.417e+01    9.569e-02
   20     433    8.001942e+03    0.000e+00    7.331e+01    1.914e-01
User objective function returned Inf; trying a new point...
   21     451    8.001135e+03    0.000e+00    1.075e+02    1.914e-01
   22     474    7.999630e+03    0.000e+00    5.997e+01    9.569e-02
   23     494    7.999488e+03    0.000e+00    6.870e+01    4.785e-02
   24     516    7.999245e+03    0.000e+00    3.344e+01    4.785e-02
   25     536    7.999191e+03    0.000e+00    1.767e+01    2.392e-02
   26     558    7.998982e+03    0.000e+00    1.564e+01    2.392e-02
User objective function returned Inf; trying a new point...
   27     578    7.998963e+03    0.000e+00    3.171e+01    4.187e-02
   28     599    7.998636e+03    0.000e+00    3.240e+01    4.211e-02
User objective function returned Inf; trying a new point...
   29     622    7.998345e+03    0.000e+00    1.573e+01    7.369e-02
   30     644    7.998153e+03    0.000e+00    3.232e+01    7.369e-02

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     664    7.998043e+03    0.000e+00    1.539e+01    3.684e-02
   32     686    7.997763e+03    0.000e+00    6.848e+00    3.684e-02
   33     711    7.997738e+03    0.000e+00    2.522e+00    1.612e-02
   34     731    7.997732e+03    0.000e+00    2.152e+00    8.060e-03
   35     748    7.997728e+03    0.000e+00    3.815e-01    5.808e-03
   36     765    7.997728e+03    0.000e+00    1.142e-01    8.931e-04
   37     782    7.997728e+03    0.000e+00    2.743e-03    1.257e-04

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',4.779662e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 1.6135 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

   -0.0026
    0.0012
    0.0007
   -0.0018
   -0.0001
   -0.0017
   -0.0028
   -0.0004
    0.0013
   -0.0004
    0.0005
   -0.0010
   -0.0009
   -0.0003
   -0.0005
   -0.0015

Value of the log-likelihood function at convergence: -7997.7281
 
                      AIC                      BIC
              ------------------   -----------------------
                  16027.4563               16097.8071
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 5.7759e-08
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS          0.6692     0.0456    14.6676
A_SnGo         0.2531     0.0342     7.3986
A_AgeLT40      0.3370     0.0503     6.6998
A_ExpLT8       0.4896     0.0521     9.3902
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1          -1.2281     0.1186   -10.3530
Bc_2          -1.3607     0.1170   -11.6318
LV_Load        1.0381     0.0479    21.6721
Mu_12         -0.5986     0.0551   -10.8630
Mu_13         -0.6335     0.0553   -11.4559
Mu_14         -0.4186     0.0503    -8.3183
Mu_22         -0.2565     0.0459    -5.5835
Mu_23         -0.8295     0.0613   -13.5223
Mu_24         -0.7507     0.0599   -12.5336
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -0.9143     0.0368   -24.8229
C_VRC         -0.6337     0.0585   -10.8319
C_LV          -0.6187     0.0831    -7.4441
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    2.0776    1.0776
    1.0776    2.0776

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

    0.6692    0.2531    0.3370    0.4896   -1.2281   -1.3607    1.0381   -0.5986   -0.6335   -0.4186   -0.2565

  Columns 12 through 16

   -0.8295   -0.7507   -0.9143   -0.6337   -0.6187

The covariance matrix for these parameters is:

ihess =

  Columns 1 through 11

    0.0021    0.0001    0.0000    0.0002   -0.0028   -0.0027   -0.0007   -0.0002   -0.0003   -0.0002   -0.0001
    0.0001    0.0012    0.0001   -0.0001   -0.0021   -0.0021   -0.0003   -0.0001   -0.0001   -0.0001   -0.0001
    0.0000    0.0001    0.0025    0.0001   -0.0008   -0.0008   -0.0004   -0.0000   -0.0001   -0.0001   -0.0001
    0.0002   -0.0001    0.0001    0.0027   -0.0007   -0.0005   -0.0006   -0.0001   -0.0002   -0.0002   -0.0001
   -0.0028   -0.0021   -0.0008   -0.0007    0.0141    0.0125   -0.0016   -0.0001    0.0000   -0.0007   -0.0011
   -0.0027   -0.0021   -0.0008   -0.0005    0.0125    0.0137   -0.0017   -0.0010   -0.0006   -0.0010   -0.0004
   -0.0007   -0.0003   -0.0004   -0.0006   -0.0016   -0.0017    0.0023    0.0009    0.0009    0.0009    0.0009
   -0.0002   -0.0001   -0.0000   -0.0001   -0.0001   -0.0010    0.0009    0.0030    0.0001    0.0002    0.0004
   -0.0003   -0.0001   -0.0001   -0.0002    0.0000   -0.0006    0.0009    0.0001    0.0031    0.0000    0.0004
   -0.0002   -0.0001   -0.0001   -0.0002   -0.0007   -0.0010    0.0009    0.0002    0.0000    0.0025    0.0004
   -0.0001   -0.0001   -0.0001   -0.0001   -0.0011   -0.0004    0.0009    0.0004    0.0004    0.0004    0.0021
   -0.0001   -0.0001   -0.0002   -0.0001   -0.0011   -0.0006    0.0010    0.0004    0.0003    0.0005    0.0001
   -0.0002   -0.0001   -0.0002   -0.0001   -0.0009   -0.0006    0.0010    0.0004    0.0004    0.0004    0.0002
    0.0000    0.0000   -0.0000    0.0000   -0.0001   -0.0001   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000
    0.0001   -0.0000    0.0000    0.0001   -0.0002   -0.0001   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000
    0.0014    0.0010    0.0002    0.0002   -0.0035   -0.0033   -0.0007   -0.0003   -0.0002   -0.0002   -0.0001

  Columns 12 through 16

   -0.0001   -0.0002    0.0000    0.0001    0.0014
   -0.0001   -0.0001    0.0000   -0.0000    0.0010
   -0.0002   -0.0002   -0.0000    0.0000    0.0002
   -0.0001   -0.0001    0.0000    0.0001    0.0002
   -0.0011   -0.0009   -0.0001   -0.0002   -0.0035
   -0.0006   -0.0006   -0.0001   -0.0001   -0.0033
    0.0010    0.0010   -0.0000   -0.0000   -0.0007
    0.0004    0.0004   -0.0000   -0.0000   -0.0003
    0.0003    0.0004   -0.0000   -0.0000   -0.0002
    0.0005    0.0004   -0.0000   -0.0000   -0.0002
    0.0001    0.0002   -0.0000   -0.0000   -0.0001
    0.0038    0.0001   -0.0000    0.0001   -0.0001
    0.0001    0.0036   -0.0000    0.0000   -0.0002
   -0.0000   -0.0000    0.0014    0.0008    0.0004
    0.0001    0.0000    0.0008    0.0034    0.0006
   -0.0001   -0.0002    0.0004    0.0006    0.0069

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 6 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.269041e+04    0.000e+00    2.487e+03
User objective function returned Inf; trying a new point...
    1      39    1.022199e+04    0.000e+00    4.747e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.585463e+03    0.000e+00    6.611e+02    9.999e-01
User objective function returned Inf; trying a new point...
    3      81    8.482322e+03    0.000e+00    1.354e+03    4.999e-01
User objective function returned Inf; trying a new point...
    4      99    8.350874e+03    0.000e+00    1.439e+03    5.000e-01
User objective function returned Inf; trying a new point...
    5     121    8.212038e+03    0.000e+00    2.466e+02    4.999e-01
User objective function returned Inf; trying a new point...
    6     141    8.201562e+03    0.000e+00    2.759e+02    2.500e-01
User objective function returned Inf; trying a new point...
    7     162    8.141643e+03    0.000e+00    2.748e+02    4.999e-01
User objective function returned Inf; trying a new point...
    8     186    8.101966e+03    0.000e+00    4.093e+02    4.375e-01
User objective function returned Inf; trying a new point...
    9     205    8.087094e+03    0.000e+00    7.259e+02    4.375e-01
User objective function returned Inf; trying a new point...
   10     227    8.042340e+03    0.000e+00    2.278e+02    4.375e-01
User objective function returned Inf; trying a new point...
   11     246    8.013760e+03    0.000e+00    1.852e+02    4.375e-01
User objective function returned Inf; trying a new point...
   12     268    7.987307e+03    0.000e+00    1.688e+02    4.375e-01
User objective function returned Inf; trying a new point...
   13     286    7.951816e+03    0.000e+00    3.509e+02    8.749e-01
User objective function returned Inf; trying a new point...
   14     309    7.920965e+03    0.000e+00    4.181e+02    4.375e-01
User objective function returned Inf; trying a new point...
   15     328    7.903291e+03    0.000e+00    2.543e+02    4.375e-01
User objective function returned Inf; trying a new point...
   16     350    7.883148e+03    0.000e+00    1.346e+02    4.375e-01
User objective function returned Inf; trying a new point...
   17     370    7.880126e+03    0.000e+00    1.337e+02    2.187e-01
User objective function returned Inf; trying a new point...
   18     392    7.859188e+03    0.000e+00    7.953e+01    2.187e-01
User objective function returned Inf; trying a new point...
   19     412    7.858903e+03    0.000e+00    8.005e+01    1.094e-01
   20     433    7.851684e+03    0.000e+00    4.348e+01    2.187e-01
User objective function returned Inf; trying a new point...
   21     453    7.851009e+03    0.000e+00    4.659e+01    1.094e-01
   22     474    7.850076e+03    0.000e+00    7.763e+01    2.187e-01
   23     499    7.849551e+03    0.000e+00    7.991e+01    2.734e-02
   24     518    7.849425e+03    0.000e+00    7.795e+01    2.734e-02
   25     539    7.847872e+03    0.000e+00    9.701e+00    5.468e-02
   26     561    7.847163e+03    0.000e+00    1.242e+01    1.914e-01
   27     584    7.846671e+03    0.000e+00    7.463e+00    9.569e-02
User objective function returned Inf; trying a new point...
   28     604    7.846600e+03    0.000e+00    1.265e+01    4.785e-02
   29     626    7.846457e+03    0.000e+00    7.103e+00    4.785e-02
   30     646    7.846453e+03    0.000e+00    8.013e+00    2.392e-02

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     667    7.846392e+03    0.000e+00    1.064e+01    4.785e-02
   32     690    7.846370e+03    0.000e+00    5.769e+00    2.392e-02
   33     712    7.846338e+03    0.000e+00    6.142e+00    1.196e-02
   34     736    7.846337e+03    0.000e+00    5.490e+00    1.047e-02
   35     755    7.846335e+03    0.000e+00    6.466e+00    5.233e-03
   36     772    7.846321e+03    0.000e+00    4.244e+00    1.054e-02
   37     789    7.846313e+03    0.000e+00    2.361e+00    9.414e-03
   38     806    7.846303e+03    0.000e+00    1.004e+00    8.261e-03
   39     823    7.846300e+03    0.000e+00    2.431e-01    5.749e-03
   40     840    7.846300e+03    0.000e+00    9.631e-03    1.433e-03
   41     857    7.846300e+03    0.000e+00    1.100e-03    5.642e-05

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',3.794175e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 1.7642 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

    0.0009
   -0.0005
    0.0001
    0.0002
   -0.0002
    0.0001
    0.0007
   -0.0004
    0.0001
         0
   -0.0011
    0.0001
   -0.0007
         0
   -0.0002
   -0.0003

Value of the log-likelihood function at convergence: -7846.3001
 
                      AIC                      BIC
              ------------------   -----------------------
                  15724.6001               15794.9510
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 6.4811e-09
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS          0.6202     0.0523    11.8616
A_SnGo         0.0745     0.0321     2.3176
A_AgeLT40      0.6071     0.0549    11.0677
A_ExpLT8       1.0085     0.0595    16.9438
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1          -0.7795     0.1268    -6.1465
Bc_2          -1.0102     0.1279    -7.8969
LV_Load        0.9731     0.0475    20.5031
Mu_12         -0.3235     0.0489    -6.6122
Mu_13         -0.7800     0.0605   -12.8985
Mu_14         -0.7876     0.0602   -13.0871
Mu_22         -0.3814     0.0500    -7.6227
Mu_23         -0.6679     0.0560   -11.9331
Mu_24         -0.4870     0.0533    -9.1371
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -0.8010     0.0344   -23.2661
C_VRC         -0.5889     0.0575   -10.2339
C_LV          -0.8167     0.1135    -7.1966
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    1.9469    0.9469
    0.9469    1.9469

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

    0.6202    0.0745    0.6071    1.0085   -0.7795   -1.0102    0.9731   -0.3235   -0.7800   -0.7876   -0.3814

  Columns 12 through 16

   -0.6679   -0.4870   -0.8010   -0.5889   -0.8167

The covariance matrix for these parameters is:

ihess =

  Columns 1 through 11

    0.0027    0.0003    0.0005    0.0006   -0.0045   -0.0045   -0.0008   -0.0003   -0.0002   -0.0002   -0.0003
    0.0003    0.0010    0.0002    0.0001   -0.0025   -0.0025   -0.0001   -0.0000    0.0000   -0.0000   -0.0000
    0.0005    0.0002    0.0030    0.0007   -0.0015   -0.0015   -0.0008   -0.0002   -0.0003   -0.0003   -0.0003
    0.0006    0.0001    0.0007    0.0035   -0.0010   -0.0009   -0.0014   -0.0004   -0.0005   -0.0005   -0.0005
   -0.0045   -0.0025   -0.0015   -0.0010    0.0161    0.0148   -0.0008    0.0006   -0.0002   -0.0003   -0.0003
   -0.0045   -0.0025   -0.0015   -0.0009    0.0148    0.0164   -0.0010   -0.0005   -0.0008   -0.0007    0.0005
   -0.0008   -0.0001   -0.0008   -0.0014   -0.0008   -0.0010    0.0023    0.0008    0.0009    0.0010    0.0008
   -0.0003   -0.0000   -0.0002   -0.0004    0.0006   -0.0005    0.0008    0.0024   -0.0000    0.0002    0.0003
   -0.0002    0.0000   -0.0003   -0.0005   -0.0002   -0.0008    0.0009   -0.0000    0.0037    0.0001    0.0003
   -0.0002   -0.0000   -0.0003   -0.0005   -0.0003   -0.0007    0.0010    0.0002    0.0001    0.0036    0.0004
   -0.0003   -0.0000   -0.0003   -0.0005   -0.0003    0.0005    0.0008    0.0003    0.0003    0.0004    0.0025
   -0.0003    0.0000   -0.0003   -0.0005   -0.0007   -0.0003    0.0010    0.0004    0.0004    0.0004    0.0001
   -0.0004   -0.0001   -0.0002   -0.0005   -0.0003   -0.0000    0.0010    0.0003    0.0004    0.0005    0.0002
    0.0000    0.0000   -0.0000   -0.0000   -0.0001   -0.0002    0.0000   -0.0000    0.0001    0.0001   -0.0001
    0.0000   -0.0001   -0.0001   -0.0001    0.0003    0.0002    0.0001    0.0000    0.0001    0.0001    0.0000
    0.0036    0.0010    0.0007    0.0006   -0.0069   -0.0068   -0.0011   -0.0005   -0.0003   -0.0002   -0.0003

  Columns 12 through 16

   -0.0003   -0.0004    0.0000    0.0000    0.0036
    0.0000   -0.0001    0.0000   -0.0001    0.0010
   -0.0003   -0.0002   -0.0000   -0.0001    0.0007
   -0.0005   -0.0005   -0.0000   -0.0001    0.0006
   -0.0007   -0.0003   -0.0001    0.0003   -0.0069
   -0.0003   -0.0000   -0.0002    0.0002   -0.0068
    0.0010    0.0010    0.0000    0.0001   -0.0011
    0.0004    0.0003   -0.0000    0.0000   -0.0005
    0.0004    0.0004    0.0001    0.0001   -0.0003
    0.0004    0.0005    0.0001    0.0001   -0.0002
    0.0001    0.0002   -0.0001    0.0000   -0.0003
    0.0031    0.0001    0.0000    0.0000   -0.0002
    0.0001    0.0028    0.0000    0.0000   -0.0005
    0.0000    0.0000    0.0012    0.0007    0.0005
    0.0000    0.0000    0.0007    0.0033    0.0007
   -0.0002   -0.0005    0.0005    0.0007    0.0129

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 7 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.226892e+04    0.000e+00    2.317e+03
User objective function returned Inf; trying a new point...
    1      39    1.068843e+04    0.000e+00    5.099e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.886447e+03    0.000e+00    4.385e+02    9.999e-01
User objective function returned Inf; trying a new point...
    3      81    8.639948e+03    0.000e+00    8.074e+02    4.999e-01
User objective function returned Inf; trying a new point...
    4     100    8.451225e+03    0.000e+00    4.087e+02    1.750e+00
User objective function returned Inf; trying a new point...
    5     124    8.337529e+03    0.000e+00    3.460e+02    4.375e-01
User objective function returned Inf; trying a new point...
    6     143    8.321280e+03    0.000e+00    8.426e+02    4.375e-01
User objective function returned Inf; trying a new point...
    7     165    8.293614e+03    0.000e+00    3.642e+02    4.375e-01
User objective function returned Inf; trying a new point...
    8     184    8.262930e+03    0.000e+00    5.410e+02    4.375e-01
User objective function returned Inf; trying a new point...
    9     205    8.229260e+03    0.000e+00    2.702e+02    8.749e-01
User objective function returned Inf; trying a new point...
   10     223    8.217361e+03    0.000e+00    2.032e+02    8.749e-01
User objective function returned Inf; trying a new point...
   11     245    8.170396e+03    0.000e+00    6.173e+02    8.749e-01
User objective function returned Inf; trying a new point...
   12     265    8.159543e+03    0.000e+00    2.116e+02    4.375e-01
User objective function returned Inf; trying a new point...
   13     287    8.105695e+03    0.000e+00    2.193e+02    4.375e-01
User objective function returned Inf; trying a new point...
   14     307    8.099919e+03    0.000e+00    1.350e+02    2.187e-01
User objective function returned Inf; trying a new point...
   15     328    8.096952e+03    0.000e+00    1.927e+02    4.375e-01
User objective function returned Inf; trying a new point...
   16     348    8.096691e+03    0.000e+00    1.863e+02    1.094e-01
User objective function returned Inf; trying a new point...
   17     369    8.084780e+03    0.000e+00    3.408e+01    2.187e-01
User objective function returned Inf; trying a new point...
   18     393    8.084765e+03    0.000e+00    7.990e+01    1.914e-01
User objective function returned Inf; trying a new point...
   19     412    8.084653e+03    0.000e+00    9.067e+01    9.569e-02
   20     433    8.084433e+03    0.000e+00    4.444e+01    1.914e-01
User objective function returned Inf; trying a new point...
   21     452    8.083936e+03    0.000e+00    5.286e+01    9.569e-02
   22     473    8.082879e+03    0.000e+00    3.405e+01    1.914e-01
User objective function returned Inf; trying a new point...
   23     496    8.081927e+03    0.000e+00    1.369e+01    9.569e-02
   24     519    8.081683e+03    0.000e+00    7.830e+00    4.785e-02
   25     538    8.081612e+03    0.000e+00    1.984e+01    4.785e-02
   26     560    8.081441e+03    0.000e+00    8.127e+00    4.785e-02
   27     583    8.081379e+03    0.000e+00    8.113e+00    2.392e-02
   28     603    8.081369e+03    0.000e+00    5.991e+00    1.196e-02
   29     624    8.081341e+03    0.000e+00    4.840e+00    2.392e-02
   30     644    8.081339e+03    0.000e+00    4.569e+00    1.196e-02

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     665    8.081323e+03    0.000e+00    2.152e+00    2.392e-02
   32     688    8.081311e+03    0.000e+00    3.312e+00    1.196e-02
   33     711    8.081308e+03    0.000e+00    1.610e+00    5.981e-03
   34     734    8.081308e+03    0.000e+00    1.195e+00    2.990e-03
   35     757    8.081307e+03    0.000e+00    6.715e-01    1.495e-03
   36     779    8.081307e+03    0.000e+00    7.773e-01    1.495e-03
   37     798    8.081307e+03    0.000e+00    1.013e+00    7.476e-04
   38     819    8.081307e+03    0.000e+00    7.596e-01    1.495e-03
   39     838    8.081307e+03    0.000e+00    6.216e-01    1.495e-03
   40     855    8.081307e+03    0.000e+00    6.584e-01    1.898e-03
   41     872    8.081307e+03    0.000e+00    6.159e-01    5.683e-04
   42     889    8.081306e+03    0.000e+00    1.853e-01    2.016e-03
   43     906    8.081306e+03    0.000e+00    1.328e-02    6.128e-04
   44     923    8.081306e+03    0.000e+00    1.157e-03    1.068e-04

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',6.113191e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 1.9376 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

    0.0004
    0.0010
   -0.0010
    0.0002
    0.0008
   -0.0011
    0.0005
    0.0002
   -0.0006
    0.0007
    0.0005
    0.0012
    0.0002
   -0.0005
   -0.0010
    0.0002

Value of the log-likelihood function at convergence: -8081.3062
 
                      AIC                      BIC
              ------------------   -----------------------
                  16194.6125               16264.9634
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 2.6046e-08
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS          0.7439     0.0514    14.4703
A_SnGo         0.1798     0.0359     5.0050
A_AgeLT40      0.6408     0.0567    11.3116
A_ExpLT8       0.6983     0.0556    12.5584
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1          -0.8764     0.1172    -7.4750
Bc_2          -1.1602     0.1187    -9.7772
LV_Load        0.8954     0.0444    20.1847
Mu_12         -0.5503     0.0552    -9.9620
Mu_13         -0.3596     0.0453    -7.9312
Mu_14         -0.6243     0.0539   -11.5910
Mu_22         -0.3180     0.0451    -7.0510
Mu_23         -0.7064     0.0541   -13.0660
Mu_24         -0.5390     0.0527   -10.2254
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -0.8460     0.0348   -24.2847
C_VRC         -0.6690     0.0569   -11.7500
C_LV          -0.6713     0.0862    -7.7880
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    1.8017    0.8017
    0.8017    1.8017

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

    0.7439    0.1798    0.6408    0.6983   -0.8764   -1.1602    0.8954   -0.5503   -0.3596   -0.6243   -0.3180

  Columns 12 through 16

   -0.7064   -0.5390   -0.8460   -0.6690   -0.6713

The covariance matrix for these parameters is:

ihess =

  Columns 1 through 11

    0.0026    0.0003    0.0005    0.0005   -0.0034   -0.0035   -0.0008   -0.0001   -0.0002   -0.0003   -0.0003
    0.0003    0.0013    0.0003    0.0000   -0.0025   -0.0024   -0.0002   -0.0000   -0.0001   -0.0000   -0.0000
    0.0005    0.0003    0.0032    0.0005   -0.0012   -0.0011   -0.0008   -0.0003   -0.0003   -0.0002   -0.0003
    0.0005    0.0000    0.0005    0.0031   -0.0006   -0.0005   -0.0009   -0.0004   -0.0003   -0.0002   -0.0004
   -0.0034   -0.0025   -0.0012   -0.0006    0.0137    0.0126   -0.0010    0.0002   -0.0001   -0.0004   -0.0005
   -0.0035   -0.0024   -0.0011   -0.0005    0.0126    0.0141   -0.0013   -0.0009   -0.0007   -0.0009    0.0001
   -0.0008   -0.0002   -0.0008   -0.0009   -0.0010   -0.0013    0.0020    0.0008    0.0008    0.0008    0.0008
   -0.0001   -0.0000   -0.0003   -0.0004    0.0002   -0.0009    0.0008    0.0031   -0.0000    0.0001    0.0003
   -0.0002   -0.0001   -0.0003   -0.0003   -0.0001   -0.0007    0.0008   -0.0000    0.0021    0.0000    0.0003
   -0.0003   -0.0000   -0.0002   -0.0002   -0.0004   -0.0009    0.0008    0.0001    0.0000    0.0029    0.0003
   -0.0003   -0.0000   -0.0003   -0.0004   -0.0005    0.0001    0.0008    0.0003    0.0003    0.0003    0.0020
   -0.0003   -0.0001   -0.0003   -0.0002   -0.0006   -0.0003    0.0007    0.0003    0.0003    0.0003    0.0001
   -0.0003   -0.0001   -0.0002   -0.0002   -0.0006   -0.0005    0.0008    0.0003    0.0004    0.0004    0.0002
   -0.0000    0.0000    0.0000    0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000   -0.0000   -0.0000
   -0.0000   -0.0000    0.0000    0.0001   -0.0000    0.0000    0.0000    0.0000    0.0000   -0.0001    0.0000
    0.0022    0.0011    0.0006    0.0003   -0.0042   -0.0042   -0.0008   -0.0001   -0.0003   -0.0002   -0.0003

  Columns 12 through 16

   -0.0003   -0.0003   -0.0000   -0.0000    0.0022
   -0.0001   -0.0001    0.0000   -0.0000    0.0011
   -0.0003   -0.0002    0.0000    0.0000    0.0006
   -0.0002   -0.0002    0.0000    0.0001    0.0003
   -0.0006   -0.0006   -0.0000   -0.0000   -0.0042
   -0.0003   -0.0005   -0.0000    0.0000   -0.0042
    0.0007    0.0008   -0.0000    0.0000   -0.0008
    0.0003    0.0003    0.0000    0.0000   -0.0001
    0.0003    0.0004    0.0000    0.0000   -0.0003
    0.0003    0.0004   -0.0000   -0.0001   -0.0002
    0.0001    0.0002   -0.0000    0.0000   -0.0003
    0.0029   -0.0000    0.0000   -0.0001   -0.0003
   -0.0000    0.0028    0.0000   -0.0000   -0.0003
    0.0000    0.0000    0.0012    0.0007    0.0004
   -0.0001   -0.0000    0.0007    0.0032    0.0005
   -0.0003   -0.0003    0.0004    0.0005    0.0074

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 8 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.178432e+04    0.000e+00    2.037e+03
User objective function returned Inf; trying a new point...
    1      39    1.057808e+04    0.000e+00    5.320e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.623611e+03    0.000e+00    4.022e+02    9.999e-01
User objective function returned Inf; trying a new point...
    3      80    8.466272e+03    0.000e+00    1.659e+03    9.999e-01
User objective function returned Inf; trying a new point...
    4      99    8.354136e+03    0.000e+00    1.324e+03    9.999e-01
User objective function returned Inf; trying a new point...
    5     121    8.344506e+03    0.000e+00    4.313e+02    9.999e-01
User objective function returned Inf; trying a new point...
    6     140    8.338757e+03    0.000e+00    6.520e+02    5.000e-01
User objective function returned Inf; trying a new point...
    7     161    8.250388e+03    0.000e+00    2.544e+02    9.999e-01
User objective function returned Inf; trying a new point...
    8     181    8.219220e+03    0.000e+00    6.108e+02    4.999e-01
User objective function returned Inf; trying a new point...
    9     203    8.178092e+03    0.000e+00    6.278e+02    4.999e-01
User objective function returned Inf; trying a new point...
   10     225    8.171240e+03    0.000e+00    1.560e+02    5.000e-01
User objective function returned Inf; trying a new point...
   11     243    8.147972e+03    0.000e+00    1.396e+02    4.999e-01
User objective function returned Inf; trying a new point...
   12     264    8.142453e+03    0.000e+00    8.759e+02    9.999e-01
User objective function returned Inf; trying a new point...
   13     284    8.142253e+03    0.000e+00    8.365e+02    2.500e-01
User objective function returned Inf; trying a new point...
   14     305    8.072623e+03    0.000e+00    2.726e+02    5.000e-01
User objective function returned Inf; trying a new point...
   15     324    8.060299e+03    0.000e+00    2.171e+02    5.000e-01
User objective function returned Inf; trying a new point...
   16     346    8.037904e+03    0.000e+00    7.208e+01    5.000e-01
User objective function returned Inf; trying a new point...
   17     369    8.026183e+03    0.000e+00    7.789e+01    2.500e-01
User objective function returned Inf; trying a new point...
   18     389    8.025996e+03    0.000e+00    1.009e+02    1.250e-01
User objective function returned Inf; trying a new point...
   19     410    8.017367e+03    0.000e+00    1.413e+02    2.500e-01
User objective function returned Inf; trying a new point...
   20     429    8.014221e+03    0.000e+00    7.695e+01    2.500e-01
User objective function returned Inf; trying a new point...
   21     451    8.008432e+03    0.000e+00    5.601e+01    2.500e-01
User objective function returned Inf; trying a new point...
   22     474    8.006675e+03    0.000e+00    1.179e+02    1.250e-01
User objective function returned Inf; trying a new point...
   23     494    8.006519e+03    0.000e+00    1.093e+02    6.249e-02
User objective function returned Inf; trying a new point...
   24     515    8.004310e+03    0.000e+00    3.916e+01    1.250e-01
   25     536    8.004107e+03    0.000e+00    3.971e+01    2.500e-01
   26     555    8.004003e+03    0.000e+00    4.345e+01    1.250e-01
User objective function returned Inf; trying a new point...
   27     577    8.002358e+03    0.000e+00    3.370e+01    1.250e-01
User objective function returned Inf; trying a new point...
   28     600    8.001499e+03    0.000e+00    4.490e+01    6.249e-02
   29     623    8.001348e+03    0.000e+00    2.446e+01    3.125e-02
   30     645    8.001244e+03    0.000e+00    2.312e+01    3.125e-02

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     663    8.001126e+03    0.000e+00    2.647e+01    6.249e-02
   32     686    8.000845e+03    0.000e+00    3.941e+01    3.125e-02
   33     709    8.000623e+03    0.000e+00    4.047e+01    5.468e-02
   34     731    8.000512e+03    0.000e+00    1.326e+01    5.468e-02
   35     751    8.000434e+03    0.000e+00    5.863e+00    2.734e-02
   36     773    8.000303e+03    0.000e+00    3.263e+00    2.734e-02
   37     797    8.000302e+03    0.000e+00    1.208e+00    2.392e-02
   38     817    8.000301e+03    0.000e+00    9.465e-01    3.173e-03
   39     838    8.000299e+03    0.000e+00    1.440e+00    6.346e-03
   40     856    8.000299e+03    0.000e+00    9.397e-01    6.346e-03
   41     874    8.000296e+03    0.000e+00    2.746e-01    1.000e-02
   42     891    8.000296e+03    0.000e+00    7.800e-02    3.992e-03
   43     908    8.000296e+03    0.000e+00    5.004e-03    6.992e-04
   44     925    8.000296e+03    0.000e+00    9.952e-04    1.560e-05

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',7.086738e-06,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 1.9013 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

   1.0e-03 *

    0.1221
   -0.9155
   -0.1831
   -0.2441
         0
    0.1115
   -0.9952
    0.8545
    0.4883
    0.1831
    0.2441
    0.1831
    0.4883
    0.4883
    0.4883
    0.1221

Value of the log-likelihood function at convergence: -8000.2956
 
                      AIC                      BIC
              ------------------   -----------------------
                  16032.5912               16102.9421
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 5.0362e-09
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS          0.6292     0.0477    13.1997
A_SnGo         0.0368     0.0331     1.1111
A_AgeLT40     -0.0518     0.0509    -1.0175
A_ExpLT8       0.7878     0.0524    15.0338
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1          -0.7542     0.1207    -6.2467
Bc_2          -1.0946     0.1236    -8.8532
LV_Load        1.1039     0.0509    21.6835
Mu_12         -0.3265     0.0498    -6.5523
Mu_13         -0.5106     0.0541    -9.4393
Mu_14         -0.6749     0.0598   -11.2811
Mu_22         -0.5085     0.0535    -9.5055
Mu_23         -0.4631     0.0517    -8.9562
Mu_24         -0.9588     0.0669   -14.3251
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -0.6828     0.0306   -22.2847
C_VRC         -0.5625     0.0526   -10.7028
C_LV          -0.2440     0.0849    -2.8748
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    2.2187    1.2187
    1.2187    2.2187

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

    0.6292    0.0368   -0.0518    0.7878   -0.7542   -1.0946    1.1039   -0.3265   -0.5106   -0.6749   -0.5085

  Columns 12 through 16

   -0.4631   -0.9588   -0.6828   -0.5625   -0.2440

The covariance matrix for these parameters is:

ihess =

  Columns 1 through 11

    0.0023   -0.0002   -0.0001    0.0003   -0.0031   -0.0031   -0.0007   -0.0002   -0.0002   -0.0003   -0.0002
   -0.0002    0.0011    0.0000   -0.0001   -0.0020   -0.0020    0.0000    0.0002    0.0000   -0.0000    0.0001
   -0.0001    0.0000    0.0026   -0.0001   -0.0013   -0.0013    0.0002    0.0000    0.0001   -0.0000    0.0001
    0.0003   -0.0001   -0.0001    0.0027   -0.0007   -0.0007   -0.0008   -0.0002   -0.0002   -0.0003   -0.0003
   -0.0031   -0.0020   -0.0013   -0.0007    0.0146    0.0135   -0.0014   -0.0003   -0.0004   -0.0000   -0.0010
   -0.0031   -0.0020   -0.0013   -0.0007    0.0135    0.0153   -0.0018   -0.0013   -0.0010   -0.0005   -0.0003
   -0.0007    0.0000    0.0002   -0.0008   -0.0014   -0.0018    0.0026    0.0010    0.0011    0.0010    0.0011
   -0.0002    0.0002    0.0000   -0.0002   -0.0003   -0.0013    0.0010    0.0025    0.0001    0.0002    0.0004
   -0.0002    0.0000    0.0001   -0.0002   -0.0004   -0.0010    0.0011    0.0001    0.0029    0.0001    0.0005
   -0.0003   -0.0000   -0.0000   -0.0003   -0.0000   -0.0005    0.0010    0.0002    0.0001    0.0036    0.0004
   -0.0002    0.0001    0.0001   -0.0003   -0.0010   -0.0003    0.0011    0.0004    0.0005    0.0004    0.0029
   -0.0003    0.0001    0.0000   -0.0003   -0.0006   -0.0003    0.0010    0.0004    0.0004    0.0005    0.0001
   -0.0002    0.0002    0.0000   -0.0002   -0.0010   -0.0008    0.0008    0.0003    0.0003    0.0004    0.0001
    0.0000    0.0001    0.0000    0.0000   -0.0002   -0.0001   -0.0000   -0.0001   -0.0000   -0.0000   -0.0000
    0.0001    0.0001   -0.0001    0.0001   -0.0004   -0.0004   -0.0001   -0.0001   -0.0001   -0.0000   -0.0001
    0.0009   -0.0001   -0.0001    0.0001   -0.0009   -0.0009   -0.0005   -0.0001   -0.0001   -0.0000   -0.0002

  Columns 12 through 16

   -0.0003   -0.0002    0.0000    0.0001    0.0009
    0.0001    0.0002    0.0001    0.0001   -0.0001
    0.0000    0.0000    0.0000   -0.0001   -0.0001
   -0.0003   -0.0002    0.0000    0.0001    0.0001
   -0.0006   -0.0010   -0.0002   -0.0004   -0.0009
   -0.0003   -0.0008   -0.0001   -0.0004   -0.0009
    0.0010    0.0008   -0.0000   -0.0001   -0.0005
    0.0004    0.0003   -0.0001   -0.0001   -0.0001
    0.0004    0.0003   -0.0000   -0.0001   -0.0001
    0.0005    0.0004   -0.0000   -0.0000   -0.0000
    0.0001    0.0001   -0.0000   -0.0001   -0.0002
    0.0027    0.0001   -0.0000   -0.0000   -0.0001
    0.0001    0.0045   -0.0001   -0.0002    0.0000
   -0.0000   -0.0001    0.0009    0.0004   -0.0000
   -0.0000   -0.0002    0.0004    0.0028    0.0001
   -0.0001    0.0000   -0.0000    0.0001    0.0072

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 9 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.321338e+04    0.000e+00    2.863e+03
User objective function returned Inf; trying a new point...
    1      39    9.900636e+03    0.000e+00    4.446e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.523168e+03    0.000e+00    1.311e+03    9.999e-01
User objective function returned Inf; trying a new point...
    3      80    8.474111e+03    0.000e+00    1.018e+03    9.999e-01
User objective function returned Inf; trying a new point...
    4      98    8.270952e+03    0.000e+00    1.357e+03    9.999e-01
User objective function returned Inf; trying a new point...
    5     121    8.141960e+03    0.000e+00    8.087e+02    5.000e-01
User objective function returned Inf; trying a new point...
    6     140    8.140872e+03    0.000e+00    1.056e+03    5.000e-01
User objective function returned Inf; trying a new point...
    7     162    8.078514e+03    0.000e+00    4.677e+02    5.000e-01
User objective function returned Inf; trying a new point...
    8     181    8.065896e+03    0.000e+00    4.191e+02    4.999e-01
User objective function returned Inf; trying a new point...
    9     202    7.972210e+03    0.000e+00    6.129e+02    9.999e-01
User objective function returned Inf; trying a new point...
   10     229    7.944552e+03    0.000e+00    6.804e+02    1.094e-01
User objective function returned Inf; trying a new point...
   11     247    7.935377e+03    0.000e+00    7.904e+02    2.187e-01
User objective function returned Inf; trying a new point...
   12     268    7.900686e+03    0.000e+00    1.168e+02    4.375e-01
User objective function returned Inf; trying a new point...
   13     288    7.897340e+03    0.000e+00    8.167e+01    2.187e-01
User objective function returned Inf; trying a new point...
   14     309    7.891792e+03    0.000e+00    2.463e+02    4.375e-01
User objective function returned Inf; trying a new point...
   15     327    7.888627e+03    0.000e+00    2.775e+02    4.375e-01
User objective function returned Inf; trying a new point...
   16     349    7.882376e+03    0.000e+00    1.063e+02    4.375e-01
User objective function returned Inf; trying a new point...
   17     369    7.881355e+03    0.000e+00    1.043e+02    2.187e-01
   18     390    7.881039e+03    0.000e+00    1.550e+02    4.375e-01
User objective function returned Inf; trying a new point...
   19     409    7.876984e+03    0.000e+00    1.338e+02    2.187e-01
User objective function returned Inf; trying a new point...
   20     431    7.866538e+03    0.000e+00    1.621e+02    2.187e-01
User objective function returned Inf; trying a new point...
   21     455    7.862681e+03    0.000e+00    1.032e+02    1.914e-01
User objective function returned Inf; trying a new point...
   22     475    7.861023e+03    0.000e+00    1.183e+02    9.569e-02
User objective function returned Inf; trying a new point...
   23     496    7.847579e+03    0.000e+00    1.667e+02    1.914e-01
User objective function returned Inf; trying a new point...
   24     519    7.835608e+03    0.000e+00    3.266e+02    3.349e-01
User objective function returned Inf; trying a new point...
   25     539    7.834867e+03    0.000e+00    2.590e+02    1.675e-01
User objective function returned Inf; trying a new point...
   26     560    7.827665e+03    0.000e+00    1.701e+02    3.349e-01
User objective function returned Inf; trying a new point...
   27     580    7.827442e+03    0.000e+00    1.635e+02    1.675e-01
User objective function returned Inf; trying a new point...
   28     601    7.825101e+03    0.000e+00    2.229e+02    3.349e-01
User objective function returned Inf; trying a new point...
   29     620    7.824233e+03    0.000e+00    2.140e+02    1.675e-01
   30     641    7.821475e+03    0.000e+00    4.159e+01    2.824e-01
User objective function returned Inf; trying a new point...

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     661    7.821325e+03    0.000e+00    3.037e+01    1.412e-01
   32     683    7.817450e+03    0.000e+00    6.644e+01    1.412e-01
   33     701    7.817374e+03    0.000e+00    7.025e+01    4.740e-02
   34     722    7.816887e+03    0.000e+00    5.642e+01    9.479e-02
   35     740    7.816531e+03    0.000e+00    5.371e+01    6.102e-02
   36     759    7.816374e+03    0.000e+00    3.238e+01    1.194e-01
   37     776    7.815475e+03    0.000e+00    2.115e+01    5.602e-02
   38     793    7.815198e+03    0.000e+00    2.037e+01    7.098e-02
   39     810    7.815024e+03    0.000e+00    6.269e+00    8.758e-02
   40     827    7.815007e+03    0.000e+00    4.153e+00    2.470e-02
   41     844    7.815006e+03    0.000e+00    1.901e+00    2.262e-03
   42     861    7.815005e+03    0.000e+00    4.717e-02    9.342e-04
   43     878    7.815005e+03    0.000e+00    1.812e-02    2.828e-04
   44     895    7.815005e+03    0.000e+00    4.941e-03    1.669e-04
   45     912    7.815005e+03    0.000e+00    1.718e-03    1.064e-05

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',6.039870e-06,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 1.8366 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

    0.0007
    0.0009
    0.0004
    0.0001
   -0.0001
   -0.0005
    0.0017
   -0.0004
   -0.0005
   -0.0007
   -0.0002
   -0.0003
   -0.0003
   -0.0004
   -0.0002
    0.0001

Value of the log-likelihood function at convergence: -7815.0052
 
                      AIC                      BIC
              ------------------   -----------------------
                  15662.0103               15732.3612
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 3.6239e-08
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS          0.4671     0.0431    10.8362
A_SnGo         0.1336     0.0232     5.7646
A_AgeLT40      0.5562     0.0537    10.3656
A_ExpLT8       0.5965     0.0530    11.2490
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1          -0.3724     0.1391    -2.6768
Bc_2          -0.5631     0.1438    -3.9157
LV_Load        1.0305     0.0522    19.7390
Mu_12         -0.4301     0.0549    -7.8384
Mu_13         -0.6056     0.0536   -11.2893
Mu_14         -0.6097     0.0550   -11.0919
Mu_22         -0.4302     0.0519    -8.2815
Mu_23         -0.5069     0.0515    -9.8330
Mu_24         -0.8544     0.0627   -13.6371
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -0.9970     0.0411   -24.2359
C_VRC         -0.3639     0.0588    -6.1863
C_LV          -1.5437     0.1839    -8.3925
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    2.0619    1.0619
    1.0619    2.0619

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

    0.4671    0.1336    0.5562    0.5965   -0.3724   -0.5631    1.0305   -0.4301   -0.6056   -0.6097   -0.4302

  Columns 12 through 16

   -0.5069   -0.8544   -0.9970   -0.3639   -1.5437

The covariance matrix for these parameters is:

ihess =

  Columns 1 through 11

    0.0019    0.0002    0.0001    0.0003   -0.0043   -0.0045    0.0002    0.0005   -0.0000   -0.0000   -0.0002
    0.0002    0.0005    0.0001    0.0001   -0.0017   -0.0017    0.0001    0.0003   -0.0000    0.0001   -0.0001
    0.0001    0.0001    0.0029    0.0003   -0.0014   -0.0014   -0.0004    0.0000   -0.0002   -0.0001   -0.0003
    0.0003    0.0001    0.0003    0.0028   -0.0019   -0.0019   -0.0004   -0.0001   -0.0002   -0.0001   -0.0002
   -0.0043   -0.0017   -0.0014   -0.0019    0.0194    0.0187   -0.0036   -0.0018   -0.0001   -0.0004   -0.0002
   -0.0045   -0.0017   -0.0014   -0.0019    0.0187    0.0207   -0.0038   -0.0028   -0.0007   -0.0009    0.0006
    0.0002    0.0001   -0.0004   -0.0004   -0.0036   -0.0038    0.0027    0.0011    0.0008    0.0008    0.0009
    0.0005    0.0003    0.0000   -0.0001   -0.0018   -0.0028    0.0011    0.0030   -0.0001    0.0003    0.0005
   -0.0000   -0.0000   -0.0002   -0.0002   -0.0001   -0.0007    0.0008   -0.0001    0.0029    0.0000    0.0004
   -0.0000    0.0001   -0.0001   -0.0001   -0.0004   -0.0009    0.0008    0.0003    0.0000    0.0030    0.0004
   -0.0002   -0.0001   -0.0003   -0.0002   -0.0002    0.0006    0.0009    0.0005    0.0004    0.0004    0.0027
   -0.0002   -0.0000   -0.0002   -0.0002   -0.0003   -0.0000    0.0009    0.0004    0.0003    0.0005    0.0000
    0.0000   -0.0000   -0.0002   -0.0003   -0.0011   -0.0006    0.0009    0.0000    0.0003    0.0001    0.0003
   -0.0003   -0.0001   -0.0001   -0.0002    0.0015    0.0015   -0.0003   -0.0001   -0.0000    0.0001    0.0001
    0.0002    0.0001    0.0001   -0.0000   -0.0005   -0.0006   -0.0001    0.0000   -0.0001   -0.0001   -0.0001
    0.0058    0.0016    0.0009    0.0014   -0.0159   -0.0167    0.0005    0.0019   -0.0004    0.0000   -0.0008

  Columns 12 through 16

   -0.0002    0.0000   -0.0003    0.0002    0.0058
   -0.0000   -0.0000   -0.0001    0.0001    0.0016
   -0.0002   -0.0002   -0.0001    0.0001    0.0009
   -0.0002   -0.0003   -0.0002   -0.0000    0.0014
   -0.0003   -0.0011    0.0015   -0.0005   -0.0159
   -0.0000   -0.0006    0.0015   -0.0006   -0.0167
    0.0009    0.0009   -0.0003   -0.0001    0.0005
    0.0004    0.0000   -0.0001    0.0000    0.0019
    0.0003    0.0003   -0.0000   -0.0001   -0.0004
    0.0005    0.0001    0.0001   -0.0001    0.0000
    0.0000    0.0003    0.0001   -0.0001   -0.0008
    0.0027   -0.0001    0.0001   -0.0000   -0.0007
   -0.0001    0.0039   -0.0000   -0.0001   -0.0002
    0.0001   -0.0000    0.0017    0.0007   -0.0000
   -0.0000   -0.0001    0.0007    0.0035    0.0017
   -0.0007   -0.0002   -0.0000    0.0017    0.0338

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 10 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.278057e+04    0.000e+00    2.651e+03
User objective function returned Inf; trying a new point...
    1      39    1.003885e+04    0.000e+00    4.673e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.469391e+03    0.000e+00    1.023e+03    9.999e-01
User objective function returned Inf; trying a new point...
    3      81    8.353651e+03    0.000e+00    1.183e+03    4.999e-01
User objective function returned Inf; trying a new point...
    4      99    8.286086e+03    0.000e+00    1.524e+03    9.999e-01
User objective function returned Inf; trying a new point...
    5     121    8.270013e+03    0.000e+00    3.418e+02    9.999e-01
User objective function returned Inf; trying a new point...
    6     141    8.239173e+03    0.000e+00    2.171e+02    2.500e-01
User objective function returned Inf; trying a new point...
    7     162    8.164074e+03    0.000e+00    4.561e+02    4.999e-01
User objective function returned Inf; trying a new point...
    8     181    8.122801e+03    0.000e+00    2.368e+02    4.999e-01
User objective function returned Inf; trying a new point...
    9     203    8.108403e+03    0.000e+00    6.245e+02    4.999e-01
User objective function returned Inf; trying a new point...
   10     222    8.104532e+03    0.000e+00    5.221e+02    2.500e-01
User objective function returned Inf; trying a new point...
   11     243    8.093819e+03    0.000e+00    1.441e+02    5.000e-01
User objective function returned Inf; trying a new point...
   12     262    8.085399e+03    0.000e+00    2.184e+02    2.500e-01
User objective function returned Inf; trying a new point...
   13     283    8.070854e+03    0.000e+00    2.825e+02    4.999e-01
User objective function returned Inf; trying a new point...
   14     302    8.054070e+03    0.000e+00    2.479e+02    4.999e-01
User objective function returned Inf; trying a new point...
   15     324    8.045129e+03    0.000e+00    4.075e+01    4.999e-01
User objective function returned Inf; trying a new point...
   16     344    8.041467e+03    0.000e+00    7.360e+01    2.500e-01
User objective function returned Inf; trying a new point...
   17     365    8.029455e+03    0.000e+00    8.113e+01    4.999e-01
User objective function returned Inf; trying a new point...
   18     385    8.026199e+03    0.000e+00    1.412e+02    2.500e-01
User objective function returned Inf; trying a new point...
   19     406    8.025806e+03    0.000e+00    1.350e+02    4.999e-01
User objective function returned Inf; trying a new point...
   20     425    8.024428e+03    0.000e+00    2.152e+02    2.500e-01
User objective function returned Inf; trying a new point...
   21     447    8.021537e+03    0.000e+00    2.148e+02    2.500e-01
User objective function returned Inf; trying a new point...
   22     465    8.019214e+03    0.000e+00    2.928e+02    2.500e-01
User objective function returned Inf; trying a new point...
   23     487    8.012791e+03    0.000e+00    1.966e+02    2.500e-01
User objective function returned Inf; trying a new point...
   24     506    8.011781e+03    0.000e+00    1.990e+02    2.500e-01
User objective function returned Inf; trying a new point...
   25     527    8.010918e+03    0.000e+00    1.537e+02    4.999e-01
User objective function returned Inf; trying a new point...
   26     547    8.009186e+03    0.000e+00    2.231e+02    1.250e-01
User objective function returned Inf; trying a new point...
   27     568    8.002540e+03    0.000e+00    3.939e+01    2.500e-01
   28     591    8.001131e+03    0.000e+00    3.889e+01    1.250e-01
   29     613    8.000540e+03    0.000e+00    8.171e+01    1.250e-01
User objective function returned Inf; trying a new point...
   30     633    8.000307e+03    0.000e+00    6.642e+01    6.249e-02

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     654    7.999077e+03    0.000e+00    8.347e+00    1.250e-01
   32     675    7.997093e+03    0.000e+00    3.534e+01    8.749e-01
User objective function returned Inf; trying a new point...
   33     693    7.992487e+03    0.000e+00    2.512e+02    1.750e+00
   34     710    7.988475e+03    0.000e+00    2.631e+02    1.164e+00
   35     728    7.984591e+03    0.000e+00    1.356e+02    2.611e-01
   36     746    7.982965e+03    0.000e+00    1.846e+02    3.665e-01
   37     763    7.979779e+03    0.000e+00    1.373e+02    1.228e+00
   38     780    7.977580e+03    0.000e+00    5.441e+02    3.946e+00
   39     797    7.974340e+03    0.000e+00    1.886e+02    2.860e-01
   40     814    7.972600e+03    0.000e+00    7.074e+01    1.784e+00
   41     832    7.971072e+03    0.000e+00    4.238e+02    4.167e+00
   42     849    7.970364e+03    0.000e+00    4.885e+02    1.648e+00
   43     867    7.969577e+03    0.000e+00    2.304e+02    7.944e-01
   44     884    7.968658e+03    0.000e+00    4.164e+02    3.171e+00
   45     901    7.968083e+03    0.000e+00    2.318e+02    1.575e+00
   46     918    7.966971e+03    0.000e+00    3.101e+02    5.588e+00
   47     935    7.966028e+03    0.000e+00    1.813e+02    5.446e+00
   48     954    7.965769e+03    0.000e+00    6.247e+02    6.597e+00
   49     971    7.965248e+03    0.000e+00    1.310e+02    6.141e-01
   50     988    7.964909e+03    0.000e+00    6.296e+01    4.488e+00
   51    1006    7.964569e+03    0.000e+00    4.572e+02    7.438e+00
   52    1023    7.964300e+03    0.000e+00    1.185e+03    9.455e+00
   53    1040    7.963781e+03    0.000e+00    4.210e+02    7.962e+00
   54    1057    7.963755e+03    0.000e+00    5.670e+02    1.995e+00
   55    1074    7.963530e+03    0.000e+00    7.633e+02    1.240e+01
   56    1091    7.963427e+03    0.000e+00    7.473e+01    4.621e+00
   57    1108    7.963317e+03    0.000e+00    1.426e+02    4.839e+00
   58    1125    7.963195e+03    0.000e+00    3.906e+02    7.140e+00
   59    1142    7.963214e+03    0.000e+00    8.309e+01    2.561e+00
   60    1159    7.963194e+03    0.000e+00    3.051e+01    8.779e-01

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   61    1176    7.963190e+03    0.000e+00    1.152e+01    2.095e-01
   62    1193    7.963190e+03    0.000e+00    9.036e-01    9.064e-03
   63    1210    7.963190e+03    0.000e+00    4.258e-01    8.537e-03

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',8.986326e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 2.4607 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

    0.4258
   -0.1048
   -0.0057
   -0.0054
   -0.0051
   -0.0076
    0.0024
    0.0013
    0.0015
    0.0023
    0.0042
    0.0037
    0.0013
   -0.0057
    0.0010
   -0.0195

Value of the log-likelihood function at convergence: -7963.1898
 
                      AIC                      BIC
              ------------------   -----------------------
                  15958.3795               16028.7304
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 0.43516
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS         -0.0062     0.0023    -2.6942
A_SnGo        -0.0016     0.0007    -2.2968
A_AgeLT40      0.4560     0.0472     9.6648
A_ExpLT8       0.1958     0.0494     3.9617
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1           0.7010     0.0559    12.5325
Bc_2           0.7336     0.0570    12.8699
LV_Load        1.1433     0.0503    22.7360
Mu_12         -0.4381     0.0508    -8.6311
Mu_13         -0.8791     0.0610   -14.4066
Mu_14         -0.7833     0.0613   -12.7741
Mu_22         -0.3879     0.0513    -7.5616
Mu_23         -0.4123     0.0502    -8.2186
Mu_24         -0.8563     0.0640   -13.3866
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -0.8483     0.0346   -24.5091
C_VRC         -0.6665     0.0563   -11.8356
C_LV          94.9930    33.8704     2.8046
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    2.3072    1.3072
    1.3072    2.3072

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

   -0.0062   -0.0016    0.4560    0.1958    0.7010    0.7336    1.1433   -0.4381   -0.8791   -0.7833   -0.3879

  Columns 12 through 16

   -0.4123   -0.8563   -0.8483   -0.6665   94.9930

The covariance matrix for these parameters is:

ihess =

   1.0e+03 *

  Columns 1 through 11

    0.0000    0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000    0.0000   -0.0000
    0.0000    0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000    0.0000   -0.0000
   -0.0000   -0.0000    0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000
   -0.0000   -0.0000   -0.0000    0.0000   -0.0000   -0.0000   -0.0000   -0.0000    0.0000   -0.0000   -0.0000
   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
   -0.0000    0.0000   -0.0000   -0.0000    0.0000   -0.0000    0.0000   -0.0000   -0.0000    0.0000   -0.0000
   -0.0000    0.0000    0.0000    0.0000   -0.0000   -0.0000   -0.0000    0.0000   -0.0000   -0.0000   -0.0000
    0.0001    0.0000   -0.0001   -0.0000   -0.0001   -0.0001   -0.0000   -0.0000   -0.0000    0.0001   -0.0000

  Columns 12 through 16

    0.0000   -0.0000   -0.0000   -0.0000    0.0001
    0.0000   -0.0000    0.0000    0.0000    0.0000
   -0.0000   -0.0000   -0.0000    0.0000   -0.0001
   -0.0000   -0.0000   -0.0000    0.0000   -0.0000
    0.0000    0.0000    0.0000   -0.0000   -0.0001
    0.0000    0.0000   -0.0000   -0.0000   -0.0001
    0.0000    0.0000    0.0000   -0.0000   -0.0000
    0.0000    0.0000   -0.0000    0.0000   -0.0000
    0.0000    0.0000   -0.0000   -0.0000   -0.0000
    0.0000    0.0000    0.0000   -0.0000    0.0001
    0.0000    0.0000   -0.0000   -0.0000   -0.0000
    0.0000    0.0000   -0.0000    0.0000    0.0001
    0.0000    0.0000    0.0000    0.0000   -0.0000
   -0.0000    0.0000    0.0000    0.0000   -0.0001
    0.0000    0.0000    0.0000    0.0000   -0.0000
    0.0001   -0.0000   -0.0001   -0.0000    1.1472

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 11 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.280866e+04    0.000e+00    2.678e+03
User objective function returned Inf; trying a new point...
    1      39    9.995142e+03    0.000e+00    4.698e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.441800e+03    0.000e+00    1.046e+03    9.999e-01
User objective function returned Inf; trying a new point...
    3      81    8.301684e+03    0.000e+00    1.179e+03    4.999e-01
User objective function returned Inf; trying a new point...
    4      99    8.235881e+03    0.000e+00    1.524e+03    9.999e-01
User objective function returned Inf; trying a new point...
    5     122    8.072124e+03    0.000e+00    2.671e+02    4.999e-01
User objective function returned Inf; trying a new point...
    6     142    8.062252e+03    0.000e+00    1.576e+02    2.500e-01
User objective function returned Inf; trying a new point...
    7     163    8.014053e+03    0.000e+00    1.478e+02    4.999e-01
User objective function returned Inf; trying a new point...
    8     187    7.987079e+03    0.000e+00    3.187e+02    4.375e-01
User objective function returned Inf; trying a new point...
    9     207    7.978481e+03    0.000e+00    3.632e+02    2.187e-01
User objective function returned Inf; trying a new point...
   10     229    7.952383e+03    0.000e+00    1.253e+02    2.187e-01
User objective function returned Inf; trying a new point...
   11     247    7.934311e+03    0.000e+00    1.312e+02    4.375e-01
User objective function returned Inf; trying a new point...
   12     269    7.930778e+03    0.000e+00    4.710e+02    4.375e-01
User objective function returned Inf; trying a new point...
   13     287    7.907053e+03    0.000e+00    6.417e+02    4.375e-01
User objective function returned Inf; trying a new point...
   14     309    7.881870e+03    0.000e+00    2.498e+02    4.375e-01
User objective function returned Inf; trying a new point...
   15     327    7.868431e+03    0.000e+00    2.169e+02    8.749e-01
User objective function returned Inf; trying a new point...
   16     349    7.861369e+03    0.000e+00    3.708e+02    8.749e-01
User objective function returned Inf; trying a new point...
   17     368    7.853811e+03    0.000e+00    4.883e+02    4.375e-01
User objective function returned Inf; trying a new point...
   18     389    7.814179e+03    0.000e+00    2.081e+02    8.749e-01
User objective function returned Inf; trying a new point...
   19     411    7.811081e+03    0.000e+00    4.816e+02    8.749e-01
User objective function returned Inf; trying a new point...
   20     431    7.808423e+03    0.000e+00    4.486e+02    2.187e-01
User objective function returned Inf; trying a new point...
   21     452    7.767580e+03    0.000e+00    2.260e+02    4.375e-01
User objective function returned Inf; trying a new point...
   22     475    7.762957e+03    0.000e+00    4.709e+01    2.187e-01
User objective function returned Inf; trying a new point...
   23     495    7.762405e+03    0.000e+00    8.663e+01    1.094e-01
User objective function returned Inf; trying a new point...
   24     516    7.760794e+03    0.000e+00    3.696e+01    2.187e-01
User objective function returned Inf; trying a new point...
   25     536    7.760760e+03    0.000e+00    9.528e+01    1.094e-01
   26     558    7.758596e+03    0.000e+00    2.604e+01    1.094e-01
   27     580    7.758458e+03    0.000e+00    1.699e+01    1.094e-01
   28     599    7.758413e+03    0.000e+00    2.559e+01    5.468e-02
   29     620    7.757587e+03    0.000e+00    1.146e+01    1.094e-01
   30     646    7.757508e+03    0.000e+00    8.530e+00    2.392e-02

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     666    7.757495e+03    0.000e+00    5.915e+00    1.196e-02
   32     687    7.757415e+03    0.000e+00    5.573e+00    2.392e-02
   33     710    7.757395e+03    0.000e+00    3.595e+00    4.187e-02
   34     733    7.757354e+03    0.000e+00    4.057e+00    2.093e-02
   35     756    7.757350e+03    0.000e+00    2.335e+00    1.047e-02
   36     774    7.757345e+03    0.000e+00    3.432e+00    1.047e-02
   37     791    7.757331e+03    0.000e+00    3.566e+00    2.044e-02
   38     808    7.757330e+03    0.000e+00    2.699e+00    1.297e-03
   39     825    7.757327e+03    0.000e+00    1.153e+00    4.412e-03
   40     842    7.757326e+03    0.000e+00    1.039e+00    3.644e-03
   41     859    7.757325e+03    0.000e+00    5.795e-01    2.364e-03
   42     876    7.757325e+03    0.000e+00    3.661e-02    9.033e-04
   43     893    7.757325e+03    0.000e+00    1.209e-02    2.427e-04
   44     910    7.757325e+03    0.000e+00    1.159e-03    5.555e-05

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',2.454473e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 1.8812 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

   -0.0004
   -0.0012
   -0.0001
    0.0001
   -0.0002
   -0.0002
   -0.0001
         0
   -0.0002
   -0.0001
         0
    0.0002
   -0.0002
    0.0002
         0
   -0.0002

Value of the log-likelihood function at convergence: -7757.3248
 
                      AIC                      BIC
              ------------------   -----------------------
                  15546.6497               15617.0006
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 1.6165e-09
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS          0.5796     0.0435    13.3196
A_SnGo         0.1403     0.0274     5.1159
A_AgeLT40      0.1116     0.0468     2.3841
A_ExpLT8       0.7509     0.0485    15.4693
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1          -0.9648     0.1331    -7.2480
Bc_2          -1.1683     0.1330    -8.7852
LV_Load        1.2552     0.0534    23.4950
Mu_12         -0.3204     0.0530    -6.0471
Mu_13         -0.8072     0.0638   -12.6480
Mu_14         -0.5099     0.0557    -9.1502
Mu_22         -0.3844     0.0536    -7.1770
Mu_23         -0.5524     0.0568    -9.7324
Mu_24         -0.5008     0.0569    -8.8039
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -0.8498     0.0366   -23.1886
C_VRC         -0.7120     0.0602   -11.8366
C_LV          -1.0132     0.1209    -8.3822
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    2.5756    1.5756
    1.5756    2.5756

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

    0.5796    0.1403    0.1116    0.7509   -0.9648   -1.1683    1.2552   -0.3204   -0.8072   -0.5099   -0.3844

  Columns 12 through 16

   -0.5524   -0.5008   -0.8498   -0.7120   -1.0132

The covariance matrix for these parameters is:

ihess =

  Columns 1 through 11

    0.0019    0.0001    0.0001    0.0003   -0.0036   -0.0037   -0.0008   -0.0002   -0.0003   -0.0002   -0.0002
    0.0001    0.0008    0.0001   -0.0000   -0.0021   -0.0019   -0.0001   -0.0001    0.0000   -0.0001   -0.0000
    0.0001    0.0001    0.0022    0.0001   -0.0016   -0.0015   -0.0001   -0.0001   -0.0000   -0.0000   -0.0000
    0.0003   -0.0000    0.0001    0.0024   -0.0011   -0.0011   -0.0008   -0.0002   -0.0003   -0.0003   -0.0003
   -0.0036   -0.0021   -0.0016   -0.0011    0.0177    0.0158   -0.0008    0.0006    0.0001   -0.0000   -0.0007
   -0.0037   -0.0019   -0.0015   -0.0011    0.0158    0.0177   -0.0011   -0.0006   -0.0006   -0.0005    0.0002
   -0.0008   -0.0001   -0.0001   -0.0008   -0.0008   -0.0011    0.0029    0.0011    0.0011    0.0012    0.0011
   -0.0002   -0.0001   -0.0001   -0.0002    0.0006   -0.0006    0.0011    0.0028    0.0000    0.0003    0.0004
   -0.0003    0.0000   -0.0000   -0.0003    0.0001   -0.0006    0.0011    0.0000    0.0041    0.0001    0.0005
   -0.0002   -0.0001   -0.0000   -0.0003   -0.0000   -0.0005    0.0012    0.0003    0.0001    0.0031    0.0004
   -0.0002   -0.0000   -0.0000   -0.0003   -0.0007    0.0002    0.0011    0.0004    0.0005    0.0004    0.0029
   -0.0003    0.0000   -0.0000   -0.0002   -0.0005   -0.0000    0.0011    0.0004    0.0005    0.0005    0.0001
   -0.0002   -0.0000   -0.0000   -0.0002   -0.0006   -0.0004    0.0011    0.0005    0.0005    0.0005    0.0003
   -0.0000   -0.0000   -0.0000    0.0000    0.0000   -0.0000   -0.0000   -0.0000    0.0000   -0.0001   -0.0000
   -0.0000   -0.0001    0.0000    0.0001    0.0001    0.0001   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000
    0.0031    0.0008    0.0001    0.0006   -0.0073   -0.0075   -0.0014   -0.0002   -0.0004   -0.0005   -0.0003

  Columns 12 through 16

   -0.0003   -0.0002   -0.0000   -0.0000    0.0031
    0.0000   -0.0000   -0.0000   -0.0001    0.0008
   -0.0000   -0.0000   -0.0000    0.0000    0.0001
   -0.0002   -0.0002    0.0000    0.0001    0.0006
   -0.0005   -0.0006    0.0000    0.0001   -0.0073
   -0.0000   -0.0004   -0.0000    0.0001   -0.0075
    0.0011    0.0011   -0.0000   -0.0000   -0.0014
    0.0004    0.0005   -0.0000   -0.0000   -0.0002
    0.0005    0.0005    0.0000   -0.0000   -0.0004
    0.0005    0.0005   -0.0001   -0.0000   -0.0005
    0.0001    0.0003   -0.0000   -0.0000   -0.0003
    0.0032    0.0001   -0.0000   -0.0001   -0.0005
    0.0001    0.0032   -0.0000   -0.0000   -0.0004
   -0.0000   -0.0000    0.0013    0.0009    0.0007
   -0.0001   -0.0000    0.0009    0.0036    0.0011
   -0.0005   -0.0004    0.0007    0.0011    0.0146

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 12 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.301991e+04    0.000e+00    2.707e+03
User objective function returned Inf; trying a new point...
    1      39    9.630660e+03    0.000e+00    4.380e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.165564e+03    0.000e+00    1.353e+03    9.999e-01
User objective function returned Inf; trying a new point...
    3      80    8.152413e+03    0.000e+00    1.144e+03    9.999e-01
User objective function returned Inf; trying a new point...
    4      98    8.049600e+03    0.000e+00    1.955e+03    9.999e-01
User objective function returned Inf; trying a new point...
    5     120    7.880700e+03    0.000e+00    4.475e+02    9.999e-01
User objective function returned Inf; trying a new point...
    6     143    7.793640e+03    0.000e+00    2.174e+02    4.999e-01
User objective function returned Inf; trying a new point...
    7     161    7.724223e+03    0.000e+00    1.003e+03    9.999e-01
User objective function returned Inf; trying a new point...
    8     184    7.676651e+03    0.000e+00    7.407e+01    5.000e-01
User objective function returned Inf; trying a new point...
    9     204    7.674498e+03    0.000e+00    9.780e+01    2.500e-01
User objective function returned Inf; trying a new point...
   10     226    7.644708e+03    0.000e+00    7.682e+01    2.500e-01
User objective function returned Inf; trying a new point...
   11     246    7.643111e+03    0.000e+00    4.705e+02    4.375e-01
User objective function returned Inf; trying a new point...
   12     267    7.585952e+03    0.000e+00    4.981e+02    8.749e-01
User objective function returned Inf; trying a new point...
   13     287    7.562055e+03    0.000e+00    2.494e+02    1.531e+00
User objective function returned Inf; trying a new point...
   14     311    7.539054e+03    0.000e+00    4.368e+02    3.828e-01
User objective function returned Inf; trying a new point...
   15     333    7.537442e+03    0.000e+00    3.087e+02    3.828e-01
User objective function returned Inf; trying a new point...
   16     352    7.535470e+03    0.000e+00    3.534e+02    1.914e-01
User objective function returned Inf; trying a new point...
   17     373    7.519224e+03    0.000e+00    3.312e+02    3.828e-01
User objective function returned Inf; trying a new point...
   18     393    7.517073e+03    0.000e+00    3.456e+02    1.914e-01
User objective function returned Inf; trying a new point...
   19     414    7.512410e+03    0.000e+00    1.770e+02    3.828e-01
User objective function returned Inf; trying a new point...
   20     434    7.512214e+03    0.000e+00    8.407e+01    1.914e-01
User objective function returned Inf; trying a new point...
   21     456    7.501249e+03    0.000e+00    8.487e+01    1.914e-01
User objective function returned Inf; trying a new point...
   22     480    7.498625e+03    0.000e+00    1.043e+02    1.675e-01
User objective function returned Inf; trying a new point...
   23     500    7.497745e+03    0.000e+00    8.613e+01    8.373e-02
User objective function returned Inf; trying a new point...
   24     521    7.495368e+03    0.000e+00    1.095e+02    1.675e-01
User objective function returned Inf; trying a new point...
   25     545    7.494445e+03    0.000e+00    9.535e+01    1.465e-01
User objective function returned Inf; trying a new point...
   26     564    7.494070e+03    0.000e+00    6.640e+01    7.327e-02
   27     585    7.492277e+03    0.000e+00    2.869e+01    1.465e-01
   28     607    7.492017e+03    0.000e+00    1.411e+01    1.465e-01
User objective function returned Inf; trying a new point...
   29     625    7.491965e+03    0.000e+00    5.784e+01    1.465e-01
   30     648    7.490873e+03    0.000e+00    1.832e+01    7.327e-02

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     672    7.490832e+03    0.000e+00    1.558e+01    6.411e-02
   32     691    7.490792e+03    0.000e+00    1.160e+01    3.205e-02
   33     712    7.490731e+03    0.000e+00    8.167e+00    6.411e-02
   34     732    7.490725e+03    0.000e+00    5.912e+00    1.603e-02
   35     750    7.490702e+03    0.000e+00    1.669e+01    1.059e-01
   36     769    7.490585e+03    0.000e+00    8.438e+00    4.717e-02
   37     786    7.490499e+03    0.000e+00    1.680e+00    3.063e-02
   38     803    7.490496e+03    0.000e+00    6.604e-01    7.736e-03
   39     820    7.490496e+03    0.000e+00    6.409e-02    4.373e-03
   40     837    7.490496e+03    0.000e+00    2.240e-02    1.458e-04

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',5.557093e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 1.6873 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

    0.0201
    0.0224
    0.0027
    0.0029
    0.0018
    0.0064
    0.0064
   -0.0002
    0.0007
    0.0016
   -0.0021
    0.0002
   -0.0009
    0.0011
   -0.0025
    0.0011

Value of the log-likelihood function at convergence: -7490.4961
 
                      AIC                      BIC
              ------------------   -----------------------
                  15012.9921               15083.3430
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 1.8238e-07
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS          0.4956     0.0391    12.6657
A_SnGo         0.1249     0.0292     4.2751
A_AgeLT40      0.5732     0.0490    11.7041
A_ExpLT8       0.6868     0.0479    14.3459
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1          -1.1576     0.1457    -7.9475
Bc_2          -1.3678     0.1472    -9.2893
LV_Load        1.3453     0.0570    23.5871
Mu_12         -0.6124     0.0642    -9.5375
Mu_13         -0.6615     0.0621   -10.6513
Mu_14         -0.5219     0.0577    -9.0405
Mu_22         -0.3747     0.0552    -6.7854
Mu_23         -0.4608     0.0562    -8.1927
Mu_24         -0.8666     0.0679   -12.7553
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -0.9031     0.0353   -25.5569
C_VRC         -0.6106     0.0577   -10.5905
C_LV          -0.9531     0.1341    -7.1096
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    2.8099    1.8099
    1.8099    2.8099

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

    0.4956    0.1249    0.5732    0.6868   -1.1576   -1.3678    1.3453   -0.6124   -0.6615   -0.5219   -0.3747

  Columns 12 through 16

   -0.4608   -0.8666   -0.9031   -0.6106   -0.9531

The covariance matrix for these parameters is:

ihess =

  Columns 1 through 11

    0.0015    0.0003    0.0002    0.0002   -0.0038   -0.0038   -0.0005   -0.0001   -0.0002   -0.0002   -0.0001
    0.0003    0.0009    0.0001    0.0000   -0.0028   -0.0028   -0.0001   -0.0000   -0.0000    0.0000   -0.0000
    0.0002    0.0001    0.0024    0.0002   -0.0015   -0.0015   -0.0006   -0.0001   -0.0001   -0.0001   -0.0001
    0.0002    0.0000    0.0002    0.0023   -0.0010   -0.0010   -0.0008   -0.0001   -0.0001   -0.0002   -0.0002
   -0.0038   -0.0028   -0.0015   -0.0010    0.0212    0.0198   -0.0014    0.0002   -0.0003   -0.0004   -0.0009
   -0.0038   -0.0028   -0.0015   -0.0010    0.0198    0.0217   -0.0017   -0.0010   -0.0010   -0.0010   -0.0000
   -0.0005   -0.0001   -0.0006   -0.0008   -0.0014   -0.0017    0.0033    0.0013    0.0013    0.0013    0.0013
   -0.0001   -0.0000   -0.0001   -0.0001    0.0002   -0.0010    0.0013    0.0041    0.0001    0.0002    0.0005
   -0.0002   -0.0000   -0.0001   -0.0001   -0.0003   -0.0010    0.0013    0.0001    0.0039    0.0002    0.0005
   -0.0002    0.0000   -0.0001   -0.0002   -0.0004   -0.0010    0.0013    0.0002    0.0002    0.0033    0.0005
   -0.0001   -0.0000   -0.0001   -0.0002   -0.0009   -0.0000    0.0013    0.0005    0.0005    0.0005    0.0030
   -0.0002   -0.0000   -0.0001   -0.0002   -0.0009   -0.0006    0.0013    0.0006    0.0006    0.0005    0.0002
   -0.0001   -0.0000   -0.0001   -0.0002   -0.0008   -0.0005    0.0012    0.0005    0.0005    0.0005    0.0002
   -0.0000    0.0001    0.0000    0.0000   -0.0001   -0.0001    0.0000    0.0000    0.0000    0.0000   -0.0000
   -0.0000   -0.0000   -0.0000   -0.0000    0.0003    0.0002   -0.0001   -0.0000    0.0000    0.0001   -0.0001
    0.0027    0.0018    0.0006    0.0004   -0.0108   -0.0109   -0.0009   -0.0002   -0.0002   -0.0003   -0.0002

  Columns 12 through 16

   -0.0002   -0.0001   -0.0000   -0.0000    0.0027
   -0.0000   -0.0000    0.0001   -0.0000    0.0018
   -0.0001   -0.0001    0.0000   -0.0000    0.0006
   -0.0002   -0.0002    0.0000   -0.0000    0.0004
   -0.0009   -0.0008   -0.0001    0.0003   -0.0108
   -0.0006   -0.0005   -0.0001    0.0002   -0.0109
    0.0013    0.0012    0.0000   -0.0001   -0.0009
    0.0006    0.0005    0.0000   -0.0000   -0.0002
    0.0006    0.0005    0.0000    0.0000   -0.0002
    0.0005    0.0005    0.0000    0.0001   -0.0003
    0.0002    0.0002   -0.0000   -0.0001   -0.0002
    0.0032    0.0002    0.0000   -0.0000   -0.0003
    0.0002    0.0046    0.0000   -0.0001   -0.0001
    0.0000    0.0000    0.0012    0.0007    0.0006
   -0.0000   -0.0001    0.0007    0.0033    0.0008
   -0.0003   -0.0001    0.0006    0.0008    0.0180

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 13 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.174893e+04    0.000e+00    2.043e+03
User objective function returned Inf; trying a new point...
    1      39    1.050419e+04    0.000e+00    5.233e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.562992e+03    0.000e+00    3.821e+02    9.999e-01
User objective function returned Inf; trying a new point...
    3      80    8.513603e+03    0.000e+00    1.737e+03    9.999e-01
User objective function returned Inf; trying a new point...
    4      98    8.427894e+03    0.000e+00    1.516e+03    9.999e-01
User objective function returned Inf; trying a new point...
    5     120    8.364183e+03    0.000e+00    4.456e+02    9.999e-01
User objective function returned Inf; trying a new point...
    6     139    8.344510e+03    0.000e+00    7.442e+02    5.000e-01
User objective function returned Inf; trying a new point...
    7     160    8.216399e+03    0.000e+00    4.915e+02    9.999e-01
User objective function returned Inf; trying a new point...
    8     180    8.182987e+03    0.000e+00    7.902e+02    4.999e-01
User objective function returned Inf; trying a new point...
    9     202    8.157078e+03    0.000e+00    3.787e+02    5.000e-01
User objective function returned Inf; trying a new point...
   10     224    8.156362e+03    0.000e+00    2.436e+02    4.999e-01
User objective function returned Inf; trying a new point...
   11     243    8.152435e+03    0.000e+00    1.873e+02    2.500e-01
User objective function returned Inf; trying a new point...
   12     264    8.120230e+03    0.000e+00    1.570e+02    4.999e-01
User objective function returned Inf; trying a new point...
   13     283    8.110120e+03    0.000e+00    2.631e+02    5.000e-01
User objective function returned Inf; trying a new point...
   14     304    8.107679e+03    0.000e+00    1.818e+02    9.999e-01
User objective function returned Inf; trying a new point...
   15     323    8.095449e+03    0.000e+00    1.755e+02    5.000e-01
User objective function returned Inf; trying a new point...
   16     344    8.061806e+03    0.000e+00    1.229e+02    9.999e-01
User objective function returned Inf; trying a new point...
   17     367    8.042124e+03    0.000e+00    1.587e+02    5.000e-01
User objective function returned Inf; trying a new point...
   18     385    8.042076e+03    0.000e+00    3.312e+02    9.999e-01
User objective function returned Inf; trying a new point...
   19     408    8.002903e+03    0.000e+00    1.592e+02    5.000e-01
User objective function returned Inf; trying a new point...
   20     428    7.999863e+03    0.000e+00    6.677e+01    2.500e-01
User objective function returned Inf; trying a new point...
   21     452    7.999178e+03    0.000e+00    1.767e+02    6.249e-02
   22     470    7.999163e+03    0.000e+00    1.772e+02    6.249e-02
   23     491    7.994009e+03    0.000e+00    3.535e+01    1.250e-01
   24     513    7.993429e+03    0.000e+00    4.314e+01    1.250e-01
User objective function returned Inf; trying a new point...
   25     532    7.993401e+03    0.000e+00    5.412e+01    1.250e-01
   26     554    7.991619e+03    0.000e+00    2.940e+01    1.250e-01
   27     577    7.990916e+03    0.000e+00    3.999e+01    6.249e-02
   28     601    7.990565e+03    0.000e+00    2.773e+01    5.468e-02
User objective function returned Inf; trying a new point...
   29     620    7.990353e+03    0.000e+00    3.301e+01    5.468e-02
   30     642    7.990064e+03    0.000e+00    1.607e+01    5.468e-02

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     662    7.989963e+03    0.000e+00    9.586e+00    2.734e-02
   32     683    7.989708e+03    0.000e+00    1.576e+01    5.468e-02
   33     707    7.989520e+03    0.000e+00    1.237e+01    4.785e-02
   34     727    7.989510e+03    0.000e+00    9.592e+00    2.392e-02
   35     745    7.989417e+03    0.000e+00    1.056e+01    5.358e-02
   36     762    7.989315e+03    0.000e+00    5.692e+00    3.602e-02
   37     779    7.989295e+03    0.000e+00    1.393e+00    1.111e-02
   38     796    7.989295e+03    0.000e+00    1.667e-01    3.812e-03
   39     813    7.989294e+03    0.000e+00    1.634e-02    6.675e-04
   40     830    7.989294e+03    0.000e+00    8.524e-04    4.513e-05

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',2.944965e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 1.714 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

   1.0e-03 *

   -0.3052
   -0.0610
         0
   -0.2441
    0.5493
    0.6625
   -0.2441
    0.4883
   -0.2441
   -0.1221
    0.5493
    0.8545
    0.4272
   -0.5493
    0.3052
    0.6714

Value of the log-likelihood function at convergence: -7989.2945
 
                      AIC                      BIC
              ------------------   -----------------------
                  16010.5890               16080.9398
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 2.0402e-08
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS          0.6293     0.0549    11.4594
A_SnGo         0.1366     0.0320     4.2657
A_AgeLT40      0.0685     0.0522     1.3128
A_ExpLT8       0.5742     0.0535    10.7389
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1          -0.8512     0.1041    -8.1760
Bc_2          -1.0134     0.1056    -9.5924
LV_Load        0.9853     0.0468    21.0529
Mu_12         -0.5593     0.0540   -10.3615
Mu_13         -0.8313     0.0601   -13.8276
Mu_14         -0.6366     0.0545   -11.6847
Mu_22         -0.4686     0.0498    -9.4170
Mu_23         -0.5248     0.0508   -10.3351
Mu_24         -0.5717     0.0565   -10.1100
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -0.9916     0.0388   -25.5607
C_VRC         -0.7441     0.0617   -12.0683
C_LV          -0.6896     0.1121    -6.1498
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    1.9709    0.9709
    0.9709    1.9709

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

    0.6293    0.1366    0.0685    0.5742   -0.8512   -1.0134    0.9853   -0.5593   -0.8313   -0.6366   -0.4686

  Columns 12 through 16

   -0.5248   -0.5717   -0.9916   -0.7441   -0.6896

The covariance matrix for these parameters is:

ihess =

  Columns 1 through 11

    0.0030   -0.0003   -0.0001    0.0003   -0.0034   -0.0034   -0.0009   -0.0003   -0.0002   -0.0002   -0.0002
   -0.0003    0.0010    0.0001   -0.0001   -0.0012   -0.0011   -0.0002    0.0001   -0.0000   -0.0001   -0.0000
   -0.0001    0.0001    0.0027    0.0001   -0.0010   -0.0011   -0.0001    0.0000    0.0000    0.0000   -0.0000
    0.0003   -0.0001    0.0001    0.0029   -0.0008   -0.0007   -0.0007   -0.0002   -0.0002   -0.0002   -0.0003
   -0.0034   -0.0012   -0.0010   -0.0008    0.0108    0.0098   -0.0007   -0.0000   -0.0002   -0.0001   -0.0007
   -0.0034   -0.0011   -0.0011   -0.0007    0.0098    0.0112   -0.0009   -0.0009   -0.0008   -0.0005    0.0000
   -0.0009   -0.0002   -0.0001   -0.0007   -0.0007   -0.0009    0.0022    0.0009    0.0009    0.0009    0.0009
   -0.0003    0.0001    0.0000   -0.0002   -0.0000   -0.0009    0.0009    0.0029    0.0001    0.0002    0.0003
   -0.0002   -0.0000    0.0000   -0.0002   -0.0002   -0.0008    0.0009    0.0001    0.0036   -0.0000    0.0003
   -0.0002   -0.0001    0.0000   -0.0002   -0.0001   -0.0005    0.0009    0.0002   -0.0000    0.0030    0.0003
   -0.0002   -0.0000   -0.0000   -0.0003   -0.0007    0.0000    0.0009    0.0003    0.0003    0.0003    0.0025
   -0.0003   -0.0000   -0.0000   -0.0002   -0.0005   -0.0002    0.0009    0.0004    0.0004    0.0004    0.0001
   -0.0003   -0.0001   -0.0001   -0.0002   -0.0004   -0.0002    0.0009    0.0004    0.0004    0.0004    0.0002
    0.0001   -0.0001    0.0000    0.0000   -0.0002   -0.0001    0.0000   -0.0001   -0.0000   -0.0000    0.0000
    0.0001   -0.0001    0.0000   -0.0000    0.0001    0.0001   -0.0000    0.0000   -0.0001   -0.0000   -0.0001
    0.0035   -0.0006   -0.0001    0.0003   -0.0037   -0.0036   -0.0009   -0.0005   -0.0004   -0.0003   -0.0002

  Columns 12 through 16

   -0.0003   -0.0003    0.0001    0.0001    0.0035
   -0.0000   -0.0001   -0.0001   -0.0001   -0.0006
   -0.0000   -0.0001    0.0000    0.0000   -0.0001
   -0.0002   -0.0002    0.0000   -0.0000    0.0003
   -0.0005   -0.0004   -0.0002    0.0001   -0.0037
   -0.0002   -0.0002   -0.0001    0.0001   -0.0036
    0.0009    0.0009    0.0000   -0.0000   -0.0009
    0.0004    0.0004   -0.0001    0.0000   -0.0005
    0.0004    0.0004   -0.0000   -0.0001   -0.0004
    0.0004    0.0004   -0.0000   -0.0000   -0.0003
    0.0001    0.0002    0.0000   -0.0001   -0.0002
    0.0026    0.0001    0.0000    0.0000   -0.0002
    0.0001    0.0032    0.0000   -0.0000   -0.0003
    0.0000    0.0000    0.0015    0.0008    0.0005
    0.0000   -0.0000    0.0008    0.0038    0.0007
   -0.0002   -0.0003    0.0005    0.0007    0.0126

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 14 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.309780e+04    0.000e+00    2.757e+03
User objective function returned Inf; trying a new point...
    1      39    9.818447e+03    0.000e+00    4.408e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.400641e+03    0.000e+00    1.374e+03    9.999e-01
User objective function returned Inf; trying a new point...
    3      80    8.360956e+03    0.000e+00    1.085e+03    9.999e-01
User objective function returned Inf; trying a new point...
    4      98    8.147422e+03    0.000e+00    1.653e+03    9.999e-01
User objective function returned Inf; trying a new point...
    5     120    8.043123e+03    0.000e+00    6.893e+02    9.999e-01
User objective function returned Inf; trying a new point...
    6     142    7.945107e+03    0.000e+00    4.243e+02    5.000e-01
User objective function returned Inf; trying a new point...
    7     162    7.909455e+03    0.000e+00    5.023e+02    2.500e-01
User objective function returned Inf; trying a new point...
    8     183    7.858828e+03    0.000e+00    6.790e+02    4.999e-01
User objective function returned Inf; trying a new point...
    9     208    7.838604e+03    0.000e+00    3.852e+02    2.187e-01
User objective function returned Inf; trying a new point...
   10     226    7.824804e+03    0.000e+00    4.311e+02    2.187e-01
User objective function returned Inf; trying a new point...
   11     247    7.764196e+03    0.000e+00    2.342e+02    4.375e-01
User objective function returned Inf; trying a new point...
   12     267    7.726316e+03    0.000e+00    2.271e+02    7.655e-01
User objective function returned Inf; trying a new point...
   13     290    7.698749e+03    0.000e+00    4.611e+02    3.828e-01
User objective function returned Inf; trying a new point...
   14     309    7.686179e+03    0.000e+00    3.836e+02    3.828e-01
User objective function returned Inf; trying a new point...
   15     334    7.676919e+03    0.000e+00    2.761e+02    4.785e-02
User objective function returned Inf; trying a new point...
   16     352    7.675754e+03    0.000e+00    2.765e+02    9.569e-02
User objective function returned Inf; trying a new point...
   17     373    7.660189e+03    0.000e+00    6.016e+01    1.914e-01
User objective function returned Inf; trying a new point...
   18     396    7.656008e+03    0.000e+00    1.837e+02    3.349e-01
User objective function returned Inf; trying a new point...
   19     418    7.649533e+03    0.000e+00    1.473e+02    3.349e-01
User objective function returned Inf; trying a new point...
   20     437    7.649389e+03    0.000e+00    2.269e+02    3.349e-01
User objective function returned Inf; trying a new point...
   21     459    7.643540e+03    0.000e+00    1.206e+02    3.349e-01
User objective function returned Inf; trying a new point...
   22     481    7.640654e+03    0.000e+00    1.164e+02    3.349e-01
User objective function returned Inf; trying a new point...
   23     501    7.640619e+03    0.000e+00    8.976e+01    8.373e-02
   24     522    7.630058e+03    0.000e+00    6.608e+01    1.675e-01
User objective function returned Inf; trying a new point...
   25     546    7.628475e+03    0.000e+00    6.061e+01    1.465e-01
User objective function returned Inf; trying a new point...
   26     568    7.627570e+03    0.000e+00    8.446e+01    1.465e-01
   27     588    7.627461e+03    0.000e+00    7.261e+01    7.327e-02
   28     609    7.626296e+03    0.000e+00    6.333e+01    1.465e-01
User objective function returned Inf; trying a new point...
   29     632    7.625724e+03    0.000e+00    4.512e+01    7.327e-02
   30     654    7.625420e+03    0.000e+00    1.548e+01    7.327e-02

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     674    7.625310e+03    0.000e+00    1.656e+01    3.663e-02
   32     696    7.625098e+03    0.000e+00    2.682e+01    3.663e-02
   33     719    7.625053e+03    0.000e+00    8.035e+00    1.832e-02
   34     739    7.625045e+03    0.000e+00    7.112e+00    9.158e-03
   35     761    7.625031e+03    0.000e+00    4.267e+00    9.158e-03
   36     781    7.625031e+03    0.000e+00    3.869e+00    4.579e-03
   37     799    7.625031e+03    0.000e+00    3.472e+00    3.722e-03
   38     821    7.625029e+03    0.000e+00    1.035e+00    3.722e-03
   39     840    7.625028e+03    0.000e+00    8.587e-01    2.142e-03
   40     858    7.625027e+03    0.000e+00    6.324e-01    5.148e-03
   41     875    7.625027e+03    0.000e+00    4.091e-01    1.727e-03
   42     892    7.625026e+03    0.000e+00    7.181e-02    2.158e-03
   43     909    7.625026e+03    0.000e+00    9.423e-03    4.424e-04
   44     926    7.625026e+03    0.000e+00    9.135e-04    4.077e-05

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',1.761970e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 1.8663 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

   1.0e-03 *

   -0.9155
   -0.8545
   -0.3662
   -0.7324
    0.6807
   -0.3432
    0.0532
   -0.0610
    0.2441
   -0.1221
    0.3662
    0.1831
   -0.0610
    0.3052
    0.6714
    0.1221

Value of the log-likelihood function at convergence: -7625.0264
 
                      AIC                      BIC
              ------------------   -----------------------
                  15282.0529               15352.4038
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 1.2649e-08
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS          0.5184     0.0417    12.4175
A_SnGo         0.2883     0.0340     8.4807
A_AgeLT40      0.6089     0.0502    12.1218
A_ExpLT8       0.7823     0.0507    15.4239
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1          -1.2553     0.1305    -9.6183
Bc_2          -1.4229     0.1301   -10.9405
LV_Load        1.1470     0.0501    22.9022
Mu_12         -0.3756     0.0530    -7.0903
Mu_13         -0.6123     0.0570   -10.7364
Mu_14         -0.7443     0.0614   -12.1159
Mu_22         -0.5286     0.0562    -9.4069
Mu_23         -0.4664     0.0543    -8.5972
Mu_24         -0.8151     0.0640   -12.7337
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -0.8835     0.0365   -24.2329
C_VRC         -0.8479     0.0605   -14.0084
C_LV          -0.8602     0.1074    -8.0069
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    2.3156    1.3156
    1.3156    2.3156

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

    0.5184    0.2883    0.6089    0.7823   -1.2553   -1.4229    1.1470   -0.3756   -0.6123   -0.7443   -0.5286

  Columns 12 through 16

   -0.4664   -0.8151   -0.8835   -0.8479   -0.8602

The covariance matrix for these parameters is:

ihess =

  Columns 1 through 11

    0.0017    0.0002    0.0002    0.0001   -0.0030   -0.0031   -0.0006   -0.0002   -0.0001   -0.0002   -0.0001
    0.0002    0.0012    0.0002    0.0001   -0.0027   -0.0026   -0.0003   -0.0001    0.0000   -0.0001   -0.0000
    0.0002    0.0002    0.0025    0.0003   -0.0012   -0.0012   -0.0006   -0.0002   -0.0002   -0.0002   -0.0001
    0.0001    0.0001    0.0003    0.0026   -0.0005   -0.0006   -0.0008   -0.0002   -0.0002   -0.0002   -0.0002
   -0.0030   -0.0027   -0.0012   -0.0005    0.0170    0.0155   -0.0015    0.0002   -0.0009   -0.0003   -0.0011
   -0.0031   -0.0026   -0.0012   -0.0006    0.0155    0.0169   -0.0014   -0.0008   -0.0014   -0.0007   -0.0001
   -0.0006   -0.0003   -0.0006   -0.0008   -0.0015   -0.0014    0.0025    0.0010    0.0010    0.0010    0.0009
   -0.0002   -0.0001   -0.0002   -0.0002    0.0002   -0.0008    0.0010    0.0028    0.0001    0.0002    0.0004
   -0.0001    0.0000   -0.0002   -0.0002   -0.0009   -0.0014    0.0010    0.0001    0.0033    0.0001    0.0004
   -0.0002   -0.0001   -0.0002   -0.0002   -0.0003   -0.0007    0.0010    0.0002    0.0001    0.0038    0.0004
   -0.0001   -0.0000   -0.0001   -0.0002   -0.0011   -0.0001    0.0009    0.0004    0.0004    0.0004    0.0032
   -0.0002   -0.0001   -0.0002   -0.0002   -0.0008   -0.0003    0.0011    0.0004    0.0005    0.0005    0.0001
   -0.0003   -0.0002   -0.0002   -0.0002   -0.0006   -0.0003    0.0011    0.0004    0.0004    0.0005    0.0002
    0.0000    0.0000    0.0000    0.0000   -0.0003   -0.0002    0.0001    0.0000   -0.0000    0.0001    0.0000
    0.0001    0.0000    0.0000    0.0001   -0.0003   -0.0003    0.0001    0.0000   -0.0000    0.0001   -0.0000
    0.0019    0.0017    0.0005    0.0003   -0.0067   -0.0065   -0.0008   -0.0002    0.0000   -0.0002   -0.0000

  Columns 12 through 16

   -0.0002   -0.0003    0.0000    0.0001    0.0019
   -0.0001   -0.0002    0.0000    0.0000    0.0017
   -0.0002   -0.0002    0.0000    0.0000    0.0005
   -0.0002   -0.0002    0.0000    0.0001    0.0003
   -0.0008   -0.0006   -0.0003   -0.0003   -0.0067
   -0.0003   -0.0003   -0.0002   -0.0003   -0.0065
    0.0011    0.0011    0.0001    0.0001   -0.0008
    0.0004    0.0004    0.0000    0.0000   -0.0002
    0.0005    0.0004   -0.0000   -0.0000    0.0000
    0.0005    0.0005    0.0001    0.0001   -0.0002
    0.0001    0.0002    0.0000   -0.0000   -0.0000
    0.0029    0.0001    0.0000    0.0001   -0.0002
    0.0001    0.0041    0.0000    0.0001   -0.0003
    0.0000    0.0000    0.0013    0.0008    0.0006
    0.0001    0.0001    0.0008    0.0037    0.0010
   -0.0002   -0.0003    0.0006    0.0010    0.0115

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 15 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.255684e+04    0.000e+00    2.471e+03
User objective function returned Inf; trying a new point...
    1      39    1.030695e+04    0.000e+00    4.929e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.570295e+03    0.000e+00    5.370e+02    9.999e-01
User objective function returned Inf; trying a new point...
    3      81    8.502400e+03    0.000e+00    1.469e+03    4.999e-01
User objective function returned Inf; trying a new point...
    4      99    8.391683e+03    0.000e+00    1.509e+03    5.000e-01
User objective function returned Inf; trying a new point...
    5     120    8.385054e+03    0.000e+00    6.226e+02    9.999e-01
User objective function returned Inf; trying a new point...
    6     142    8.259134e+03    0.000e+00    5.055e+02    4.999e-01
User objective function returned Inf; trying a new point...
    7     161    8.258531e+03    0.000e+00    1.036e+03    4.999e-01
User objective function returned Inf; trying a new point...
    8     183    8.232078e+03    0.000e+00    2.028e+02    4.999e-01
User objective function returned Inf; trying a new point...
    9     202    8.224808e+03    0.000e+00    2.181e+02    2.500e-01
User objective function returned Inf; trying a new point...
   10     223    8.172673e+03    0.000e+00    3.282e+02    5.000e-01
User objective function returned Inf; trying a new point...
   11     242    8.148802e+03    0.000e+00    5.471e+02    5.000e-01
User objective function returned Inf; trying a new point...
   12     264    8.133580e+03    0.000e+00    4.721e+02    5.000e-01
User objective function returned Inf; trying a new point...
   13     283    8.125426e+03    0.000e+00    2.048e+02    5.000e-01
User objective function returned Inf; trying a new point...
   14     304    8.084070e+03    0.000e+00    1.187e+02    9.999e-01
User objective function returned Inf; trying a new point...
   15     323    8.067681e+03    0.000e+00    3.064e+02    9.999e-01
User objective function returned Inf; trying a new point...
   16     346    7.992033e+03    0.000e+00    3.276e+02    5.000e-01
User objective function returned Inf; trying a new point...
   17     371    7.987281e+03    0.000e+00    4.156e+02    2.187e-01
User objective function returned Inf; trying a new point...
   18     389    7.983054e+03    0.000e+00    4.244e+02    2.187e-01
User objective function returned Inf; trying a new point...
   19     410    7.957311e+03    0.000e+00    9.775e+01    4.375e-01
User objective function returned Inf; trying a new point...
   20     430    7.953182e+03    0.000e+00    1.388e+02    2.187e-01
User objective function returned Inf; trying a new point...
   21     453    7.947489e+03    0.000e+00    7.668e+01    1.094e-01
User objective function returned Inf; trying a new point...
   22     471    7.945525e+03    0.000e+00    1.084e+02    2.187e-01
User objective function returned Inf; trying a new point...
   23     493    7.942092e+03    0.000e+00    9.893e+01    2.187e-01
   24     515    7.938456e+03    0.000e+00    9.946e+01    2.187e-01
User objective function returned Inf; trying a new point...
   25     534    7.937432e+03    0.000e+00    1.483e+02    2.187e-01
User objective function returned Inf; trying a new point...
   26     556    7.937234e+03    0.000e+00    7.664e+01    2.187e-01
User objective function returned Inf; trying a new point...
   27     575    7.936641e+03    0.000e+00    5.925e+01    1.094e-01
   28     596    7.932077e+03    0.000e+00    4.071e+01    2.187e-01
   29     619    7.930833e+03    0.000e+00    4.592e+01    1.094e-01
   30     641    7.930249e+03    0.000e+00    2.946e+01    1.094e-01

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     663    7.929882e+03    0.000e+00    1.410e+01    1.094e-01
   32     685    7.929656e+03    0.000e+00    2.593e+01    1.094e-01
   33     705    7.929614e+03    0.000e+00    2.749e+01    2.734e-02
   34     726    7.929011e+03    0.000e+00    1.320e+01    5.468e-02
   35     748    7.928907e+03    0.000e+00    1.568e+01    5.468e-02
   36     773    7.928879e+03    0.000e+00    1.196e+01    2.392e-02
   37     792    7.928874e+03    0.000e+00    1.410e+01    2.006e-02
   38     814    7.928819e+03    0.000e+00    4.282e+00    2.006e-02
   39     831    7.928782e+03    0.000e+00    5.592e+00    1.046e-02
   40     849    7.928764e+03    0.000e+00    4.064e+00    2.693e-02
   41     867    7.928741e+03    0.000e+00    2.677e+00    2.752e-02
   42     884    7.928728e+03    0.000e+00    1.242e+00    7.944e-03
   43     901    7.928727e+03    0.000e+00    2.256e-01    3.014e-03
   44     918    7.928727e+03    0.000e+00    4.094e-02    6.626e-04
   45     935    7.928727e+03    0.000e+00    1.428e-02    1.140e-04

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',7.485106e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 1.9455 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

   -0.0016
    0.0143
    0.0011
    0.0017
   -0.0010
    0.0027
    0.0048
    0.0004
    0.0006
    0.0015
   -0.0020
   -0.0018
   -0.0005
   -0.0015
   -0.0009
    0.0018

Value of the log-likelihood function at convergence: -7928.7267
 
                      AIC                      BIC
              ------------------   -----------------------
                  15889.4535               15959.8044
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 2.0217e-07
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS          0.6099     0.0475    12.8471
A_SnGo         0.0588     0.0294     1.9957
A_AgeLT40      0.4251     0.0520     8.1684
A_ExpLT8       0.6061     0.0521    11.6416
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1          -0.7506     0.1195    -6.2817
Bc_2          -0.7995     0.1197    -6.6768
LV_Load        1.0626     0.0489    21.7143
Mu_12         -0.6558     0.0621   -10.5573
Mu_13         -0.5443     0.0544   -10.0010
Mu_14         -0.4632     0.0522    -8.8713
Mu_22         -0.2552     0.0489    -5.2202
Mu_23         -0.7711     0.0621   -12.4108
Mu_24         -0.6470     0.0561   -11.5251
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -0.9508     0.0368   -25.8318
C_VRC         -0.7810     0.0625   -12.5014
C_LV          -0.9711     0.1230    -7.8935
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    2.1292    1.1292
    1.1292    2.1292

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

    0.6099    0.0588    0.4251    0.6061   -0.7506   -0.7995    1.0626   -0.6558   -0.5443   -0.4632   -0.2552

  Columns 12 through 16

   -0.7711   -0.6470   -0.9508   -0.7810   -0.9711

The covariance matrix for these parameters is:

ihess =

  Columns 1 through 11

    0.0023    0.0000    0.0003    0.0003   -0.0035   -0.0036   -0.0007   -0.0002   -0.0003   -0.0002   -0.0002
    0.0000    0.0009   -0.0000   -0.0000   -0.0019   -0.0018    0.0000    0.0000    0.0001    0.0000    0.0000
    0.0003   -0.0000    0.0027    0.0004   -0.0012   -0.0012   -0.0005   -0.0002   -0.0002   -0.0001   -0.0002
    0.0003   -0.0000    0.0004    0.0027   -0.0010   -0.0010   -0.0007   -0.0002   -0.0002   -0.0002   -0.0002
   -0.0035   -0.0019   -0.0012   -0.0010    0.0143    0.0128   -0.0011    0.0004   -0.0000   -0.0003   -0.0007
   -0.0036   -0.0018   -0.0012   -0.0010    0.0128    0.0143   -0.0010   -0.0007   -0.0005   -0.0006    0.0002
   -0.0007    0.0000   -0.0005   -0.0007   -0.0011   -0.0010    0.0024    0.0009    0.0010    0.0010    0.0010
   -0.0002    0.0000   -0.0002   -0.0002    0.0004   -0.0007    0.0009    0.0039   -0.0000    0.0004    0.0005
   -0.0003    0.0001   -0.0002   -0.0002   -0.0000   -0.0005    0.0010   -0.0000    0.0030    0.0000    0.0004
   -0.0002    0.0000   -0.0001   -0.0002   -0.0003   -0.0006    0.0010    0.0004    0.0000    0.0027    0.0005
   -0.0002    0.0000   -0.0002   -0.0002   -0.0007    0.0002    0.0010    0.0005    0.0004    0.0005    0.0024
   -0.0003    0.0000   -0.0001   -0.0002   -0.0006   -0.0001    0.0010    0.0002    0.0006    0.0004    0.0001
   -0.0002   -0.0000   -0.0001   -0.0002   -0.0005   -0.0003    0.0009    0.0005    0.0004    0.0004    0.0001
    0.0000   -0.0000    0.0000    0.0001   -0.0001   -0.0000   -0.0000   -0.0001   -0.0000    0.0000    0.0000
    0.0000   -0.0001    0.0000    0.0001    0.0001    0.0001   -0.0001   -0.0001   -0.0000   -0.0000    0.0000
    0.0036    0.0006    0.0003    0.0004   -0.0066   -0.0065   -0.0013   -0.0005   -0.0004   -0.0005   -0.0004

  Columns 12 through 16

   -0.0003   -0.0002    0.0000    0.0000    0.0036
    0.0000   -0.0000   -0.0000   -0.0001    0.0006
   -0.0001   -0.0001    0.0000    0.0000    0.0003
   -0.0002   -0.0002    0.0001    0.0001    0.0004
   -0.0006   -0.0005   -0.0001    0.0001   -0.0066
   -0.0001   -0.0003   -0.0000    0.0001   -0.0065
    0.0010    0.0009   -0.0000   -0.0001   -0.0013
    0.0002    0.0005   -0.0001   -0.0001   -0.0005
    0.0006    0.0004   -0.0000   -0.0000   -0.0004
    0.0004    0.0004    0.0000   -0.0000   -0.0005
    0.0001    0.0001    0.0000    0.0000   -0.0004
    0.0039    0.0000    0.0000    0.0001   -0.0004
    0.0000    0.0032    0.0000   -0.0001   -0.0005
    0.0000    0.0000    0.0014    0.0008    0.0007
    0.0001   -0.0001    0.0008    0.0039    0.0010
   -0.0004   -0.0005    0.0007    0.0010    0.0151

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 16 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.236585e+04    0.000e+00    2.334e+03
User objective function returned Inf; trying a new point...
    1      39    1.037284e+04    0.000e+00    4.861e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.572755e+03    0.000e+00    3.700e+02    9.999e-01
User objective function returned Inf; trying a new point...
    3      80    8.554530e+03    0.000e+00    1.536e+03    9.999e-01
User objective function returned Inf; trying a new point...
    4      98    8.389699e+03    0.000e+00    1.993e+03    9.999e-01
User objective function returned Inf; trying a new point...
    5     120    8.224019e+03    0.000e+00    6.503e+02    9.999e-01
User objective function returned Inf; trying a new point...
    6     140    8.178074e+03    0.000e+00    4.770e+02    4.999e-01
User objective function returned Inf; trying a new point...
    7     161    8.111694e+03    0.000e+00    3.282e+02    9.999e-01
User objective function returned Inf; trying a new point...
    8     179    8.110326e+03    0.000e+00    2.368e+02    9.999e-01
User objective function returned Inf; trying a new point...
    9     201    7.956723e+03    0.000e+00    3.842e+02    9.999e-01
User objective function returned Inf; trying a new point...
   10     221    7.941850e+03    0.000e+00    2.194e+02    5.000e-01
User objective function returned Inf; trying a new point...
   11     242    7.867535e+03    0.000e+00    3.416e+02    9.999e-01
User objective function returned Inf; trying a new point...
   12     262    7.842997e+03    0.000e+00    3.372e+02    5.000e-01
User objective function returned Inf; trying a new point...
   13     284    7.769095e+03    0.000e+00    4.856e+02    5.000e-01
User objective function returned Inf; trying a new point...
   14     304    7.762652e+03    0.000e+00    5.572e+02    2.500e-01
User objective function returned Inf; trying a new point...
   15     326    7.761422e+03    0.000e+00    7.488e+02    2.500e-01
User objective function returned Inf; trying a new point...
   16     344    7.755652e+03    0.000e+00    8.215e+02    2.500e-01
User objective function returned Inf; trying a new point...
   17     365    7.725331e+03    0.000e+00    2.318e+02    4.999e-01
User objective function returned Inf; trying a new point...
   18     387    7.723824e+03    0.000e+00    3.132e+02    4.999e-01
User objective function returned Inf; trying a new point...
   19     406    7.719543e+03    0.000e+00    2.891e+02    2.500e-01
User objective function returned Inf; trying a new point...
   20     428    7.711409e+03    0.000e+00    5.453e+02    2.500e-01
User objective function returned Inf; trying a new point...
   21     448    7.711046e+03    0.000e+00    5.617e+02    1.250e-01
User objective function returned Inf; trying a new point...
   22     469    7.705533e+03    0.000e+00    2.377e+02    2.500e-01
User objective function returned Inf; trying a new point...
   23     492    7.702198e+03    0.000e+00    4.910e+01    1.250e-01
   24     517    7.702118e+03    0.000e+00    4.611e+01    5.468e-02
   25     536    7.702098e+03    0.000e+00    6.453e+01    2.734e-02
   26     557    7.702029e+03    0.000e+00    3.513e+01    5.468e-02
   27     575    7.701984e+03    0.000e+00    9.786e+01    5.468e-02
   28     596    7.701524e+03    0.000e+00    3.670e+01    3.940e-02
   29     619    7.701402e+03    0.000e+00    3.306e+01    6.896e-02
   30     638    7.701376e+03    0.000e+00    2.982e+01    3.448e-02

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     659    7.700568e+03    0.000e+00    4.911e+01    6.896e-02
User objective function returned Inf; trying a new point...
   32     682    7.699589e+03    0.000e+00    7.834e+01    1.207e-01
User objective function returned Inf; trying a new point...
   33     702    7.699307e+03    0.000e+00    1.050e+02    6.034e-02
   34     721    7.698817e+03    0.000e+00    7.186e+01    2.327e-01
   35     738    7.696132e+03    0.000e+00    1.739e+02    1.288e-01
   36     755    7.694899e+03    0.000e+00    1.057e+02    8.042e-02
   37     772    7.694314e+03    0.000e+00    9.952e+01    6.788e-02
   38     789    7.694152e+03    0.000e+00    8.047e+01    3.565e-02
   39     806    7.693944e+03    0.000e+00    1.029e+01    3.814e-02
   40     823    7.693937e+03    0.000e+00    1.283e+00    1.014e-02
   41     840    7.693936e+03    0.000e+00    4.804e-02    1.178e-03
   42     857    7.693936e+03    0.000e+00    6.651e-02    2.013e-04
   43     874    7.693936e+03    0.000e+00    9.688e-03    4.851e-05

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',2.531487e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 1.7603 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

   -0.0045
   -0.0038
   -0.0006
   -0.0019
   -0.0013
   -0.0008
   -0.0097
    0.0012
    0.0009
    0.0007
   -0.0002
   -0.0001
    0.0001
    0.0013
         0
   -0.0010

Value of the log-likelihood function at convergence: -7693.9363
 
                      AIC                      BIC
              ------------------   -----------------------
                  15419.8726               15490.2235
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 2.4554e-08
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS          0.8178     0.0592    13.8171
A_SnGo         0.4793     0.0445    10.7820
A_AgeLT40      0.5483     0.0610     8.9928
A_ExpLT8       1.1637     0.0727    16.0087
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1          -1.6829     0.1142   -14.7306
Bc_2          -1.8377     0.1166   -15.7636
LV_Load        0.8234     0.0432    19.0446
Mu_12         -0.3452     0.0481    -7.1823
Mu_13         -0.8210     0.0575   -14.2872
Mu_14         -0.7725     0.0579   -13.3370
Mu_22         -0.7450     0.0583   -12.7886
Mu_23         -0.4502     0.0495    -9.0961
Mu_24         -0.7229     0.0575   -12.5812
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -1.0079     0.0437   -23.0408
C_VRC         -0.8346     0.0630   -13.2465
C_LV          -0.6260     0.0654    -9.5697
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    1.6780    0.6780
    0.6780    1.6780

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

    0.8178    0.4793    0.5483    1.1637   -1.6829   -1.8377    0.8234   -0.3452   -0.8210   -0.7725   -0.7450

  Columns 12 through 16

   -0.4502   -0.7229   -1.0079   -0.8346   -0.6260

The covariance matrix for these parameters is:

ihess =

  Columns 1 through 11

    0.0035    0.0006    0.0005    0.0013   -0.0030   -0.0030   -0.0012   -0.0006   -0.0004   -0.0004   -0.0004
    0.0006    0.0020    0.0004    0.0003   -0.0024   -0.0023   -0.0007   -0.0002   -0.0002   -0.0002   -0.0003
    0.0005    0.0004    0.0037    0.0011   -0.0006   -0.0006   -0.0009   -0.0002   -0.0004   -0.0004   -0.0003
    0.0013    0.0003    0.0011    0.0053    0.0003    0.0004   -0.0018   -0.0007   -0.0006   -0.0006   -0.0004
   -0.0030   -0.0024   -0.0006    0.0003    0.0131    0.0122   -0.0013    0.0000   -0.0004   -0.0007   -0.0007
   -0.0030   -0.0023   -0.0006    0.0004    0.0122    0.0136   -0.0016   -0.0009   -0.0009   -0.0010   -0.0000
   -0.0012   -0.0007   -0.0009   -0.0018   -0.0013   -0.0016    0.0019    0.0008    0.0008    0.0008    0.0007
   -0.0006   -0.0002   -0.0002   -0.0007    0.0000   -0.0009    0.0008    0.0023    0.0000    0.0002    0.0004
   -0.0004   -0.0002   -0.0004   -0.0006   -0.0004   -0.0009    0.0008    0.0000    0.0033   -0.0001    0.0003
   -0.0004   -0.0002   -0.0004   -0.0006   -0.0007   -0.0010    0.0008    0.0002   -0.0001    0.0034    0.0003
   -0.0004   -0.0003   -0.0003   -0.0004   -0.0007   -0.0000    0.0007    0.0004    0.0003    0.0003    0.0034
   -0.0004   -0.0002   -0.0004   -0.0007   -0.0007   -0.0003    0.0008    0.0003    0.0003    0.0003   -0.0001
   -0.0004   -0.0002   -0.0003   -0.0007   -0.0010   -0.0008    0.0008    0.0004    0.0003    0.0003    0.0002
   -0.0000    0.0000   -0.0001   -0.0001    0.0000    0.0001    0.0000   -0.0000    0.0001    0.0001   -0.0002
    0.0000    0.0000   -0.0001   -0.0000   -0.0000    0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0001
    0.0017    0.0011    0.0005    0.0007   -0.0023   -0.0023   -0.0008   -0.0003   -0.0002   -0.0002   -0.0003

  Columns 12 through 16

   -0.0004   -0.0004   -0.0000    0.0000    0.0017
   -0.0002   -0.0002    0.0000    0.0000    0.0011
   -0.0004   -0.0003   -0.0001   -0.0001    0.0005
   -0.0007   -0.0007   -0.0001   -0.0000    0.0007
   -0.0007   -0.0010    0.0000   -0.0000   -0.0023
   -0.0003   -0.0008    0.0001    0.0000   -0.0023
    0.0008    0.0008    0.0000   -0.0000   -0.0008
    0.0003    0.0004   -0.0000   -0.0000   -0.0003
    0.0003    0.0003    0.0001   -0.0000   -0.0002
    0.0003    0.0003    0.0001   -0.0000   -0.0002
   -0.0001    0.0002   -0.0002   -0.0001   -0.0003
    0.0024    0.0000    0.0001    0.0001   -0.0003
    0.0000    0.0033   -0.0000   -0.0000   -0.0003
    0.0001   -0.0000    0.0019    0.0012    0.0006
    0.0001   -0.0000    0.0012    0.0040    0.0007
   -0.0003   -0.0003    0.0006    0.0007    0.0043

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 17 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.191429e+04    0.000e+00    2.095e+03
User objective function returned Inf; trying a new point...
    1      39    1.055363e+04    0.000e+00    5.143e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.615770e+03    0.000e+00    3.225e+02    9.999e-01
User objective function returned Inf; trying a new point...
    3      79    8.541765e+03    0.000e+00    1.982e+03    2.000e+00
User objective function returned Inf; trying a new point...
    4      99    8.452686e+03    0.000e+00    1.869e+03    4.999e-01
User objective function returned Inf; trying a new point...
    5     120    8.145135e+03    0.000e+00    5.017e+02    9.999e-01
User objective function returned Inf; trying a new point...
    6     140    8.091895e+03    0.000e+00    4.594e+02    4.999e-01
User objective function returned Inf; trying a new point...
    7     161    8.049042e+03    0.000e+00    6.498e+02    9.999e-01
User objective function returned Inf; trying a new point...
    8     180    8.025917e+03    0.000e+00    9.023e+02    4.999e-01
User objective function returned Inf; trying a new point...
    9     202    7.938185e+03    0.000e+00    4.276e+02    5.000e-01
User objective function returned Inf; trying a new point...
   10     226    7.899118e+03    0.000e+00    1.341e+02    4.375e-01
User objective function returned Inf; trying a new point...
   11     245    7.880574e+03    0.000e+00    2.318e+02    4.375e-01
User objective function returned Inf; trying a new point...
   12     267    7.874521e+03    0.000e+00    2.256e+02    4.375e-01
User objective function returned Inf; trying a new point...
   13     286    7.873334e+03    0.000e+00    2.149e+02    2.187e-01
User objective function returned Inf; trying a new point...
   14     307    7.841283e+03    0.000e+00    1.783e+02    4.375e-01
User objective function returned Inf; trying a new point...
   15     326    7.831621e+03    0.000e+00    9.374e+01    4.375e-01
User objective function returned Inf; trying a new point...
   16     348    7.800593e+03    0.000e+00    2.382e+02    4.375e-01
User objective function returned Inf; trying a new point...
   17     368    7.769008e+03    0.000e+00    4.014e+02    7.655e-01
User objective function returned Inf; trying a new point...
   18     391    7.753715e+03    0.000e+00    2.141e+02    3.828e-01
User objective function returned Inf; trying a new point...
   19     410    7.745063e+03    0.000e+00    2.655e+02    3.828e-01
User objective function returned Inf; trying a new point...
   20     432    7.726233e+03    0.000e+00    7.035e+01    3.828e-01
User objective function returned Inf; trying a new point...
   21     454    7.719007e+03    0.000e+00    2.047e+02    3.828e-01
User objective function returned Inf; trying a new point...
   22     477    7.713483e+03    0.000e+00    7.737e+01    1.914e-01
User objective function returned Inf; trying a new point...
   23     498    7.712996e+03    0.000e+00    7.816e+01    3.828e-01
User objective function returned Inf; trying a new point...
   24     517    7.711037e+03    0.000e+00    1.297e+02    1.914e-01
   25     539    7.704928e+03    0.000e+00    4.920e+01    1.914e-01
User objective function returned Inf; trying a new point...
   26     562    7.704001e+03    0.000e+00    1.469e+01    9.569e-02
User objective function returned Inf; trying a new point...
   27     582    7.703996e+03    0.000e+00    3.446e+01    4.785e-02
   28     603    7.703531e+03    0.000e+00    2.489e+01    9.569e-02
   29     623    7.703434e+03    0.000e+00    1.881e+01    4.785e-02
   30     643    7.703421e+03    0.000e+00    2.569e+01    2.130e-02

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     664    7.703321e+03    0.000e+00    1.165e+01    4.260e-02
   32     686    7.703305e+03    0.000e+00    1.100e+01    4.260e-02
   33     705    7.703266e+03    0.000e+00    1.577e+01    2.130e-02
   34     727    7.703217e+03    0.000e+00    9.287e+00    2.130e-02
   35     750    7.703204e+03    0.000e+00    1.077e+01    1.065e-02
   36     770    7.703203e+03    0.000e+00    1.040e+01    5.325e-03
   37     787    7.703177e+03    0.000e+00    9.604e+00    1.041e-02
   38     804    7.703119e+03    0.000e+00    6.948e+00    1.572e-02
   39     821    7.703065e+03    0.000e+00    3.391e+00    1.954e-02
   40     838    7.703040e+03    0.000e+00    2.063e+00    2.077e-02
   41     855    7.703035e+03    0.000e+00    6.192e-01    8.141e-03
   42     872    7.703035e+03    0.000e+00    1.736e-01    2.628e-03
   43     889    7.703035e+03    0.000e+00    7.674e-03    3.830e-04
   44     906    7.703035e+03    0.000e+00    2.478e-03    3.828e-05

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',1.916171e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 1.8903 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

    0.0025
    0.0027
    0.0008
    0.0007
    0.0006
    0.0005
    0.0031
   -0.0007
   -0.0008
   -0.0004
   -0.0001
   -0.0003
   -0.0002
    0.0001
    0.0001
   -0.0004

Value of the log-likelihood function at convergence: -7703.0349
 
                      AIC                      BIC
              ------------------   -----------------------
                  15438.0698               15508.4207
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 4.5296e-09
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS          0.6385     0.0502    12.7100
A_SnGo         0.2155     0.0359     6.0018
A_AgeLT40      0.2463     0.0539     4.5706
A_ExpLT8       1.3889     0.0663    20.9381
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1          -1.3027     0.1174   -11.0933
Bc_2          -1.4588     0.1186   -12.2973
LV_Load        0.9633     0.0472    20.4234
Mu_12         -0.4038     0.0519    -7.7747
Mu_13         -0.4826     0.0529    -9.1281
Mu_14         -0.7686     0.0606   -12.6792
Mu_22         -0.3511     0.0510    -6.8837
Mu_23         -0.4524     0.0519    -8.7160
Mu_24         -0.6413     0.0614   -10.4525
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -0.8956     0.0364   -24.6225
C_VRC         -0.7077     0.0610   -11.6108
C_LV          -0.6020     0.0902    -6.6764
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    1.9280    0.9280
    0.9280    1.9280

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

    0.6385    0.2155    0.2463    1.3889   -1.3027   -1.4588    0.9633   -0.4038   -0.4826   -0.7686   -0.3511

  Columns 12 through 16

   -0.4524   -0.6413   -0.8956   -0.7077   -0.6020

The covariance matrix for these parameters is:

ihess =

  Columns 1 through 11

    0.0025    0.0001    0.0000    0.0007   -0.0031   -0.0032   -0.0008   -0.0002   -0.0001   -0.0002   -0.0003
    0.0001    0.0013    0.0001    0.0003   -0.0022   -0.0021   -0.0003   -0.0001   -0.0001   -0.0001   -0.0000
    0.0000    0.0001    0.0029    0.0003   -0.0012   -0.0011   -0.0002   -0.0001   -0.0002   -0.0001   -0.0000
    0.0007    0.0003    0.0003    0.0044   -0.0001    0.0000   -0.0019   -0.0006   -0.0005   -0.0006   -0.0006
   -0.0031   -0.0022   -0.0012   -0.0001    0.0138    0.0125   -0.0013    0.0001   -0.0005   -0.0007   -0.0009
   -0.0032   -0.0021   -0.0011    0.0000    0.0125    0.0141   -0.0014   -0.0008   -0.0011   -0.0010    0.0000
   -0.0008   -0.0003   -0.0002   -0.0019   -0.0013   -0.0014    0.0022    0.0009    0.0009    0.0009    0.0009
   -0.0002   -0.0001   -0.0001   -0.0006    0.0001   -0.0008    0.0009    0.0027    0.0001    0.0001    0.0004
   -0.0001   -0.0001   -0.0002   -0.0005   -0.0005   -0.0011    0.0009    0.0001    0.0028    0.0000    0.0003
   -0.0002   -0.0001   -0.0001   -0.0006   -0.0007   -0.0010    0.0009    0.0001    0.0000    0.0037    0.0003
   -0.0003   -0.0000   -0.0000   -0.0006   -0.0009    0.0000    0.0009    0.0004    0.0003    0.0003    0.0026
   -0.0003   -0.0001   -0.0001   -0.0005   -0.0007   -0.0003    0.0009    0.0004    0.0004    0.0003    0.0001
   -0.0003   -0.0002   -0.0001   -0.0006   -0.0006   -0.0004    0.0009    0.0004    0.0004    0.0003    0.0001
   -0.0000   -0.0000    0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000   -0.0000    0.0000   -0.0000
   -0.0000   -0.0001   -0.0000   -0.0001    0.0003    0.0003    0.0000    0.0000    0.0001    0.0000   -0.0001
    0.0022    0.0009    0.0003    0.0008   -0.0040   -0.0039   -0.0009   -0.0004   -0.0003   -0.0002   -0.0003

  Columns 12 through 16

   -0.0003   -0.0003   -0.0000   -0.0000    0.0022
   -0.0001   -0.0002   -0.0000   -0.0001    0.0009
   -0.0001   -0.0001    0.0000   -0.0000    0.0003
   -0.0005   -0.0006   -0.0000   -0.0001    0.0008
   -0.0007   -0.0006   -0.0000    0.0003   -0.0040
   -0.0003   -0.0004    0.0000    0.0003   -0.0039
    0.0009    0.0009    0.0000    0.0000   -0.0009
    0.0004    0.0004    0.0000    0.0000   -0.0004
    0.0004    0.0004   -0.0000    0.0001   -0.0003
    0.0003    0.0003    0.0000    0.0000   -0.0002
    0.0001    0.0001   -0.0000   -0.0001   -0.0003
    0.0027    0.0001    0.0000    0.0000   -0.0004
    0.0001    0.0038    0.0000    0.0002   -0.0004
    0.0000    0.0000    0.0013    0.0008    0.0004
    0.0000    0.0002    0.0008    0.0037    0.0005
   -0.0004   -0.0004    0.0004    0.0005    0.0081

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 18 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.263695e+04    0.000e+00    2.534e+03
User objective function returned Inf; trying a new point...
    1      39    1.033284e+04    0.000e+00    4.729e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.696993e+03    0.000e+00    6.716e+02    9.999e-01
User objective function returned Inf; trying a new point...
    3      81    8.600475e+03    0.000e+00    1.355e+03    4.999e-01
User objective function returned Inf; trying a new point...
    4      99    8.476753e+03    0.000e+00    1.476e+03    5.000e-01
User objective function returned Inf; trying a new point...
    5     120    8.418388e+03    0.000e+00    3.827e+02    9.999e-01
User objective function returned Inf; trying a new point...
    6     142    8.324017e+03    0.000e+00    4.201e+02    4.999e-01
User objective function returned Inf; trying a new point...
    7     161    8.298746e+03    0.000e+00    9.107e+02    4.999e-01
User objective function returned Inf; trying a new point...
    8     183    8.269035e+03    0.000e+00    2.964e+02    4.999e-01
User objective function returned Inf; trying a new point...
    9     202    8.259841e+03    0.000e+00    3.004e+02    2.500e-01
User objective function returned Inf; trying a new point...
   10     223    8.195692e+03    0.000e+00    2.872e+02    5.000e-01
User objective function returned Inf; trying a new point...
   11     247    8.173167e+03    0.000e+00    3.409e+02    4.375e-01
User objective function returned Inf; trying a new point...
   12     267    8.163742e+03    0.000e+00    2.514e+02    2.187e-01
User objective function returned Inf; trying a new point...
   13     288    8.124965e+03    0.000e+00    1.197e+02    4.375e-01
User objective function returned Inf; trying a new point...
   14     307    8.118648e+03    0.000e+00    1.166e+02    4.375e-01
User objective function returned Inf; trying a new point...
   15     329    8.114366e+03    0.000e+00    1.332e+02    4.375e-01
User objective function returned Inf; trying a new point...
   16     349    8.113459e+03    0.000e+00    1.495e+02    1.094e-01
User objective function returned Inf; trying a new point...
   17     370    8.108509e+03    0.000e+00    9.638e+01    2.187e-01
User objective function returned Inf; trying a new point...
   18     389    8.108021e+03    0.000e+00    6.564e+01    2.187e-01
User objective function returned Inf; trying a new point...
   19     411    8.105908e+03    0.000e+00    6.433e+01    2.187e-01
User objective function returned Inf; trying a new point...
   20     429    8.104060e+03    0.000e+00    1.016e+02    4.375e-01
User objective function returned Inf; trying a new point...
   21     453    8.100286e+03    0.000e+00    7.026e+01    1.094e-01
User objective function returned Inf; trying a new point...
   22     471    8.097136e+03    0.000e+00    8.316e+01    2.187e-01
User objective function returned Inf; trying a new point...
   23     492    8.095606e+03    0.000e+00    1.447e+02    4.375e-01
User objective function returned Inf; trying a new point...
   24     510    8.095423e+03    0.000e+00    2.609e+02    4.375e-01
User objective function returned Inf; trying a new point...
   25     533    8.087024e+03    0.000e+00    8.432e+01    2.187e-01
User objective function returned Inf; trying a new point...
   26     553    8.086923e+03    0.000e+00    8.338e+01    1.094e-01
   27     575    8.084354e+03    0.000e+00    5.043e+01    1.094e-01
   28     593    8.082902e+03    0.000e+00    6.433e+01    2.187e-01
User objective function returned Inf; trying a new point...
   29     616    8.081322e+03    0.000e+00    5.938e+01    1.094e-01
User objective function returned Inf; trying a new point...
   30     634    8.080778e+03    0.000e+00    7.807e+01    2.187e-01

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     651    8.073507e+03    0.000e+00    1.028e+02    1.099e+00
User objective function returned Inf; trying a new point...
   32     676    8.072511e+03    0.000e+00    9.074e+01    1.374e-01
   33     696    8.072375e+03    0.000e+00    7.295e+01    6.868e-02
   34     714    8.064532e+03    0.000e+00    2.321e+02    2.372e+00
   35     731    8.060615e+03    0.000e+00    3.603e+02    1.367e+00
   36     749    8.059107e+03    0.000e+00    3.031e+02    1.148e+00
   37     766    8.058033e+03    0.000e+00    6.500e+02    2.236e+00
   38     783    8.055079e+03    0.000e+00    2.264e+02    7.823e-01
   39     800    8.053207e+03    0.000e+00    1.001e+02    1.204e+00
   40     817    8.051878e+03    0.000e+00    3.450e+02    2.604e+00
   41     834    8.050304e+03    0.000e+00    1.460e+02    9.474e-01
   42     851    8.047998e+03    0.000e+00    1.011e+02    4.309e+00
   43     868    8.046749e+03    0.000e+00    4.226e+02    5.159e+00
   44     885    8.045396e+03    0.000e+00    2.408e+02    5.022e+00
   45     902    8.044550e+03    0.000e+00    7.162e+02    7.366e+00
   46     919    8.044115e+03    0.000e+00    2.270e+02    5.902e-01
   47     939    8.044021e+03    0.000e+00    2.894e+02    8.333e-01
   48     956    8.043470e+03    0.000e+00    3.344e+02    5.029e+00
   49     973    8.043095e+03    0.000e+00    4.269e+02    5.651e+00
   50     990    8.042715e+03    0.000e+00    1.557e+02    4.386e+00
   51    1008    8.042315e+03    0.000e+00    4.473e+02    8.166e+00
   52    1025    8.042046e+03    0.000e+00    5.358e+02    7.143e+00
   53    1042    8.041921e+03    0.000e+00    4.844e+02    4.276e+00
   54    1059    8.041612e+03    0.000e+00    5.465e+02    8.771e+00
   55    1077    8.041524e+03    0.000e+00    4.599e+02    1.848e+00
   56    1094    8.041404e+03    0.000e+00    1.876e+02    3.446e+00
   57    1111    8.041240e+03    0.000e+00    3.536e+02    8.442e+00
   58    1128    8.041279e+03    0.000e+00    2.964e+02    2.077e+00
   59    1145    8.041249e+03    0.000e+00    1.838e+01    3.463e-01
   60    1162    8.041245e+03    0.000e+00    4.420e+00    2.335e-01

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   61    1179    8.041245e+03    0.000e+00    4.781e-01    4.253e-03

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',5.036678e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 2.417 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

    0.4781
   -0.2347
   -0.0058
   -0.0082
   -0.0069
   -0.0109
   -0.0057
    0.0048
    0.0044
    0.0035
    0.0063
    0.0040
    0.0020
   -0.0009
    0.0004
   -0.0196

Value of the log-likelihood function at convergence: -8041.2448
 
                      AIC                      BIC
              ------------------   -----------------------
                  16114.4896               16184.8405
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 0.49229
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS         -0.0064     0.0025    -2.5623
A_SnGo        -0.0017     0.0008    -2.0890
A_AgeLT40      0.2469     0.0523     4.7209
A_ExpLT8       0.9072     0.0576    15.7435
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1           0.4154     0.0435     9.5534
Bc_2           0.5894     0.0483    12.2031
LV_Load        0.8531     0.0365    23.3738
Mu_12         -0.7928     0.0579   -13.6891
Mu_13         -0.7019     0.0525   -13.3804
Mu_14         -0.7638     0.0543   -14.0677
Mu_22         -0.2599     0.0441    -5.8887
Mu_23         -0.5759     0.0498   -11.5693
Mu_24         -0.9239     0.0588   -15.7189
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -0.8165     0.0359   -22.7218
C_VRC         -0.8325     0.0598   -13.9250
C_LV          95.0214    35.8114     2.6534
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    1.7278    0.7278
    0.7278    1.7278

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

   -0.0064   -0.0017    0.2469    0.9072    0.4154    0.5894    0.8531   -0.7928   -0.7019   -0.7638   -0.2599

  Columns 12 through 16

   -0.5759   -0.9239   -0.8165   -0.8325   95.0214

The covariance matrix for these parameters is:

ihess =

   1.0e+03 *

  Columns 1 through 11

    0.0000    0.0000   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
   -0.0000   -0.0000    0.0000   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000   -0.0000
   -0.0000   -0.0000   -0.0000    0.0000   -0.0000   -0.0000   -0.0000    0.0000   -0.0000   -0.0000   -0.0000
   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000   -0.0000   -0.0000    0.0000
    0.0000    0.0000    0.0000   -0.0000    0.0000    0.0000    0.0000   -0.0000    0.0000   -0.0000    0.0000
    0.0000    0.0000    0.0000   -0.0000    0.0000    0.0000    0.0000   -0.0000   -0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000   -0.0000
    0.0000    0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000   -0.0000
    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000   -0.0000   -0.0000   -0.0000    0.0000   -0.0000
    0.0000    0.0000    0.0000    0.0000   -0.0000    0.0000    0.0000    0.0000   -0.0000    0.0000    0.0000
    0.0001    0.0000   -0.0001   -0.0002   -0.0001   -0.0001    0.0003    0.0003    0.0001    0.0001    0.0002

  Columns 12 through 16

    0.0000    0.0000    0.0000    0.0000    0.0001
    0.0000    0.0000    0.0000    0.0000    0.0000
   -0.0000   -0.0000    0.0000    0.0000   -0.0001
   -0.0000   -0.0000    0.0000    0.0000   -0.0002
    0.0000    0.0000    0.0000   -0.0000   -0.0001
    0.0000    0.0000    0.0000    0.0000   -0.0001
    0.0000    0.0000   -0.0000    0.0000    0.0003
    0.0000    0.0000   -0.0000    0.0000    0.0003
    0.0000    0.0000   -0.0000   -0.0000    0.0001
    0.0000    0.0000    0.0000    0.0000    0.0001
   -0.0000   -0.0000   -0.0000    0.0000    0.0002
    0.0000   -0.0000    0.0000    0.0000    0.0001
   -0.0000    0.0000   -0.0000    0.0000    0.0002
    0.0000   -0.0000    0.0000    0.0000   -0.0000
    0.0000    0.0000    0.0000    0.0000   -0.0001
    0.0001    0.0002   -0.0000   -0.0001    1.2825

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 19 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.259765e+04    0.000e+00    2.464e+03
User objective function returned Inf; trying a new point...
    1      39    1.028831e+04    0.000e+00    4.841e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.609218e+03    0.000e+00    5.599e+02    9.999e-01
User objective function returned Inf; trying a new point...
    3      80    8.585579e+03    0.000e+00    1.506e+03    9.999e-01
User objective function returned Inf; trying a new point...
    4      98    8.364624e+03    0.000e+00    1.959e+03    9.999e-01
User objective function returned Inf; trying a new point...
    5     121    8.164612e+03    0.000e+00    6.154e+02    4.999e-01
User objective function returned Inf; trying a new point...
    6     141    8.126633e+03    0.000e+00    4.540e+02    2.500e-01
User objective function returned Inf; trying a new point...
    7     162    8.043667e+03    0.000e+00    3.523e+02    4.999e-01
User objective function returned Inf; trying a new point...
    8     181    8.041547e+03    0.000e+00    4.112e+02    4.999e-01
User objective function returned Inf; trying a new point...
    9     202    8.013692e+03    0.000e+00    4.086e+02    9.999e-01
User objective function returned Inf; trying a new point...
   10     221    7.981667e+03    0.000e+00    4.012e+02    5.000e-01
User objective function returned Inf; trying a new point...
   11     242    7.978108e+03    0.000e+00    2.820e+02    9.999e-01
User objective function returned Inf; trying a new point...
   12     261    7.956417e+03    0.000e+00    3.141e+02    5.000e-01
User objective function returned Inf; trying a new point...
   13     283    7.915936e+03    0.000e+00    4.550e+02    4.999e-01
User objective function returned Inf; trying a new point...
   14     303    7.907547e+03    0.000e+00    2.294e+02    2.500e-01
User objective function returned Inf; trying a new point...
   15     324    7.907032e+03    0.000e+00    2.058e+02    4.999e-01
User objective function returned Inf; trying a new point...
   16     343    7.898054e+03    0.000e+00    2.146e+02    2.500e-01
User objective function returned Inf; trying a new point...
   17     364    7.876403e+03    0.000e+00    1.884e+02    4.999e-01
User objective function returned Inf; trying a new point...
   18     384    7.875109e+03    0.000e+00    2.060e+02    2.500e-01
User objective function returned Inf; trying a new point...
   19     405    7.871769e+03    0.000e+00    2.080e+02    4.999e-01
User objective function returned Inf; trying a new point...
   20     424    7.869624e+03    0.000e+00    2.438e+02    2.500e-01
User objective function returned Inf; trying a new point...
   21     446    7.856046e+03    0.000e+00    5.897e+01    2.500e-01
User objective function returned Inf; trying a new point...
   22     470    7.855279e+03    0.000e+00    5.303e+01    2.187e-01
User objective function returned Inf; trying a new point...
   23     489    7.854753e+03    0.000e+00    9.005e+01    1.094e-01
User objective function returned Inf; trying a new point...
   24     510    7.852555e+03    0.000e+00    5.691e+01    2.187e-01
User objective function returned Inf; trying a new point...
   25     530    7.851836e+03    0.000e+00    4.416e+01    1.094e-01
   26     551    7.851520e+03    0.000e+00    5.840e+01    2.187e-01
User objective function returned Inf; trying a new point...
   27     569    7.851050e+03    0.000e+00    8.598e+01    2.187e-01
   28     591    7.848464e+03    0.000e+00    3.048e+01    2.187e-01
   29     614    7.847141e+03    0.000e+00    1.267e+01    1.094e-01
   30     637    7.846897e+03    0.000e+00    2.054e+01    5.468e-02

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     659    7.846767e+03    0.000e+00    2.674e+01    5.468e-02
   32     682    7.846606e+03    0.000e+00    4.093e+00    2.734e-02
   33     701    7.846577e+03    0.000e+00    1.043e+01    2.734e-02
   34     723    7.846542e+03    0.000e+00    2.806e+00    2.734e-02
   35     746    7.846516e+03    0.000e+00    1.869e+00    1.367e-02
   36     768    7.846514e+03    0.000e+00    2.572e+00    1.367e-02
   37     786    7.846508e+03    0.000e+00    2.765e+00    1.367e-02
   38     803    7.846492e+03    0.000e+00    2.703e+00    1.776e-02
   39     820    7.846491e+03    0.000e+00    5.668e-01    2.998e-03
   40     837    7.846491e+03    0.000e+00    1.170e-01    1.071e-03
   41     854    7.846491e+03    0.000e+00    3.447e-02    3.487e-04
   42     871    7.846491e+03    0.000e+00    1.221e-03    5.592e-05

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',3.265740e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 1.7942 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

    0.0009
    0.0012
    0.0002
    0.0004
   -0.0001
   -0.0004
    0.0010
   -0.0001
   -0.0005
    0.0001
    0.0006
    0.0005
   -0.0002
   -0.0002
   -0.0001
   -0.0001

Value of the log-likelihood function at convergence: -7846.4906
 
                      AIC                      BIC
              ------------------   -----------------------
                  15724.9813               15795.3321
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 1.6555e-08
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS          0.5630     0.0473    11.9140
A_SnGo         0.0473     0.0324     1.4614
A_AgeLT40      0.7670     0.0542    14.1565
A_ExpLT8       0.7861     0.0544    14.4450
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1          -0.6426     0.1145    -5.6141
Bc_2          -0.7315     0.1152    -6.3484
LV_Load        1.0258     0.0487    21.0696
Mu_12         -0.3092     0.0493    -6.2694
Mu_13         -0.5341     0.0533   -10.0160
Mu_14         -0.8810     0.0631   -13.9617
Mu_22         -0.1041     0.0416    -2.5051
Mu_23         -0.5710     0.0543   -10.5191
Mu_24         -0.7468     0.0607   -12.3054
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -0.8649     0.0343   -25.2280
C_VRC         -0.6033     0.0580   -10.4003
C_LV          -0.6152     0.1106    -5.5623
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    2.0523    1.0523
    1.0523    2.0523

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

    0.5630    0.0473    0.7670    0.7861   -0.6426   -0.7315    1.0258   -0.3092   -0.5341   -0.8810   -0.1041

  Columns 12 through 16

   -0.5710   -0.7468   -0.8649   -0.6033   -0.6152

The covariance matrix for these parameters is:

ihess =

  Columns 1 through 11

    0.0022   -0.0001    0.0002    0.0003   -0.0031   -0.0032   -0.0006   -0.0001   -0.0002   -0.0003   -0.0002
   -0.0001    0.0010    0.0001   -0.0000   -0.0019   -0.0019   -0.0001   -0.0000    0.0000   -0.0000   -0.0000
    0.0002    0.0001    0.0029    0.0005   -0.0011   -0.0009   -0.0009   -0.0003   -0.0003   -0.0003   -0.0002
    0.0003   -0.0000    0.0005    0.0030   -0.0009   -0.0008   -0.0010   -0.0003   -0.0002   -0.0003   -0.0002
   -0.0031   -0.0019   -0.0011   -0.0009    0.0131    0.0118   -0.0010    0.0004   -0.0002   -0.0002   -0.0004
   -0.0032   -0.0019   -0.0009   -0.0008    0.0118    0.0133   -0.0011   -0.0006   -0.0006   -0.0004    0.0003
   -0.0006   -0.0001   -0.0009   -0.0010   -0.0010   -0.0011    0.0024    0.0009    0.0009    0.0010    0.0009
   -0.0001   -0.0000   -0.0003   -0.0003    0.0004   -0.0006    0.0009    0.0024    0.0000    0.0002    0.0004
   -0.0002    0.0000   -0.0003   -0.0002   -0.0002   -0.0006    0.0009    0.0000    0.0028    0.0001    0.0004
   -0.0003   -0.0000   -0.0003   -0.0003   -0.0002   -0.0004    0.0010    0.0002    0.0001    0.0040    0.0005
   -0.0002   -0.0000   -0.0002   -0.0002   -0.0004    0.0003    0.0009    0.0004    0.0004    0.0005    0.0017
   -0.0002   -0.0001   -0.0003   -0.0003   -0.0006   -0.0001    0.0010    0.0004    0.0004    0.0004    0.0002
   -0.0001   -0.0001   -0.0004   -0.0003   -0.0007   -0.0004    0.0011    0.0005    0.0005    0.0004    0.0004
    0.0001   -0.0000    0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000
    0.0001   -0.0001   -0.0000   -0.0001    0.0001    0.0001    0.0000   -0.0000    0.0000    0.0000    0.0001
    0.0024    0.0002    0.0002    0.0002   -0.0041   -0.0041   -0.0006   -0.0001   -0.0001   -0.0002   -0.0001

  Columns 12 through 16

   -0.0002   -0.0001    0.0001    0.0001    0.0024
   -0.0001   -0.0001   -0.0000   -0.0001    0.0002
   -0.0003   -0.0004    0.0000   -0.0000    0.0002
   -0.0003   -0.0003   -0.0000   -0.0001    0.0002
   -0.0006   -0.0007   -0.0000    0.0001   -0.0041
   -0.0001   -0.0004   -0.0000    0.0001   -0.0041
    0.0010    0.0011   -0.0000    0.0000   -0.0006
    0.0004    0.0005   -0.0000   -0.0000   -0.0001
    0.0004    0.0005    0.0000    0.0000   -0.0001
    0.0004    0.0004    0.0000    0.0000   -0.0002
    0.0002    0.0004    0.0000    0.0001   -0.0001
    0.0029    0.0001    0.0000    0.0000   -0.0003
    0.0001    0.0037   -0.0000   -0.0001   -0.0002
    0.0000   -0.0000    0.0012    0.0006    0.0003
    0.0000   -0.0001    0.0006    0.0034    0.0008
   -0.0003   -0.0002    0.0003    0.0008    0.0122

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 20 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.267094e+04    0.000e+00    2.577e+03
User objective function returned Inf; trying a new point...
    1      39    1.015977e+04    0.000e+00    4.781e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.531053e+03    0.000e+00    7.292e+02    9.999e-01
User objective function returned Inf; trying a new point...
    3      81    8.414366e+03    0.000e+00    1.339e+03    4.999e-01
User objective function returned Inf; trying a new point...
    4      99    8.305460e+03    0.000e+00    1.627e+03    9.999e-01
User objective function returned Inf; trying a new point...
    5     121    8.284776e+03    0.000e+00    4.923e+02    9.999e-01
User objective function returned Inf; trying a new point...
    6     140    8.243526e+03    0.000e+00    2.086e+02    4.999e-01
User objective function returned Inf; trying a new point...
    7     161    8.208528e+03    0.000e+00    3.758e+02    9.999e-01
User objective function returned Inf; trying a new point...
    8     179    8.188223e+03    0.000e+00    9.504e+02    9.999e-01
User objective function returned Inf; trying a new point...
    9     201    8.185711e+03    0.000e+00    4.159e+02    9.999e-01
User objective function returned Inf; trying a new point...
   10     220    8.169045e+03    0.000e+00    4.819e+02    4.999e-01
User objective function returned Inf; trying a new point...
   11     241    8.048034e+03    0.000e+00    2.119e+02    9.999e-01
User objective function returned Inf; trying a new point...
   12     264    8.007175e+03    0.000e+00    4.280e+02    4.999e-01
User objective function returned Inf; trying a new point...
   13     284    8.002675e+03    0.000e+00    3.697e+02    2.500e-01
User objective function returned Inf; trying a new point...
   14     305    7.973953e+03    0.000e+00    1.919e+02    4.999e-01
User objective function returned Inf; trying a new point...
   15     325    7.969335e+03    0.000e+00    1.236e+02    8.749e-01
User objective function returned Inf; trying a new point...
   16     347    7.960332e+03    0.000e+00    1.678e+02    8.749e-01
User objective function returned Inf; trying a new point...
   17     366    7.957373e+03    0.000e+00    1.409e+02    4.375e-01
User objective function returned Inf; trying a new point...
   18     387    7.942030e+03    0.000e+00    4.702e+02    8.749e-01
User objective function returned Inf; trying a new point...
   19     405    7.921373e+03    0.000e+00    2.416e+02    8.749e-01
User objective function returned Inf; trying a new point...
   20     427    7.853769e+03    0.000e+00    1.198e+02    8.749e-01
User objective function returned Inf; trying a new point...
   21     446    7.825936e+03    0.000e+00    1.898e+02    8.749e-01
User objective function returned Inf; trying a new point...
   22     468    7.821792e+03    0.000e+00    7.491e+02    8.749e-01
User objective function returned Inf; trying a new point...
   23     487    7.820746e+03    0.000e+00    4.687e+02    4.375e-01
User objective function returned Inf; trying a new point...
   24     508    7.790263e+03    0.000e+00    3.506e+02    8.749e-01
User objective function returned Inf; trying a new point...
   25     528    7.785745e+03    0.000e+00    2.358e+02    4.375e-01
User objective function returned Inf; trying a new point...
   26     549    7.782440e+03    0.000e+00    1.083e+02    8.749e-01
User objective function returned Inf; trying a new point...
   27     569    7.777636e+03    0.000e+00    9.301e+01    2.187e-01
User objective function returned Inf; trying a new point...
   28     590    7.750686e+03    0.000e+00    2.997e+02    4.375e-01
   29     612    7.745406e+03    0.000e+00    2.884e+02    4.375e-01
   30     634    7.737844e+03    0.000e+00    3.092e+01    2.187e-01
User objective function returned Inf; trying a new point...

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     654    7.737244e+03    0.000e+00    7.655e+01    1.094e-01
User objective function returned Inf; trying a new point...
   32     676    7.735921e+03    0.000e+00    2.845e+01    1.094e-01
   33     699    7.735582e+03    0.000e+00    2.183e+01    5.468e-02
   34     719    7.735566e+03    0.000e+00    2.239e+01    2.734e-02
   35     736    7.735087e+03    0.000e+00    1.268e+01    1.360e-01
   36     753    7.735030e+03    0.000e+00    4.098e+00    3.234e-02
   37     770    7.735022e+03    0.000e+00    4.684e+00    9.062e-03
   38     787    7.735020e+03    0.000e+00    4.730e+00    3.331e-03
   39     804    7.735017e+03    0.000e+00    4.231e+00    1.722e-03
   40     821    7.735004e+03    0.000e+00    2.197e+00    7.845e-03
   41     838    7.734996e+03    0.000e+00    8.855e-01    7.073e-03
   42     855    7.734992e+03    0.000e+00    4.115e-01    5.733e-03
   43     872    7.734991e+03    0.000e+00    1.618e-01    1.642e-03
   44     889    7.734991e+03    0.000e+00    1.930e-02    3.803e-04
   45     906    7.734991e+03    0.000e+00    6.706e-04    5.767e-05

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',3.077344e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 1.8633 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

   1.0e-03 *

    0.1221
   -0.6714
    0.0610
    0.3662
   -0.3564
   -0.1232
   -0.3609
    0.2441
    0.1831
    0.1831
   -0.0610
   -0.2441
   -0.1831
    0.1171
    0.0556
    0.4272

Value of the log-likelihood function at convergence: -7734.9914
 
                      AIC                      BIC
              ------------------   -----------------------
                  15501.9828               15572.3337
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 7.3535e-09
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS          0.7512     0.0545    13.7743
A_SnGo         0.2076     0.0327     6.3536
A_AgeLT40      0.4776     0.0519     9.2052
A_ExpLT8       0.8191     0.0543    15.0921
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1          -1.1988     0.1227    -9.7686
Bc_2          -1.4858     0.1227   -12.1057
LV_Load        1.0147     0.0481    21.1048
Mu_12         -0.4516     0.0544    -8.3064
Mu_13         -0.5122     0.0538    -9.5273
Mu_14         -0.6476     0.0558   -11.6021
Mu_22         -0.4837     0.0529    -9.1485
Mu_23         -0.5815     0.0534   -10.8807
Mu_24         -0.5650     0.0535   -10.5649
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -1.0425     0.0426   -24.4777
C_VRC         -1.0984     0.0666   -16.4887
C_LV          -0.5964     0.0857    -6.9574
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    2.0297    1.0297
    1.0297    2.0297

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

    0.7512    0.2076    0.4776    0.8191   -1.1988   -1.4858    1.0147   -0.4516   -0.5122   -0.6476   -0.4837

  Columns 12 through 16

   -0.5815   -0.5650   -1.0425   -1.0984   -0.5964

The covariance matrix for these parameters is:

ihess =

  Columns 1 through 11

    0.0030    0.0003    0.0005    0.0007   -0.0038   -0.0037   -0.0014   -0.0006   -0.0004   -0.0005   -0.0004
    0.0003    0.0011    0.0002    0.0002   -0.0024   -0.0023   -0.0003    0.0000   -0.0002   -0.0001   -0.0000
    0.0005    0.0002    0.0027    0.0004   -0.0015   -0.0013   -0.0007   -0.0003   -0.0002   -0.0002   -0.0001
    0.0007    0.0002    0.0004    0.0029   -0.0011   -0.0011   -0.0011   -0.0003   -0.0004   -0.0003   -0.0004
   -0.0038   -0.0024   -0.0015   -0.0011    0.0151    0.0137   -0.0004    0.0005    0.0001   -0.0000   -0.0006
   -0.0037   -0.0023   -0.0013   -0.0011    0.0137    0.0151   -0.0006   -0.0005   -0.0004   -0.0004    0.0003
   -0.0014   -0.0003   -0.0007   -0.0011   -0.0004   -0.0006    0.0023    0.0009    0.0009    0.0009    0.0009
   -0.0006    0.0000   -0.0003   -0.0003    0.0005   -0.0005    0.0009    0.0030   -0.0001    0.0001    0.0003
   -0.0004   -0.0002   -0.0002   -0.0004    0.0001   -0.0004    0.0009   -0.0001    0.0029    0.0001    0.0004
   -0.0005   -0.0001   -0.0002   -0.0003   -0.0000   -0.0004    0.0009    0.0001    0.0001    0.0031    0.0004
   -0.0004   -0.0000   -0.0001   -0.0004   -0.0006    0.0003    0.0009    0.0003    0.0004    0.0004    0.0028
   -0.0004   -0.0002   -0.0002   -0.0004   -0.0004   -0.0000    0.0010    0.0004    0.0005    0.0005    0.0002
   -0.0005   -0.0001   -0.0003   -0.0004   -0.0005   -0.0002    0.0010    0.0003    0.0004    0.0003    0.0002
    0.0000    0.0000   -0.0001    0.0001   -0.0000   -0.0000   -0.0001    0.0000   -0.0001   -0.0001    0.0000
    0.0000    0.0000   -0.0002    0.0001    0.0000   -0.0000   -0.0001    0.0000   -0.0001   -0.0002   -0.0000
    0.0020    0.0008    0.0004    0.0005   -0.0036   -0.0034   -0.0011   -0.0005   -0.0005   -0.0005   -0.0002

  Columns 12 through 16

   -0.0004   -0.0005    0.0000    0.0000    0.0020
   -0.0002   -0.0001    0.0000    0.0000    0.0008
   -0.0002   -0.0003   -0.0001   -0.0002    0.0004
   -0.0004   -0.0004    0.0001    0.0001    0.0005
   -0.0004   -0.0005   -0.0000    0.0000   -0.0036
   -0.0000   -0.0002   -0.0000   -0.0000   -0.0034
    0.0010    0.0010   -0.0001   -0.0001   -0.0011
    0.0004    0.0003    0.0000    0.0000   -0.0005
    0.0005    0.0004   -0.0001   -0.0001   -0.0005
    0.0005    0.0003   -0.0001   -0.0002   -0.0005
    0.0002    0.0002    0.0000   -0.0000   -0.0002
    0.0029    0.0001   -0.0001   -0.0001   -0.0003
    0.0001    0.0029   -0.0002   -0.0002   -0.0005
   -0.0001   -0.0002    0.0018    0.0014    0.0007
   -0.0001   -0.0002    0.0014    0.0044    0.0008
   -0.0003   -0.0005    0.0007    0.0008    0.0073

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 21 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.182408e+04    0.000e+00    2.034e+03
User objective function returned Inf; trying a new point...
    1      39    1.039416e+04    0.000e+00    5.068e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.478092e+03    0.000e+00    2.963e+02    9.999e-01
User objective function returned Inf; trying a new point...
    3      80    8.355100e+03    0.000e+00    1.658e+03    9.999e-01
User objective function returned Inf; trying a new point...
    4      99    8.241094e+03    0.000e+00    1.669e+03    9.999e-01
User objective function returned Inf; trying a new point...
    5     121    8.212307e+03    0.000e+00    5.288e+02    9.999e-01
User objective function returned Inf; trying a new point...
    6     141    8.195754e+03    0.000e+00    8.901e+02    2.500e-01
User objective function returned Inf; trying a new point...
    7     162    8.116694e+03    0.000e+00    2.738e+02    4.999e-01
User objective function returned Inf; trying a new point...
    8     181    8.107754e+03    0.000e+00    3.813e+02    5.000e-01
User objective function returned Inf; trying a new point...
    9     203    8.058207e+03    0.000e+00    3.034e+02    4.999e-01
User objective function returned Inf; trying a new point...
   10     222    8.048185e+03    0.000e+00    4.045e+02    5.000e-01
User objective function returned Inf; trying a new point...
   11     244    8.045134e+03    0.000e+00    3.420e+02    5.000e-01
User objective function returned Inf; trying a new point...
   12     262    8.035803e+03    0.000e+00    1.682e+02    5.000e-01
User objective function returned Inf; trying a new point...
   13     284    7.983343e+03    0.000e+00    1.968e+02    4.999e-01
User objective function returned Inf; trying a new point...
   14     308    7.963954e+03    0.000e+00    1.844e+02    4.375e-01
User objective function returned Inf; trying a new point...
   15     327    7.928018e+03    0.000e+00    1.737e+02    1.531e+00
User objective function returned Inf; trying a new point...
   16     351    7.924344e+03    0.000e+00    4.776e+02    3.828e-01
User objective function returned Inf; trying a new point...
   17     369    7.905634e+03    0.000e+00    4.231e+02    3.828e-01
User objective function returned Inf; trying a new point...
   18     390    7.894208e+03    0.000e+00    4.623e+02    7.655e-01
User objective function returned Inf; trying a new point...
   19     409    7.885726e+03    0.000e+00    4.831e+02    3.828e-01
User objective function returned Inf; trying a new point...
   20     431    7.846658e+03    0.000e+00    1.552e+02    3.828e-01
User objective function returned Inf; trying a new point...
   21     451    7.845341e+03    0.000e+00    1.643e+02    1.914e-01
User objective function returned Inf; trying a new point...
   22     473    7.845084e+03    0.000e+00    1.278e+02    1.914e-01
   23     492    7.843757e+03    0.000e+00    1.515e+02    9.569e-02
User objective function returned Inf; trying a new point...
   24     513    7.838080e+03    0.000e+00    2.167e+01    1.914e-01
User objective function returned Inf; trying a new point...
   25     536    7.837185e+03    0.000e+00    2.710e+01    9.569e-02
User objective function returned Inf; trying a new point...
   26     561    7.836907e+03    0.000e+00    1.773e+01    4.187e-02
User objective function returned Inf; trying a new point...
   27     580    7.836823e+03    0.000e+00    1.064e+01    4.187e-02
   28     601    7.836448e+03    0.000e+00    1.421e+01    8.373e-02
   29     624    7.836347e+03    0.000e+00    1.279e+01    4.187e-02
   30     644    7.836331e+03    0.000e+00    9.463e+00    2.093e-02

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     665    7.836232e+03    0.000e+00    1.364e+01    4.187e-02
   32     683    7.836189e+03    0.000e+00    8.510e+00    5.231e-02
   33     706    7.836161e+03    0.000e+00    7.152e+00    2.615e-02
   34     724    7.836154e+03    0.000e+00    6.386e+00    2.615e-02
   35     743    7.836125e+03    0.000e+00    6.073e+00    4.221e-02
   36     760    7.836077e+03    0.000e+00    9.424e+00    4.176e-02
   37     777    7.836071e+03    0.000e+00    7.219e+00    5.276e-03
   38     794    7.836064e+03    0.000e+00    5.521e+00    4.268e-03
   39     811    7.836049e+03    0.000e+00    1.990e+00    8.310e-03
   40     828    7.836038e+03    0.000e+00    1.199e+00    7.887e-03
   41     845    7.836033e+03    0.000e+00    8.461e-01    6.345e-03
   42     862    7.836033e+03    0.000e+00    1.611e-01    1.969e-03
   43     879    7.836033e+03    0.000e+00    3.773e-02    6.312e-04
   44     896    7.836033e+03    0.000e+00    5.367e-03    1.429e-04

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',7.462666e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 1.8331 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

   -0.0048
   -0.0054
   -0.0018
   -0.0009
    0.0001
   -0.0025
   -0.0043
   -0.0004
    0.0004
    0.0006
    0.0013
    0.0003
    0.0003
    0.0005
    0.0005
   -0.0007

Value of the log-likelihood function at convergence: -7836.0329
 
                      AIC                      BIC
              ------------------   -----------------------
                  15704.0658               15774.4167
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 1.8967e-08
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS          0.5102     0.0445    11.4647
A_SnGo         0.1888     0.0306     6.1649
A_AgeLT40      0.2538     0.0487     5.2053
A_ExpLT8       0.7197     0.0501    14.3776
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1          -1.1268     0.1276    -8.8310
Bc_2          -1.2203     0.1274    -9.5765
LV_Load        1.1247     0.0506    22.2171
Mu_12         -0.2734     0.0476    -5.7462
Mu_13         -0.8740     0.0639   -13.6815
Mu_14         -0.7749     0.0649   -11.9407
Mu_22         -0.3416     0.0508    -6.7294
Mu_23         -0.5930     0.0553   -10.7158
Mu_24         -0.6739     0.0603   -11.1659
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -0.9119     0.0362   -25.1550
C_VRC         -0.8138     0.0601   -13.5386
C_LV          -0.6723     0.1139    -5.9037
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    2.2649    1.2649
    1.2649    2.2649

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

    0.5102    0.1888    0.2538    0.7197   -1.1268   -1.2203    1.1247   -0.2734   -0.8740   -0.7749   -0.3416

  Columns 12 through 16

   -0.5930   -0.6739   -0.9119   -0.8138   -0.6723

The covariance matrix for these parameters is:

ihess =

  Columns 1 through 11

    0.0020    0.0002    0.0002    0.0002   -0.0036   -0.0036   -0.0006   -0.0002   -0.0002   -0.0002   -0.0002
    0.0002    0.0009    0.0002    0.0000   -0.0022   -0.0021   -0.0003   -0.0001   -0.0001   -0.0001   -0.0001
    0.0002    0.0002    0.0024    0.0002   -0.0016   -0.0015   -0.0004   -0.0000   -0.0001   -0.0003   -0.0001
    0.0002    0.0000    0.0002    0.0025   -0.0009   -0.0009   -0.0008   -0.0003   -0.0002   -0.0002   -0.0003
   -0.0036   -0.0022   -0.0016   -0.0009    0.0163    0.0148   -0.0010    0.0001   -0.0002    0.0000   -0.0007
   -0.0036   -0.0021   -0.0015   -0.0009    0.0148    0.0162   -0.0011   -0.0007   -0.0007   -0.0004    0.0001
   -0.0006   -0.0003   -0.0004   -0.0008   -0.0010   -0.0011    0.0026    0.0010    0.0010    0.0010    0.0010
   -0.0002   -0.0001   -0.0000   -0.0003    0.0001   -0.0007    0.0010    0.0023    0.0001    0.0001    0.0005
   -0.0002   -0.0001   -0.0001   -0.0002   -0.0002   -0.0007    0.0010    0.0001    0.0041   -0.0000    0.0005
   -0.0002   -0.0001   -0.0003   -0.0002    0.0000   -0.0004    0.0010    0.0001   -0.0000    0.0042    0.0003
   -0.0002   -0.0001   -0.0001   -0.0003   -0.0007    0.0001    0.0010    0.0005    0.0005    0.0003    0.0026
   -0.0002   -0.0001   -0.0001   -0.0003   -0.0006   -0.0002    0.0010    0.0004    0.0004    0.0004    0.0001
   -0.0002   -0.0001   -0.0002   -0.0003   -0.0006   -0.0003    0.0010    0.0004    0.0004    0.0004    0.0002
   -0.0000    0.0000    0.0000   -0.0001   -0.0001   -0.0001    0.0000   -0.0000    0.0000   -0.0001    0.0000
   -0.0000    0.0001   -0.0000   -0.0000   -0.0001   -0.0001    0.0000    0.0001    0.0001   -0.0001    0.0001
    0.0022    0.0008    0.0003    0.0003   -0.0049   -0.0050   -0.0010   -0.0004   -0.0003    0.0001   -0.0003

  Columns 12 through 16

   -0.0002   -0.0002   -0.0000   -0.0000    0.0022
   -0.0001   -0.0001    0.0000    0.0001    0.0008
   -0.0001   -0.0002    0.0000   -0.0000    0.0003
   -0.0003   -0.0003   -0.0001   -0.0000    0.0003
   -0.0006   -0.0006   -0.0001   -0.0001   -0.0049
   -0.0002   -0.0003   -0.0001   -0.0001   -0.0050
    0.0010    0.0010    0.0000    0.0000   -0.0010
    0.0004    0.0004   -0.0000    0.0001   -0.0004
    0.0004    0.0004    0.0000    0.0001   -0.0003
    0.0004    0.0004   -0.0001   -0.0001    0.0001
    0.0001    0.0002    0.0000    0.0001   -0.0003
    0.0031    0.0001    0.0000    0.0000   -0.0003
    0.0001    0.0036    0.0000    0.0001   -0.0003
    0.0000    0.0000    0.0013    0.0008    0.0003
    0.0000    0.0001    0.0008    0.0036    0.0008
   -0.0003   -0.0003    0.0003    0.0008    0.0130

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 22 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.219534e+04    0.000e+00    2.283e+03
User objective function returned Inf; trying a new point...
    1      39    1.023593e+04    0.000e+00    4.967e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.402640e+03    0.000e+00    2.793e+02    9.999e-01
User objective function returned Inf; trying a new point...
    3      81    8.342610e+03    0.000e+00    1.273e+03    4.999e-01
User objective function returned Inf; trying a new point...
    4      99    8.294226e+03    0.000e+00    1.573e+03    9.999e-01
User objective function returned Inf; trying a new point...
    5     121    8.255274e+03    0.000e+00    4.023e+02    9.999e-01
User objective function returned Inf; trying a new point...
    6     140    8.242281e+03    0.000e+00    1.010e+03    4.999e-01
User objective function returned Inf; trying a new point...
    7     161    8.097534e+03    0.000e+00    5.458e+02    9.999e-01
User objective function returned Inf; trying a new point...
    8     185    8.057497e+03    0.000e+00    3.939e+02    2.500e-01
User objective function returned Inf; trying a new point...
    9     204    8.048895e+03    0.000e+00    2.422e+02    2.500e-01
User objective function returned Inf; trying a new point...
   10     225    8.032418e+03    0.000e+00    2.509e+02    4.999e-01
User objective function returned Inf; trying a new point...
   11     245    8.026141e+03    0.000e+00    4.068e+02    2.500e-01
User objective function returned Inf; trying a new point...
   12     266    8.007054e+03    0.000e+00    2.033e+02    4.999e-01
User objective function returned Inf; trying a new point...
   13     286    8.001324e+03    0.000e+00    2.833e+02    2.500e-01
User objective function returned Inf; trying a new point...
   14     308    7.984219e+03    0.000e+00    1.805e+02    2.500e-01
User objective function returned Inf; trying a new point...
   15     327    7.981258e+03    0.000e+00    8.585e+01    2.500e-01
User objective function returned Inf; trying a new point...
   16     349    7.968670e+03    0.000e+00    2.147e+02    2.500e-01
User objective function returned Inf; trying a new point...
   17     369    7.967222e+03    0.000e+00    1.951e+02    4.375e-01
User objective function returned Inf; trying a new point...
   18     391    7.959210e+03    0.000e+00    9.597e+01    4.375e-01
User objective function returned Inf; trying a new point...
   19     410    7.952175e+03    0.000e+00    1.742e+02    4.375e-01
User objective function returned Inf; trying a new point...
   20     432    7.951919e+03    0.000e+00    8.238e+01    4.375e-01
User objective function returned Inf; trying a new point...
   21     450    7.947280e+03    0.000e+00    1.099e+02    4.375e-01
User objective function returned Inf; trying a new point...
   22     472    7.943390e+03    0.000e+00    8.638e+01    4.375e-01
User objective function returned Inf; trying a new point...
   23     491    7.939527e+03    0.000e+00    7.147e+01    2.187e-01
User objective function returned Inf; trying a new point...
   24     513    7.933132e+03    0.000e+00    7.869e+01    2.187e-01
User objective function returned Inf; trying a new point...
   25     532    7.933089e+03    0.000e+00    7.493e+01    2.187e-01
User objective function returned Inf; trying a new point...
   26     554    7.931735e+03    0.000e+00    1.926e+02    2.187e-01
   27     574    7.931539e+03    0.000e+00    2.123e+02    5.468e-02
   28     595    7.929404e+03    0.000e+00    8.938e+01    1.094e-01
   29     616    7.928200e+03    0.000e+00    8.962e+01    2.187e-01
User objective function returned Inf; trying a new point...
   30     638    7.927466e+03    0.000e+00    8.025e+01    2.187e-01
User objective function returned Inf; trying a new point...

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     658    7.927124e+03    0.000e+00    3.969e+01    5.468e-02
   32     679    7.925152e+03    0.000e+00    3.845e+01    1.094e-01
   33     700    7.921447e+03    0.000e+00    9.272e+01    7.655e-01
User objective function returned Inf; trying a new point...
   34     726    7.919868e+03    0.000e+00    5.606e+01    1.675e-01
User objective function returned Inf; trying a new point...
   35     744    7.918990e+03    0.000e+00    9.382e+01    3.349e-01
   36     761    7.910022e+03    0.000e+00    4.978e+01    1.642e+00
   37     778    7.904704e+03    0.000e+00    5.682e+02    2.890e+00
   38     796    7.901015e+03    0.000e+00    6.050e+02    2.886e+00
   39     813    7.897460e+03    0.000e+00    7.333e+02    2.820e-01
   40     831    7.896914e+03    0.000e+00    4.451e+02    6.457e-01
   41     848    7.892531e+03    0.000e+00    1.099e+02    1.736e+00
   42     865    7.891281e+03    0.000e+00    5.264e+02    2.379e+00
   43     882    7.889114e+03    0.000e+00    2.308e+02    7.899e-01
   44     899    7.885454e+03    0.000e+00    1.647e+02    4.505e+00
   45     916    7.883828e+03    0.000e+00    6.684e+02    5.434e+00
   46     933    7.882537e+03    0.000e+00    2.036e+02    1.647e+00
   47     951    7.882122e+03    0.000e+00    9.855e+02    3.918e+00
   48     968    7.880488e+03    0.000e+00    5.260e+02    5.405e+00
   49     985    7.879679e+03    0.000e+00    6.958e+02    3.341e+00
   50    1002    7.879038e+03    0.000e+00    1.546e+03    1.199e+01
   51    1019    7.878368e+03    0.000e+00    5.227e+02    4.065e+00
   52    1036    7.877781e+03    0.000e+00    1.104e+02    3.104e+00
   53    1054    7.877483e+03    0.000e+00    6.127e+02    5.239e+00
   54    1071    7.877223e+03    0.000e+00    4.282e+02    2.113e+00
   55    1088    7.876612e+03    0.000e+00    4.436e+02    1.020e+01
   56    1105    7.876099e+03    0.000e+00    2.761e+02    8.019e+00
   57    1123    7.875733e+03    0.000e+00    7.248e+02    1.068e+01
   58    1140    7.875495e+03    0.000e+00    9.249e+02    4.591e+00
   59    1157    7.875403e+03    0.000e+00    5.699e+02    1.441e+00
   60    1174    7.875253e+03    0.000e+00    1.338e+02    2.328e+00

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   61    1191    7.875275e+03    0.000e+00    3.122e+01    8.375e-01
   62    1208    7.875272e+03    0.000e+00    5.235e-01    1.066e-01
   63    1225    7.875272e+03    0.000e+00    1.179e+00    4.933e-03

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',5.333128e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 2.5164 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

    1.1786
    0.7567
    0.0145
    0.0172
    0.0220
    0.0123
   -0.0141
   -0.0074
   -0.0045
   -0.0022
   -0.0004
   -0.0002
   -0.0012
   -0.0085
   -0.0007
   -0.0314

Value of the log-likelihood function at convergence: -7875.2717
 
                      AIC                      BIC
              ------------------   -----------------------
                  15782.5434               15852.8943
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 0.46752
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS         -0.0073     0.0019    -3.8372
A_SnGo        -0.0031     0.0009    -3.5661
A_AgeLT40      0.4494     0.0484     9.2952
A_ExpLT8       0.4463     0.0476     9.3709
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1           0.4102     0.0592     6.9338
Bc_2           0.2190     0.0600     3.6489
LV_Load        1.2792     0.0548    23.3418
Mu_12         -0.4418     0.0538    -8.2167
Mu_13         -0.6873     0.0585   -11.7573
Mu_14         -0.6708     0.0599   -11.1933
Mu_22         -0.5511     0.0561    -9.8248
Mu_23         -0.4988     0.0554    -8.9979
Mu_24         -0.6084     0.0600   -10.1388
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -0.8183     0.0344   -23.8024
C_VRC         -0.6694     0.0601   -11.1331
C_LV          96.8462    21.8910     4.4240
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    2.6364    1.6364
    1.6364    2.6364

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

   -0.0073   -0.0031    0.4494    0.4463    0.4102    0.2190    1.2792   -0.4418   -0.6873   -0.6708   -0.5511

  Columns 12 through 16

   -0.4988   -0.6084   -0.8183   -0.6694   96.8462

The covariance matrix for these parameters is:

ihess =

  Columns 1 through 11

    0.0000    0.0000   -0.0000   -0.0000    0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000
    0.0000    0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000
   -0.0000   -0.0000    0.0023    0.0000   -0.0012   -0.0013   -0.0005   -0.0001   -0.0001   -0.0002   -0.0002
   -0.0000   -0.0000    0.0000    0.0023   -0.0013   -0.0014   -0.0004   -0.0001   -0.0001   -0.0001   -0.0001
    0.0000   -0.0000   -0.0012   -0.0013    0.0035    0.0020    0.0005    0.0011    0.0007    0.0005    0.0002
   -0.0000   -0.0000   -0.0013   -0.0014    0.0020    0.0036    0.0003    0.0000    0.0001    0.0002    0.0010
   -0.0000   -0.0000   -0.0005   -0.0004    0.0005    0.0003    0.0030    0.0011    0.0011    0.0012    0.0012
   -0.0000   -0.0000   -0.0001   -0.0001    0.0011    0.0000    0.0011    0.0029    0.0001    0.0001    0.0003
   -0.0000   -0.0000   -0.0001   -0.0001    0.0007    0.0001    0.0011    0.0001    0.0034    0.0001    0.0004
   -0.0000   -0.0000   -0.0002   -0.0001    0.0005    0.0002    0.0012    0.0001    0.0001    0.0036    0.0004
   -0.0000   -0.0000   -0.0002   -0.0001    0.0002    0.0010    0.0012    0.0003    0.0004    0.0004    0.0031
   -0.0000   -0.0000   -0.0003   -0.0003    0.0004    0.0009    0.0013    0.0004    0.0004    0.0006    0.0002
   -0.0000   -0.0000   -0.0002   -0.0001    0.0002    0.0005    0.0012    0.0004    0.0004    0.0005    0.0003
    0.0000    0.0000    0.0001    0.0000   -0.0001   -0.0001   -0.0001    0.0001    0.0000    0.0000   -0.0000
    0.0000    0.0000    0.0000    0.0000   -0.0001   -0.0001   -0.0000    0.0000    0.0001    0.0001   -0.0000
    0.0402    0.0164   -0.0033   -0.0027    0.0420    0.0184   -0.1526   -0.0396   -0.0430   -0.0415   -0.0145

  Columns 12 through 16

   -0.0000   -0.0000    0.0000    0.0000    0.0402
   -0.0000   -0.0000    0.0000    0.0000    0.0164
   -0.0003   -0.0002    0.0001    0.0000   -0.0033
   -0.0003   -0.0001    0.0000    0.0000   -0.0027
    0.0004    0.0002   -0.0001   -0.0001    0.0420
    0.0009    0.0005   -0.0001   -0.0001    0.0184
    0.0013    0.0012   -0.0001   -0.0000   -0.1526
    0.0004    0.0004    0.0001    0.0000   -0.0396
    0.0004    0.0004    0.0000    0.0001   -0.0430
    0.0006    0.0005    0.0000    0.0001   -0.0415
    0.0002    0.0003   -0.0000   -0.0000   -0.0145
    0.0031    0.0002    0.0000    0.0001   -0.0435
    0.0002    0.0036   -0.0000    0.0000   -0.0542
    0.0000   -0.0000    0.0012    0.0006   -0.0187
    0.0001    0.0000    0.0006    0.0036   -0.0137
   -0.0435   -0.0542   -0.0187   -0.0137  479.2158

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 23 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.261578e+04    0.000e+00    2.533e+03
User objective function returned Inf; trying a new point...
    1      39    1.031038e+04    0.000e+00    4.826e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.654739e+03    0.000e+00    6.369e+02    9.999e-01
User objective function returned Inf; trying a new point...
    3      81    8.574691e+03    0.000e+00    1.357e+03    4.999e-01
User objective function returned Inf; trying a new point...
    4      99    8.479365e+03    0.000e+00    1.476e+03    5.000e-01
User objective function returned Inf; trying a new point...
    5     121    8.360449e+03    0.000e+00    2.123e+02    4.999e-01
User objective function returned Inf; trying a new point...
    6     141    8.354428e+03    0.000e+00    2.611e+02    2.500e-01
User objective function returned Inf; trying a new point...
    7     162    8.289035e+03    0.000e+00    3.410e+02    5.000e-01
User objective function returned Inf; trying a new point...
    8     186    8.275384e+03    0.000e+00    6.024e+02    4.375e-01
User objective function returned Inf; trying a new point...
    9     204    8.271017e+03    0.000e+00    7.357e+02    4.375e-01
User objective function returned Inf; trying a new point...
   10     226    8.229686e+03    0.000e+00    3.694e+02    4.375e-01
User objective function returned Inf; trying a new point...
   11     245    8.220337e+03    0.000e+00    3.430e+02    4.375e-01
User objective function returned Inf; trying a new point...
   12     268    8.201574e+03    0.000e+00    4.304e+02    2.187e-01
User objective function returned Inf; trying a new point...
   13     286    8.193258e+03    0.000e+00    4.800e+02    4.375e-01
User objective function returned Inf; trying a new point...
   14     308    8.190561e+03    0.000e+00    1.102e+02    4.375e-01
User objective function returned Inf; trying a new point...
   15     327    8.189006e+03    0.000e+00    1.844e+02    2.187e-01
User objective function returned Inf; trying a new point...
   16     348    8.173630e+03    0.000e+00    1.981e+02    4.375e-01
User objective function returned Inf; trying a new point...
   17     368    8.169714e+03    0.000e+00    5.321e+01    2.187e-01
User objective function returned Inf; trying a new point...
   18     389    8.168813e+03    0.000e+00    1.608e+02    4.375e-01
User objective function returned Inf; trying a new point...
   19     407    8.155557e+03    0.000e+00    9.077e+01    4.375e-01
User objective function returned Inf; trying a new point...
   20     429    8.144958e+03    0.000e+00    1.417e+02    4.375e-01
User objective function returned Inf; trying a new point...
   21     448    8.137606e+03    0.000e+00    1.940e+02    4.375e-01
User objective function returned Inf; trying a new point...
   22     471    8.127956e+03    0.000e+00    2.197e+02    2.187e-01
User objective function returned Inf; trying a new point...
   23     493    8.122216e+03    0.000e+00    1.836e+02    2.187e-01
User objective function returned Inf; trying a new point...
   24     512    8.121036e+03    0.000e+00    1.804e+02    2.187e-01
User objective function returned Inf; trying a new point...
   25     534    8.113541e+03    0.000e+00    1.820e+02    2.187e-01
   26     556    8.096097e+03    0.000e+00    2.521e+02    2.187e-01
User objective function returned Inf; trying a new point...
   27     578    8.080086e+03    0.000e+00    6.501e+02    7.655e-01
User objective function returned Inf; trying a new point...
   28     597    8.075673e+03    0.000e+00    8.286e+02    7.655e-01
User objective function returned Inf; trying a new point...
   29     620    8.007136e+03    0.000e+00    2.481e+02    3.828e-01
User objective function returned Inf; trying a new point...
   30     641    8.004183e+03    0.000e+00    1.260e+02    7.655e-01
User objective function returned Inf; trying a new point...

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     661    8.000788e+03    0.000e+00    2.064e+02    1.914e-01
   32     679    7.987703e+03    0.000e+00    1.201e+02    4.089e-01
User objective function returned Inf; trying a new point...
   33     701    7.983378e+03    0.000e+00    3.060e+02    4.089e-01
User objective function returned Inf; trying a new point...
   34     719    7.982986e+03    0.000e+00    8.603e+01    4.089e-01
   35     737    7.973387e+03    0.000e+00    6.521e+01    2.915e-01
   36     755    7.966255e+03    0.000e+00    1.301e+02    3.294e-01
   37     772    7.964092e+03    0.000e+00    8.266e+01    1.198e-01
   38     789    7.963316e+03    0.000e+00    5.388e+01    5.577e-02
   39     806    7.961736e+03    0.000e+00    2.382e+01    1.094e-01
   40     823    7.960667e+03    0.000e+00    3.302e+01    9.041e-02
   41     840    7.960266e+03    0.000e+00    2.181e+01    4.996e-02
   42     857    7.960027e+03    0.000e+00    1.384e+01    7.685e-02
   43     874    7.959972e+03    0.000e+00    8.579e+00    4.617e-02
   44     891    7.959964e+03    0.000e+00    1.390e+00    2.108e-02
   45     908    7.959962e+03    0.000e+00    5.762e-01    6.657e-03
   46     925    7.959962e+03    0.000e+00    1.752e-01    1.212e-03
   47     942    7.959962e+03    0.000e+00    1.874e-02    4.695e-04
   48     959    7.959962e+03    0.000e+00    2.322e-03    5.527e-05

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',3.157101e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 2.0119 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

    0.0023
    0.0015
    0.0006
    0.0007
    0.0009
   -0.0003
    0.0018
   -0.0007
   -0.0003
   -0.0006
   -0.0006
    0.0004
   -0.0001
    0.0009
   -0.0002
   -0.0003

Value of the log-likelihood function at convergence: -7959.9616
 
                      AIC                      BIC
              ------------------   -----------------------
                  15951.9232               16022.2741
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 7.0914e-09
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS          0.6141     0.0475    12.9176
A_SnGo         0.1758     0.0299     5.8783
A_AgeLT40      0.3938     0.0527     7.4702
A_ExpLT8       0.5182     0.0518     9.9979
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1          -0.8688     0.1249    -6.9581
Bc_2          -0.8959     0.1261    -7.1053
LV_Load        1.0376     0.0454    22.8507
Mu_12         -0.4436     0.0531    -8.3456
Mu_13         -0.8659     0.0605   -14.3178
Mu_14         -0.5632     0.0561   -10.0477
Mu_22         -0.2970     0.0461    -6.4391
Mu_23         -0.5434     0.0519   -10.4631
Mu_24         -0.6584     0.0557   -11.8284
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -0.8849     0.0354   -25.0228
C_VRC         -0.7758     0.0577   -13.4527
C_LV          -1.2069     0.1256    -9.6079
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    2.0767    1.0767
    1.0767    2.0767

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

    0.6141    0.1758    0.3938    0.5182   -0.8688   -0.8959    1.0376   -0.4436   -0.8659   -0.5632   -0.2970

  Columns 12 through 16

   -0.5434   -0.6584   -0.8849   -0.7758   -1.2069

The covariance matrix for these parameters is:

ihess =

  Columns 1 through 11

    0.0023    0.0004    0.0003    0.0003   -0.0040   -0.0041   -0.0007   -0.0002   -0.0002   -0.0002   -0.0003
    0.0004    0.0009    0.0002    0.0000   -0.0023   -0.0023   -0.0002    0.0000    0.0000   -0.0000   -0.0001
    0.0003    0.0002    0.0028    0.0002   -0.0013   -0.0012   -0.0006   -0.0001   -0.0003   -0.0001   -0.0001
    0.0003    0.0000    0.0002    0.0027   -0.0010   -0.0011   -0.0007   -0.0001   -0.0001   -0.0002   -0.0003
   -0.0040   -0.0023   -0.0013   -0.0010    0.0156    0.0144   -0.0007    0.0004   -0.0002   -0.0002   -0.0002
   -0.0041   -0.0023   -0.0012   -0.0011    0.0144    0.0159   -0.0007   -0.0005   -0.0007   -0.0006    0.0006
   -0.0007   -0.0002   -0.0006   -0.0007   -0.0007   -0.0007    0.0021    0.0008    0.0008    0.0009    0.0008
   -0.0002    0.0000   -0.0001   -0.0001    0.0004   -0.0005    0.0008    0.0028    0.0001    0.0001    0.0003
   -0.0002    0.0000   -0.0003   -0.0001   -0.0002   -0.0007    0.0008    0.0001    0.0037    0.0001    0.0004
   -0.0002   -0.0000   -0.0001   -0.0002   -0.0002   -0.0006    0.0009    0.0001    0.0001    0.0031    0.0003
   -0.0003   -0.0001   -0.0001   -0.0003   -0.0002    0.0006    0.0008    0.0003    0.0004    0.0003    0.0021
   -0.0001   -0.0000   -0.0001   -0.0001   -0.0007   -0.0003    0.0008    0.0003    0.0004    0.0003    0.0000
   -0.0003   -0.0001   -0.0003   -0.0003   -0.0004   -0.0001    0.0009    0.0003    0.0002    0.0005    0.0002
    0.0001    0.0001    0.0000    0.0000   -0.0003   -0.0003   -0.0000   -0.0000    0.0001   -0.0001    0.0001
    0.0000    0.0000   -0.0001    0.0001   -0.0001   -0.0001    0.0000    0.0000   -0.0000    0.0001    0.0001
    0.0040    0.0018    0.0008    0.0005   -0.0097   -0.0099   -0.0011   -0.0003   -0.0001   -0.0003   -0.0005

  Columns 12 through 16

   -0.0001   -0.0003    0.0001    0.0000    0.0040
   -0.0000   -0.0001    0.0001    0.0000    0.0018
   -0.0001   -0.0003    0.0000   -0.0001    0.0008
   -0.0001   -0.0003    0.0000    0.0001    0.0005
   -0.0007   -0.0004   -0.0003   -0.0001   -0.0097
   -0.0003   -0.0001   -0.0003   -0.0001   -0.0099
    0.0008    0.0009   -0.0000    0.0000   -0.0011
    0.0003    0.0003   -0.0000    0.0000   -0.0003
    0.0004    0.0002    0.0001   -0.0000   -0.0001
    0.0003    0.0005   -0.0001    0.0001   -0.0003
    0.0000    0.0002    0.0001    0.0001   -0.0005
    0.0027    0.0000    0.0000   -0.0001   -0.0001
    0.0000    0.0031    0.0000    0.0001   -0.0003
    0.0000    0.0000    0.0013    0.0007    0.0010
   -0.0001    0.0001    0.0007    0.0033    0.0012
   -0.0001   -0.0003    0.0010    0.0012    0.0158

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 24 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.259585e+04    0.000e+00    2.459e+03
User objective function returned Inf; trying a new point...
    1      39    9.992281e+03    0.000e+00    4.806e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.274209e+03    0.000e+00    7.141e+02    9.999e-01
User objective function returned Inf; trying a new point...
    3      80    8.267681e+03    0.000e+00    1.495e+03    9.999e-01
User objective function returned Inf; trying a new point...
    4      98    8.145710e+03    0.000e+00    2.092e+03    9.999e-01
User objective function returned Inf; trying a new point...
    5     120    7.976520e+03    0.000e+00    4.694e+02    9.999e-01
User objective function returned Inf; trying a new point...
    6     140    7.938716e+03    0.000e+00    4.310e+02    5.000e-01
User objective function returned Inf; trying a new point...
    7     161    7.806121e+03    0.000e+00    4.717e+02    9.999e-01
User objective function returned Inf; trying a new point...
    8     181    7.783692e+03    0.000e+00    5.730e+02    4.999e-01
User objective function returned Inf; trying a new point...
    9     203    7.773377e+03    0.000e+00    1.794e+02    4.999e-01
User objective function returned Inf; trying a new point...
   10     222    7.768854e+03    0.000e+00    1.661e+02    2.500e-01
User objective function returned Inf; trying a new point...
   11     244    7.735040e+03    0.000e+00    9.912e+01    2.500e-01
User objective function returned Inf; trying a new point...
   12     268    7.726828e+03    0.000e+00    9.891e+01    2.187e-01
User objective function returned Inf; trying a new point...
   13     287    7.724298e+03    0.000e+00    1.067e+02    2.187e-01
User objective function returned Inf; trying a new point...
   14     308    7.715946e+03    0.000e+00    3.126e+02    4.375e-01
User objective function returned Inf; trying a new point...
   15     328    7.713897e+03    0.000e+00    3.499e+02    2.187e-01
User objective function returned Inf; trying a new point...
   16     350    7.705206e+03    0.000e+00    7.368e+01    2.187e-01
User objective function returned Inf; trying a new point...
   17     368    7.701013e+03    0.000e+00    1.029e+02    4.375e-01
User objective function returned Inf; trying a new point...
   18     391    7.695058e+03    0.000e+00    1.609e+02    2.187e-01
User objective function returned Inf; trying a new point...
   19     411    7.694431e+03    0.000e+00    1.062e+02    1.094e-01
User objective function returned Inf; trying a new point...
   20     433    7.693861e+03    0.000e+00    1.277e+02    1.094e-01
User objective function returned Inf; trying a new point...
   21     451    7.693608e+03    0.000e+00    1.274e+02    1.094e-01
   22     472    7.689887e+03    0.000e+00    1.691e+01    2.187e-01
User objective function returned Inf; trying a new point...
   23     492    7.689733e+03    0.000e+00    5.598e+01    1.094e-01
   24     513    7.689642e+03    0.000e+00    1.401e+02    2.187e-01
   25     533    7.689427e+03    0.000e+00    1.488e+02    5.468e-02
   26     554    7.686677e+03    0.000e+00    2.940e+01    1.094e-01
   27     574    7.686498e+03    0.000e+00    3.911e+01    5.468e-02
   28     595    7.685548e+03    0.000e+00    1.612e+01    1.094e-01
   29     614    7.685127e+03    0.000e+00    2.181e+01    1.094e-01
User objective function returned Inf; trying a new point...
   30     635    7.683635e+03    0.000e+00    6.086e+01    2.187e-01

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     653    7.682993e+03    0.000e+00    1.611e+02    4.375e-01
User objective function returned Inf; trying a new point...
   32     675    7.682643e+03    0.000e+00    9.231e+01    4.375e-01
User objective function returned Inf; trying a new point...
   33     693    7.681962e+03    0.000e+00    1.837e+02    4.375e-01
   34     710    7.673898e+03    0.000e+00    1.338e+02    7.682e-01
   35     727    7.671520e+03    0.000e+00    1.091e+02    4.634e-01
   36     744    7.665581e+03    0.000e+00    1.159e+02    2.167e+00
   37     762    7.664177e+03    0.000e+00    3.748e+02    1.417e+00
   38     779    7.660901e+03    0.000e+00    4.121e+02    2.278e+00
   39     797    7.658779e+03    0.000e+00    4.637e+02    7.581e-01
   40     814    7.658396e+03    0.000e+00    3.235e+02    6.291e-01
   41     831    7.655904e+03    0.000e+00    1.499e+01    1.266e+00
   42     848    7.655421e+03    0.000e+00    3.932e+02    2.481e+00
   43     865    7.654288e+03    0.000e+00    1.098e+02    2.226e-01
   44     882    7.653380e+03    0.000e+00    1.337e+01    1.388e+00
   45     899    7.651690e+03    0.000e+00    1.737e+02    4.422e+00
   46     916    7.650963e+03    0.000e+00    3.052e+02    3.643e+00
   47     933    7.649861e+03    0.000e+00    1.242e+02    4.027e+00
   48     950    7.649355e+03    0.000e+00    5.653e+02    6.745e+00
   49     969    7.649117e+03    0.000e+00    7.415e+02    2.383e+00
   50     987    7.648383e+03    0.000e+00    3.765e+02    6.967e-01
   51    1004    7.647988e+03    0.000e+00    1.266e+02    3.320e+00
   52    1021    7.647751e+03    0.000e+00    5.599e+02    8.648e+00
   53    1038    7.647434e+03    0.000e+00    1.721e+02    5.780e-03
   54    1055    7.647182e+03    0.000e+00    2.374e+01    4.437e+00
   55    1074    7.646941e+03    0.000e+00    3.634e+02    6.669e+00
   56    1091    7.646695e+03    0.000e+00    5.882e+02    7.078e+00
   57    1108    7.646442e+03    0.000e+00    2.079e+02    6.314e+00
   58    1125    7.646310e+03    0.000e+00    5.690e+02    9.311e+00
   59    1142    7.646230e+03    0.000e+00    2.512e+02    1.669e+00
   60    1159    7.646149e+03    0.000e+00    3.934e+01    3.039e+00

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   61    1176    7.646002e+03    0.000e+00    5.143e+02    1.100e+01
   62    1193    7.646020e+03    0.000e+00    6.145e+01    4.463e+00
   63    1210    7.645994e+03    0.000e+00    1.592e+01    1.439e+00
   64    1227    7.645983e+03    0.000e+00    8.123e+00    5.744e-01
   65    1244    7.645984e+03    0.000e+00    9.233e-01    6.577e-02
   66    1261    7.645985e+03    0.000e+00    1.863e-01    1.726e-03

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',1.831515e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 2.5606 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

   -0.1863
    0.1362
   -0.0007
   -0.0013
   -0.0008
   -0.0007
    0.0002
    0.0005
    0.0005
    0.0001
    0.0002
    0.0005
    0.0005
    0.0004
    0.0002
   -0.0169

Value of the log-likelihood function at convergence: -7645.9845
 
                      AIC                      BIC
              ------------------   -----------------------
                  15323.9690               15394.3199
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 0.47123
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS         -0.0051     0.0023    -2.2303
A_SnGo        -0.0040     0.0019    -2.0722
A_AgeLT40      0.7596     0.0484    15.7049
A_ExpLT8       0.4313     0.0473     9.1146
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1           0.5216     0.0618     8.4465
Bc_2           0.1445     0.0586     2.4659
LV_Load        1.3006     0.0520    25.0012
Mu_12         -0.2290     0.0528    -4.3384
Mu_13         -0.6211     0.0587   -10.5810
Mu_14         -0.8154     0.0653   -12.4906
Mu_22         -0.5122     0.0560    -9.1441
Mu_23         -0.4470     0.0546    -8.1816
Mu_24         -0.6633     0.0617   -10.7469
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -0.9651     0.0383   -25.1777
C_VRC         -0.9747     0.0636   -15.3273
C_LV          94.2607    40.5881     2.3224
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    2.6915    1.6915
    1.6915    2.6915

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

   -0.0051   -0.0040    0.7596    0.4313    0.5216    0.1445    1.3006   -0.2290   -0.6211   -0.8154   -0.5122

  Columns 12 through 16

   -0.4470   -0.6633   -0.9651   -0.9747   94.2607

The covariance matrix for these parameters is:

ihess =

   1.0e+03 *

  Columns 1 through 11

    0.0000    0.0000    0.0000    0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000    0.0000    0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000    0.0000    0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000
    0.0000    0.0000    0.0000    0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000
   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000   -0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000   -0.0000    0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000   -0.0000    0.0000   -0.0000    0.0000    0.0000
    0.0000    0.0000    0.0000    0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000   -0.0000
    0.0001    0.0001    0.0001    0.0001   -0.0007   -0.0009    0.0003    0.0001    0.0002    0.0001    0.0001

  Columns 12 through 16

    0.0000    0.0000    0.0000    0.0000    0.0001
    0.0000    0.0000    0.0000    0.0000    0.0001
   -0.0000   -0.0000    0.0000    0.0000    0.0001
   -0.0000   -0.0000    0.0000    0.0000    0.0001
    0.0000    0.0000    0.0000   -0.0000   -0.0007
    0.0000    0.0000    0.0000    0.0000   -0.0009
    0.0000    0.0000   -0.0000    0.0000    0.0003
    0.0000    0.0000    0.0000    0.0000    0.0001
    0.0000    0.0000   -0.0000    0.0000    0.0002
    0.0000    0.0000    0.0000    0.0000    0.0001
    0.0000    0.0000    0.0000   -0.0000    0.0001
    0.0000    0.0000   -0.0000    0.0000    0.0001
    0.0000    0.0000    0.0000    0.0000    0.0002
   -0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0001    0.0002    0.0000    0.0000    1.6474

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 25 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.252098e+04    0.000e+00    2.468e+03
User objective function returned Inf; trying a new point...
    1      39    1.021186e+04    0.000e+00    4.798e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.500837e+03    0.000e+00    5.607e+02    9.999e-01
User objective function returned Inf; trying a new point...
    3      81    8.413782e+03    0.000e+00    1.366e+03    4.999e-01
User objective function returned Inf; trying a new point...
    4      99    8.305122e+03    0.000e+00    1.439e+03    4.999e-01
User objective function returned Inf; trying a new point...
    5     121    8.183115e+03    0.000e+00    2.141e+02    4.999e-01
User objective function returned Inf; trying a new point...
    6     141    8.165992e+03    0.000e+00    2.511e+02    2.500e-01
User objective function returned Inf; trying a new point...
    7     162    8.100530e+03    0.000e+00    4.438e+02    5.000e-01
User objective function returned Inf; trying a new point...
    8     186    8.079398e+03    0.000e+00    2.894e+02    4.375e-01
User objective function returned Inf; trying a new point...
    9     205    8.061508e+03    0.000e+00    4.941e+02    4.375e-01
User objective function returned Inf; trying a new point...
   10     227    8.015365e+03    0.000e+00    2.156e+02    4.375e-01
User objective function returned Inf; trying a new point...
   11     246    8.015192e+03    0.000e+00    1.974e+02    4.375e-01
User objective function returned Inf; trying a new point...
   12     268    7.986058e+03    0.000e+00    1.733e+02    4.375e-01
User objective function returned Inf; trying a new point...
   13     288    7.981014e+03    0.000e+00    1.608e+02    2.187e-01
User objective function returned Inf; trying a new point...
   14     309    7.976835e+03    0.000e+00    9.312e+01    4.375e-01
User objective function returned Inf; trying a new point...
   15     327    7.974739e+03    0.000e+00    6.857e+01    4.375e-01
User objective function returned Inf; trying a new point...
   16     349    7.973489e+03    0.000e+00    2.366e+02    4.375e-01
User objective function returned Inf; trying a new point...
   17     367    7.973223e+03    0.000e+00    1.428e+02    4.375e-01
User objective function returned Inf; trying a new point...
   18     389    7.952104e+03    0.000e+00    1.686e+02    4.375e-01
User objective function returned Inf; trying a new point...
   19     407    7.918108e+03    0.000e+00    9.720e+01    8.749e-01
User objective function returned Inf; trying a new point...
   20     430    7.903334e+03    0.000e+00    1.808e+02    4.375e-01
User objective function returned Inf; trying a new point...
   21     448    7.882081e+03    0.000e+00    2.868e+02    8.749e-01
User objective function returned Inf; trying a new point...
   22     471    7.880344e+03    0.000e+00    4.143e+02    4.375e-01
User objective function returned Inf; trying a new point...
   23     490    7.878854e+03    0.000e+00    3.172e+02    2.187e-01
User objective function returned Inf; trying a new point...
   24     511    7.849534e+03    0.000e+00    1.978e+02    4.375e-01
User objective function returned Inf; trying a new point...
   25     533    7.838445e+03    0.000e+00    2.819e+02    4.375e-01
User objective function returned Inf; trying a new point...
   26     555    7.832721e+03    0.000e+00    4.484e+02    4.375e-01
User objective function returned Inf; trying a new point...
   27     575    7.831929e+03    0.000e+00    4.173e+02    1.094e-01
   28     593    7.824063e+03    0.000e+00    2.360e+02    5.678e-01
User objective function returned Inf; trying a new point...
   29     616    7.818659e+03    0.000e+00    3.063e+02    2.839e-01
User objective function returned Inf; trying a new point...
   30     635    7.817021e+03    0.000e+00    3.288e+02    1.420e-01
User objective function returned Inf; trying a new point...

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     656    7.803868e+03    0.000e+00    1.706e+02    2.839e-01
User objective function returned Inf; trying a new point...
   32     676    7.801667e+03    0.000e+00    2.539e+02    1.420e-01
   33     693    7.797010e+03    0.000e+00    3.068e+01    2.725e-01
   34     710    7.796384e+03    0.000e+00    1.040e+02    3.949e-01
   35     727    7.793180e+03    0.000e+00    6.202e+01    1.530e-01
   36     744    7.792273e+03    0.000e+00    4.768e+01    8.918e-02
   37     761    7.791775e+03    0.000e+00    3.365e+01    1.552e-01
   38     778    7.791646e+03    0.000e+00    3.057e+01    2.817e-02
   39     795    7.791293e+03    0.000e+00    2.569e+01    4.529e-02
   40     812    7.790979e+03    0.000e+00    1.239e+01    4.286e-02
   41     829    7.790845e+03    0.000e+00    2.585e+00    5.067e-02
   42     846    7.790831e+03    0.000e+00    2.706e+00    2.079e-02
   43     863    7.790829e+03    0.000e+00    1.045e+00    4.242e-03
   44     880    7.790829e+03    0.000e+00    3.379e-01    2.205e-03
   45     897    7.790829e+03    0.000e+00    2.436e-02    7.504e-04
   46     914    7.790829e+03    0.000e+00    8.570e-03    7.111e-05

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',6.045305e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 1.9158 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

   -0.0048
   -0.0015
   -0.0015
   -0.0008
   -0.0049
    0.0004
   -0.0086
    0.0017
    0.0032
    0.0010
   -0.0011
   -0.0003
    0.0008
   -0.0003
    0.0004
   -0.0023

Value of the log-likelihood function at convergence: -7790.8291
 
                      AIC                      BIC
              ------------------   -----------------------
                  15613.6582               15684.0091
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 1.0052e-07
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS          0.5480     0.0456    12.0067
A_SnGo         0.2336     0.0273     8.5425
A_AgeLT40      0.3745     0.0474     7.9091
A_ExpLT8       0.7234     0.0505    14.3162
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1          -0.8700     0.1242    -7.0046
Bc_2          -1.2481     0.1259    -9.9160
LV_Load        1.0586     0.0489    21.6366
Mu_12         -0.5986     0.0558   -10.7250
Mu_13         -0.3628     0.0489    -7.4120
Mu_14         -0.5373     0.0513   -10.4765
Mu_22         -0.4618     0.0530    -8.7182
Mu_23         -0.4502     0.0514    -8.7614
Mu_24         -1.0405     0.0710   -14.6594
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -1.0207     0.0424   -24.0832
C_VRC         -0.5874     0.0603    -9.7410
C_LV          -1.0744     0.1277    -8.4138
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    2.1205    1.1205
    1.1205    2.1205

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

    0.5480    0.2336    0.3745    0.7234   -0.8700   -1.2481    1.0586   -0.5986   -0.3628   -0.5373   -0.4618

  Columns 12 through 16

   -0.4502   -1.0405   -1.0207   -0.5874   -1.0744

The covariance matrix for these parameters is:

ihess =

  Columns 1 through 11

    0.0021    0.0004    0.0002    0.0004   -0.0038   -0.0038   -0.0007   -0.0002   -0.0003   -0.0003   -0.0002
    0.0004    0.0007    0.0001    0.0000   -0.0021   -0.0020   -0.0002    0.0000   -0.0000   -0.0000   -0.0000
    0.0002    0.0001    0.0022    0.0001   -0.0011   -0.0011   -0.0004   -0.0002   -0.0000   -0.0001   -0.0001
    0.0004    0.0000    0.0001    0.0026   -0.0007   -0.0007   -0.0009   -0.0003   -0.0002   -0.0002   -0.0003
   -0.0038   -0.0021   -0.0011   -0.0007    0.0154    0.0141   -0.0012    0.0003   -0.0001   -0.0003   -0.0009
   -0.0038   -0.0020   -0.0011   -0.0007    0.0141    0.0158   -0.0015   -0.0009   -0.0007   -0.0007   -0.0001
   -0.0007   -0.0002   -0.0004   -0.0009   -0.0012   -0.0015    0.0024    0.0009    0.0009    0.0009    0.0010
   -0.0002    0.0000   -0.0002   -0.0003    0.0003   -0.0009    0.0009    0.0031    0.0001    0.0001    0.0004
   -0.0003   -0.0000   -0.0000   -0.0002   -0.0001   -0.0007    0.0009    0.0001    0.0024    0.0001    0.0004
   -0.0003   -0.0000   -0.0001   -0.0002   -0.0003   -0.0007    0.0009    0.0001    0.0001    0.0026    0.0003
   -0.0002   -0.0000   -0.0001   -0.0003   -0.0009   -0.0001    0.0010    0.0004    0.0004    0.0003    0.0028
   -0.0002   -0.0000   -0.0002   -0.0002   -0.0007   -0.0004    0.0010    0.0004    0.0005    0.0005    0.0002
   -0.0002   -0.0000   -0.0002   -0.0002   -0.0007   -0.0004    0.0010    0.0004    0.0004    0.0005    0.0002
    0.0000   -0.0000    0.0001   -0.0001    0.0000    0.0000   -0.0000   -0.0000    0.0001    0.0000   -0.0001
    0.0000   -0.0000   -0.0001   -0.0001    0.0001    0.0001    0.0000    0.0001    0.0001   -0.0000   -0.0002
    0.0034    0.0017    0.0006    0.0005   -0.0088   -0.0085   -0.0010   -0.0003   -0.0002   -0.0004   -0.0004

  Columns 12 through 16

   -0.0002   -0.0002    0.0000    0.0000    0.0034
   -0.0000   -0.0000   -0.0000   -0.0000    0.0017
   -0.0002   -0.0002    0.0001   -0.0001    0.0006
   -0.0002   -0.0002   -0.0001   -0.0001    0.0005
   -0.0007   -0.0007    0.0000    0.0001   -0.0088
   -0.0004   -0.0004    0.0000    0.0001   -0.0085
    0.0010    0.0010   -0.0000    0.0000   -0.0010
    0.0004    0.0004   -0.0000    0.0001   -0.0003
    0.0005    0.0004    0.0001    0.0001   -0.0002
    0.0005    0.0005    0.0000   -0.0000   -0.0004
    0.0002    0.0002   -0.0001   -0.0002   -0.0004
    0.0026    0.0000    0.0000    0.0000   -0.0002
    0.0000    0.0050   -0.0000    0.0002   -0.0000
    0.0000   -0.0000    0.0018    0.0009    0.0011
    0.0000    0.0002    0.0009    0.0036    0.0011
   -0.0002   -0.0000    0.0011    0.0011    0.0163

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 26 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.277728e+04    0.000e+00    2.542e+03
User objective function returned Inf; trying a new point...
    1      39    1.005180e+04    0.000e+00    4.624e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.461887e+03    0.000e+00    8.520e+02    9.999e-01
User objective function returned Inf; trying a new point...
    3      81    8.344730e+03    0.000e+00    1.242e+03    4.999e-01
User objective function returned Inf; trying a new point...
    4      99    8.255571e+03    0.000e+00    1.547e+03    9.999e-01
User objective function returned Inf; trying a new point...
    5     122    8.086361e+03    0.000e+00    2.989e+02    4.999e-01
User objective function returned Inf; trying a new point...
    6     142    8.077061e+03    0.000e+00    2.139e+02    2.500e-01
User objective function returned Inf; trying a new point...
    7     163    8.025163e+03    0.000e+00    2.049e+02    4.999e-01
User objective function returned Inf; trying a new point...
    8     187    7.986078e+03    0.000e+00    1.773e+02    4.375e-01
User objective function returned Inf; trying a new point...
    9     205    7.959838e+03    0.000e+00    3.078e+02    8.749e-01
User objective function returned Inf; trying a new point...
   10     227    7.946914e+03    0.000e+00    5.696e+02    8.749e-01
User objective function returned Inf; trying a new point...
   11     246    7.929521e+03    0.000e+00    6.020e+02    4.375e-01
User objective function returned Inf; trying a new point...
   12     269    7.885998e+03    0.000e+00    6.481e+02    2.187e-01
User objective function returned Inf; trying a new point...
   13     287    7.857916e+03    0.000e+00    5.317e+02    4.375e-01
User objective function returned Inf; trying a new point...
   14     309    7.814046e+03    0.000e+00    9.429e+01    4.375e-01
User objective function returned Inf; trying a new point...
   15     329    7.810417e+03    0.000e+00    1.230e+02    2.187e-01
User objective function returned Inf; trying a new point...
   16     350    7.789825e+03    0.000e+00    1.017e+02    4.375e-01
User objective function returned Inf; trying a new point...
   17     375    7.788536e+03    0.000e+00    1.953e+02    5.468e-02
User objective function returned Inf; trying a new point...
   18     393    7.787761e+03    0.000e+00    1.934e+02    5.468e-02
User objective function returned Inf; trying a new point...
   19     414    7.784249e+03    0.000e+00    3.961e+01    1.094e-01
User objective function returned Inf; trying a new point...
   20     433    7.783784e+03    0.000e+00    4.748e+01    1.094e-01
User objective function returned Inf; trying a new point...
   21     455    7.781731e+03    0.000e+00    3.902e+01    1.094e-01
User objective function returned Inf; trying a new point...
   22     474    7.781673e+03    0.000e+00    4.240e+01    1.094e-01
   23     495    7.777348e+03    0.000e+00    4.608e+01    2.187e-01
User objective function returned Inf; trying a new point...
   24     519    7.776399e+03    0.000e+00    4.177e+01    1.914e-01
   25     539    7.776331e+03    0.000e+00    4.728e+01    4.785e-02
   26     559    7.773311e+03    0.000e+00    2.624e+01    3.675e-01
User objective function returned Inf; trying a new point...
   27     582    7.772073e+03    0.000e+00    3.061e+01    1.837e-01
User objective function returned Inf; trying a new point...
   28     602    7.771890e+03    0.000e+00    2.565e+01    4.593e-02
   29     623    7.770417e+03    0.000e+00    3.126e+01    9.186e-02
   30     647    7.770314e+03    0.000e+00    1.076e+01    2.297e-02

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     667    7.770309e+03    0.000e+00    8.581e+00    1.148e-02
   32     686    7.770288e+03    0.000e+00    1.030e+01    2.877e-02
   33     707    7.770268e+03    0.000e+00    2.744e+01    5.754e-02
   34     726    7.770258e+03    0.000e+00    2.615e+01    2.877e-02
   35     743    7.770247e+03    0.000e+00    1.898e+01    6.258e-02
   36     760    7.770073e+03    0.000e+00    8.707e+00    2.799e-02
   37     777    7.770016e+03    0.000e+00    1.046e+01    1.242e-02
   38     794    7.769896e+03    0.000e+00    4.554e+00    3.128e-02
   39     811    7.769876e+03    0.000e+00    2.549e+00    1.248e-02
   40     828    7.769874e+03    0.000e+00    4.105e-01    3.955e-03
   41     845    7.769874e+03    0.000e+00    2.321e-01    1.245e-03
   42     862    7.769874e+03    0.000e+00    7.339e-03    3.497e-04
   43     879    7.769874e+03    0.000e+00    4.252e-03    4.311e-05

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',2.346769e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 1.8252 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

   -0.0021
   -0.0031
   -0.0016
   -0.0026
   -0.0022
    0.0012
   -0.0043
    0.0009
    0.0020
    0.0015
   -0.0006
    0.0007
   -0.0001
    0.0002
   -0.0004
    0.0007

Value of the log-likelihood function at convergence: -7769.8742
 
                      AIC                      BIC
              ------------------   -----------------------
                  15571.7484               15642.0992
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 3.3918e-08
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS          0.6176     0.0456    13.5544
A_SnGo         0.1851     0.0382     4.8459
A_AgeLT40      0.6645     0.0540    12.3142
A_ExpLT8       0.8420     0.0547    15.4029
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1          -1.1736     0.1282    -9.1553
Bc_2          -1.3419     0.1296   -10.3546
LV_Load        1.0570     0.0497    21.2650
Mu_12         -0.4686     0.0548    -8.5524
Mu_13         -0.7254     0.0596   -12.1641
Mu_14         -0.6074     0.0561   -10.8269
Mu_22         -0.3518     0.0505    -6.9616
Mu_23         -0.6792     0.0576   -11.7857
Mu_24         -0.6455     0.0590   -10.9447
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -0.9089     0.0368   -24.6938
C_VRC         -0.5836     0.0567   -10.2989
C_LV          -0.4062     0.0892    -4.5520
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    2.1173    1.1173
    1.1173    2.1173

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

    0.6176    0.1851    0.6645    0.8420   -1.1736   -1.3419    1.0570   -0.4686   -0.7254   -0.6074   -0.3518

  Columns 12 through 16

   -0.6792   -0.6455   -0.9089   -0.5836   -0.4062

The covariance matrix for these parameters is:

ihess =

  Columns 1 through 11

    0.0021    0.0001    0.0003    0.0004   -0.0031   -0.0031   -0.0007   -0.0001   -0.0002   -0.0002   -0.0002
    0.0001    0.0015    0.0003    0.0001   -0.0030   -0.0029   -0.0002    0.0000   -0.0001   -0.0000   -0.0000
    0.0003    0.0003    0.0029    0.0005   -0.0012   -0.0012   -0.0008   -0.0003   -0.0003   -0.0002   -0.0002
    0.0004    0.0001    0.0005    0.0030   -0.0007   -0.0006   -0.0011   -0.0004   -0.0004   -0.0003   -0.0003
   -0.0031   -0.0030   -0.0012   -0.0007    0.0164    0.0151   -0.0014   -0.0001   -0.0002   -0.0006   -0.0009
   -0.0031   -0.0029   -0.0012   -0.0006    0.0151    0.0168   -0.0016   -0.0012   -0.0009   -0.0010   -0.0002
   -0.0007   -0.0002   -0.0008   -0.0011   -0.0014   -0.0016    0.0025    0.0010    0.0010    0.0010    0.0010
   -0.0001    0.0000   -0.0003   -0.0004   -0.0001   -0.0012    0.0010    0.0030    0.0001    0.0002    0.0005
   -0.0002   -0.0001   -0.0003   -0.0004   -0.0002   -0.0009    0.0010    0.0001    0.0036    0.0001    0.0005
   -0.0002   -0.0000   -0.0002   -0.0003   -0.0006   -0.0010    0.0010    0.0002    0.0001    0.0031    0.0005
   -0.0002   -0.0000   -0.0002   -0.0003   -0.0009   -0.0002    0.0010    0.0005    0.0005    0.0005    0.0026
   -0.0002   -0.0000   -0.0002   -0.0003   -0.0009   -0.0006    0.0010    0.0005    0.0004    0.0005    0.0001
   -0.0002   -0.0000   -0.0002   -0.0004   -0.0010   -0.0008    0.0010    0.0005    0.0005    0.0005    0.0002
   -0.0001    0.0000   -0.0000    0.0000    0.0001    0.0002   -0.0000   -0.0000    0.0000   -0.0000   -0.0000
   -0.0000   -0.0001   -0.0000    0.0001    0.0002    0.0002    0.0000    0.0000    0.0002   -0.0000   -0.0000
    0.0009    0.0013    0.0003    0.0002   -0.0036   -0.0036   -0.0005   -0.0001   -0.0001   -0.0001   -0.0001

  Columns 12 through 16

   -0.0002   -0.0002   -0.0001   -0.0000    0.0009
   -0.0000   -0.0000    0.0000   -0.0001    0.0013
   -0.0002   -0.0002   -0.0000   -0.0000    0.0003
   -0.0003   -0.0004    0.0000    0.0001    0.0002
   -0.0009   -0.0010    0.0001    0.0002   -0.0036
   -0.0006   -0.0008    0.0002    0.0002   -0.0036
    0.0010    0.0010   -0.0000    0.0000   -0.0005
    0.0005    0.0005   -0.0000    0.0000   -0.0001
    0.0004    0.0005    0.0000    0.0002   -0.0001
    0.0005    0.0005   -0.0000   -0.0000   -0.0001
    0.0001    0.0002   -0.0000   -0.0000   -0.0001
    0.0033    0.0001   -0.0000   -0.0000   -0.0001
    0.0001    0.0035   -0.0000   -0.0000   -0.0002
   -0.0000   -0.0000    0.0014    0.0007    0.0003
   -0.0000   -0.0000    0.0007    0.0032    0.0003
   -0.0001   -0.0002    0.0003    0.0003    0.0080

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 27 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.242860e+04    0.000e+00    2.412e+03
User objective function returned Inf; trying a new point...
    1      39    1.020660e+04    0.000e+00    4.887e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.441955e+03    0.000e+00    4.756e+02    9.999e-01
User objective function returned Inf; trying a new point...
    3      81    8.374475e+03    0.000e+00    1.364e+03    4.999e-01
User objective function returned Inf; trying a new point...
    4      99    8.275351e+03    0.000e+00    1.432e+03    5.000e-01
User objective function returned Inf; trying a new point...
    5     121    8.188743e+03    0.000e+00    2.534e+02    4.999e-01
User objective function returned Inf; trying a new point...
    6     141    8.175168e+03    0.000e+00    2.777e+02    2.500e-01
User objective function returned Inf; trying a new point...
    7     162    8.101495e+03    0.000e+00    5.579e+02    4.999e-01
User objective function returned Inf; trying a new point...
    8     187    8.068581e+03    0.000e+00    3.716e+02    2.187e-01
User objective function returned Inf; trying a new point...
    9     207    8.048024e+03    0.000e+00    4.170e+02    3.828e-01
User objective function returned Inf; trying a new point...
   10     228    8.046350e+03    0.000e+00    2.422e+02    7.655e-01
User objective function returned Inf; trying a new point...
   11     246    8.039424e+03    0.000e+00    4.243e+02    7.655e-01
User objective function returned Inf; trying a new point...
   12     268    8.007170e+03    0.000e+00    2.926e+02    7.655e-01
User objective function returned Inf; trying a new point...
   13     286    7.949341e+03    0.000e+00    1.419e+02    7.655e-01
User objective function returned Inf; trying a new point...
   14     308    7.915955e+03    0.000e+00    5.916e+02    7.655e-01
User objective function returned Inf; trying a new point...
   15     327    7.882491e+03    0.000e+00    4.764e+02    7.655e-01
User objective function returned Inf; trying a new point...
   16     349    7.878147e+03    0.000e+00    8.307e+02    7.655e-01
User objective function returned Inf; trying a new point...
   17     369    7.874674e+03    0.000e+00    7.698e+02    1.914e-01
User objective function returned Inf; trying a new point...
   18     390    7.816407e+03    0.000e+00    4.276e+02    3.828e-01
User objective function returned Inf; trying a new point...
   19     410    7.815150e+03    0.000e+00    3.872e+02    1.914e-01
User objective function returned Inf; trying a new point...
   20     431    7.802821e+03    0.000e+00    1.263e+02    3.828e-01
User objective function returned Inf; trying a new point...
   21     453    7.792658e+03    0.000e+00    1.037e+02    3.828e-01
User objective function returned Inf; trying a new point...
   22     476    7.788613e+03    0.000e+00    1.410e+02    1.914e-01
User objective function returned Inf; trying a new point...
   23     498    7.785061e+03    0.000e+00    7.114e+01    1.914e-01
User objective function returned Inf; trying a new point...
   24     518    7.784192e+03    0.000e+00    2.450e+01    9.569e-02
   25     539    7.783845e+03    0.000e+00    4.742e+01    1.914e-01
   26     560    7.782165e+03    0.000e+00    2.849e+01    1.914e-01
User objective function returned Inf; trying a new point...
   27     579    7.781397e+03    0.000e+00    3.843e+01    1.914e-01
   28     601    7.781371e+03    0.000e+00    2.529e+01    1.914e-01
User objective function returned Inf; trying a new point...
   29     620    7.781286e+03    0.000e+00    4.366e+01    9.569e-02
   30     641    7.780171e+03    0.000e+00    2.950e+01    1.914e-01
User objective function returned Inf; trying a new point...

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     664    7.779492e+03    0.000e+00    4.689e+01    9.569e-02
   32     686    7.779111e+03    0.000e+00    3.727e+01    9.569e-02
User objective function returned Inf; trying a new point...
   33     706    7.778985e+03    0.000e+00    5.027e+01    4.785e-02
   34     729    7.778845e+03    0.000e+00    4.417e+00    2.392e-02
   35     751    7.778823e+03    0.000e+00    6.477e+00    2.392e-02
   36     771    7.778822e+03    0.000e+00    1.027e+01    1.196e-02
   37     788    7.778790e+03    0.000e+00    1.091e+01    1.703e-02
   38     805    7.778785e+03    0.000e+00    7.933e+00    2.100e-02
   39     822    7.778757e+03    0.000e+00    7.804e+00    1.213e-02
   40     839    7.778712e+03    0.000e+00    5.137e+00    1.883e-02
   41     856    7.778690e+03    0.000e+00    1.405e+00    1.314e-02
   42     873    7.778685e+03    0.000e+00    1.921e-01    8.827e-03
   43     890    7.778685e+03    0.000e+00    3.668e-02    2.875e-03
   44     907    7.778685e+03    0.000e+00    7.259e-03    4.512e-04
   45     924    7.778685e+03    0.000e+00    3.175e-03    4.170e-05

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',2.323445e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 1.9052 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

   -0.0018
   -0.0027
   -0.0009
   -0.0010
   -0.0010
   -0.0002
   -0.0032
    0.0006
    0.0013
    0.0008
    0.0002
    0.0005
    0.0001
    0.0002
    0.0004
   -0.0002

Value of the log-likelihood function at convergence: -7778.685
 
                      AIC                      BIC
              ------------------   -----------------------
                  15589.3700               15659.7209
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 6.5726e-09
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS          0.6583     0.0457    14.4122
A_SnGo         0.1856     0.0299     6.2000
A_AgeLT40      0.5235     0.0507    10.3283
A_ExpLT8       0.5856     0.0520    11.2698
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1          -1.2228     0.1231    -9.9366
Bc_2          -1.4240     0.1250   -11.3897
LV_Load        1.1074     0.0500    22.1454
Mu_12         -0.5153     0.0571    -9.0253
Mu_13         -0.5105     0.0543    -9.4031
Mu_14         -0.8014     0.0623   -12.8649
Mu_22         -0.4242     0.0526    -8.0697
Mu_23         -0.5734     0.0546   -10.4997
Mu_24         -0.5943     0.0565   -10.5198
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -1.0001     0.0393   -25.4409
C_VRC         -0.7899     0.0622   -12.6990
C_LV          -0.8811     0.1008    -8.7446
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    2.2262    1.2262
    1.2262    2.2262

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

    0.6583    0.1856    0.5235    0.5856   -1.2228   -1.4240    1.1074   -0.5153   -0.5105   -0.8014   -0.4242

  Columns 12 through 16

   -0.5734   -0.5943   -1.0001   -0.7899   -0.8811

The covariance matrix for these parameters is:

ihess =

  Columns 1 through 11

    0.0021    0.0001    0.0003    0.0002   -0.0033   -0.0033   -0.0007   -0.0001   -0.0003   -0.0002   -0.0001
    0.0001    0.0009    0.0002   -0.0000   -0.0018   -0.0018   -0.0003   -0.0001   -0.0001   -0.0001   -0.0001
    0.0003    0.0002    0.0026    0.0003   -0.0011   -0.0011   -0.0006   -0.0001   -0.0001   -0.0000   -0.0003
    0.0002   -0.0000    0.0003    0.0027   -0.0008   -0.0008   -0.0007   -0.0001   -0.0003   -0.0001   -0.0001
   -0.0033   -0.0018   -0.0011   -0.0008    0.0151    0.0139   -0.0015   -0.0001   -0.0005   -0.0009   -0.0010
   -0.0033   -0.0018   -0.0011   -0.0008    0.0139    0.0156   -0.0018   -0.0012   -0.0011   -0.0014   -0.0002
   -0.0007   -0.0003   -0.0006   -0.0007   -0.0015   -0.0018    0.0025    0.0010    0.0012    0.0011    0.0010
   -0.0001   -0.0001   -0.0001   -0.0001   -0.0001   -0.0012    0.0010    0.0033    0.0002    0.0002    0.0004
   -0.0003   -0.0001   -0.0001   -0.0003   -0.0005   -0.0011    0.0012    0.0002    0.0029    0.0002    0.0005
   -0.0002   -0.0001   -0.0000   -0.0001   -0.0009   -0.0014    0.0011    0.0002    0.0002    0.0039    0.0004
   -0.0001   -0.0001   -0.0003   -0.0001   -0.0010   -0.0002    0.0010    0.0004    0.0005    0.0004    0.0028
   -0.0002   -0.0000   -0.0001   -0.0002   -0.0011   -0.0007    0.0010    0.0004    0.0006    0.0004    0.0001
   -0.0002   -0.0001   -0.0001   -0.0001   -0.0008   -0.0006    0.0009    0.0004    0.0005    0.0005    0.0002
    0.0000    0.0000    0.0001    0.0001   -0.0003   -0.0002    0.0000   -0.0000    0.0000   -0.0000   -0.0000
    0.0000   -0.0000    0.0001    0.0001   -0.0003   -0.0005    0.0001    0.0000   -0.0001   -0.0000   -0.0001
    0.0026    0.0007    0.0004    0.0003   -0.0051   -0.0052   -0.0010   -0.0003   -0.0003   -0.0004   -0.0003

  Columns 12 through 16

   -0.0002   -0.0002    0.0000    0.0000    0.0026
   -0.0000   -0.0001    0.0000   -0.0000    0.0007
   -0.0001   -0.0001    0.0001    0.0001    0.0004
   -0.0002   -0.0001    0.0001    0.0001    0.0003
   -0.0011   -0.0008   -0.0003   -0.0003   -0.0051
   -0.0007   -0.0006   -0.0002   -0.0005   -0.0052
    0.0010    0.0009    0.0000    0.0001   -0.0010
    0.0004    0.0004   -0.0000    0.0000   -0.0003
    0.0006    0.0005    0.0000   -0.0001   -0.0003
    0.0004    0.0005   -0.0000   -0.0000   -0.0004
    0.0001    0.0002   -0.0000   -0.0001   -0.0003
    0.0030    0.0000   -0.0000    0.0000   -0.0004
    0.0000    0.0032    0.0000    0.0000   -0.0004
   -0.0000    0.0000    0.0015    0.0009    0.0007
    0.0000    0.0000    0.0009    0.0039    0.0007
   -0.0004   -0.0004    0.0007    0.0007    0.0102

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 28 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.213227e+04    0.000e+00    2.158e+03
User objective function returned Inf; trying a new point...
    1      39    1.049185e+04    0.000e+00    5.012e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.586424e+03    0.000e+00    3.453e+02    9.999e-01
User objective function returned Inf; trying a new point...
    3      80    8.363180e+03    0.000e+00    1.560e+03    9.999e-01
User objective function returned Inf; trying a new point...
    4      99    8.214942e+03    0.000e+00    1.692e+03    9.999e-01
User objective function returned Inf; trying a new point...
    5     122    8.028604e+03    0.000e+00    5.587e+02    4.999e-01
User objective function returned Inf; trying a new point...
    6     142    8.001397e+03    0.000e+00    2.886e+02    2.500e-01
User objective function returned Inf; trying a new point...
    7     163    7.941448e+03    0.000e+00    1.921e+02    4.999e-01
User objective function returned Inf; trying a new point...
    8     181    7.899018e+03    0.000e+00    2.724e+02    9.999e-01
User objective function returned Inf; trying a new point...
    9     204    7.849464e+03    0.000e+00    3.044e+02    5.000e-01
User objective function returned Inf; trying a new point...
   10     224    7.844265e+03    0.000e+00    2.532e+02    2.500e-01
User objective function returned Inf; trying a new point...
   11     246    7.811292e+03    0.000e+00    1.168e+02    2.500e-01
User objective function returned Inf; trying a new point...
   12     265    7.803028e+03    0.000e+00    1.491e+02    2.500e-01
User objective function returned Inf; trying a new point...
   13     286    7.791032e+03    0.000e+00    1.937e+02    4.999e-01
User objective function returned Inf; trying a new point...
   14     309    7.785409e+03    0.000e+00    1.076e+02    2.500e-01
User objective function returned Inf; trying a new point...
   15     329    7.783724e+03    0.000e+00    7.099e+01    1.250e-01
User objective function returned Inf; trying a new point...
   16     351    7.781201e+03    0.000e+00    4.375e+01    1.250e-01
   17     374    7.781060e+03    0.000e+00    1.858e+01    6.249e-02
   18     392    7.780721e+03    0.000e+00    2.779e+01    6.249e-02
User objective function returned Inf; trying a new point...
   19     413    7.779819e+03    0.000e+00    1.998e+01    1.250e-01
User objective function returned Inf; trying a new point...
   20     431    7.763816e+03    0.000e+00    1.133e+02    8.749e-01
User objective function returned Inf; trying a new point...
   21     452    7.700200e+03    0.000e+00    2.081e+02    1.750e+00
User objective function returned Inf; trying a new point...
   22     477    7.676397e+03    0.000e+00    2.167e+02    7.655e-01
User objective function returned Inf; trying a new point...
   23     501    7.660885e+03    0.000e+00    8.621e+02    1.914e-01
User objective function returned Inf; trying a new point...
   24     520    7.659468e+03    0.000e+00    8.488e+02    1.914e-01
User objective function returned Inf; trying a new point...
   25     541    7.609791e+03    0.000e+00    4.164e+02    3.828e-01
User objective function returned Inf; trying a new point...
   26     560    7.607910e+03    0.000e+00    5.865e+02    3.828e-01
User objective function returned Inf; trying a new point...
   27     582    7.566367e+03    0.000e+00    1.911e+02    3.828e-01
User objective function returned Inf; trying a new point...
   28     606    7.551792e+03    0.000e+00    4.070e+02    3.349e-01
User objective function returned Inf; trying a new point...
   29     626    7.551399e+03    0.000e+00    4.506e+02    1.675e-01
User objective function returned Inf; trying a new point...
   30     647    7.543276e+03    0.000e+00    2.893e+02    3.349e-01
User objective function returned Inf; trying a new point...

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     669    7.541833e+03    0.000e+00    4.447e+01    3.349e-01
User objective function returned Inf; trying a new point...
   32     688    7.541653e+03    0.000e+00    8.812e+01    1.675e-01
   33     710    7.535664e+03    0.000e+00    1.159e+02    1.675e-01
   34     735    7.535472e+03    0.000e+00    1.712e+02    7.327e-02
   35     754    7.535451e+03    0.000e+00    1.401e+02    3.663e-02
   36     775    7.535002e+03    0.000e+00    9.800e+01    7.327e-02
   37     795    7.534998e+03    0.000e+00    1.097e+02    3.663e-02
   38     817    7.534645e+03    0.000e+00    1.854e+01    3.663e-02
   39     840    7.534602e+03    0.000e+00    1.755e+01    1.832e-02
   40     859    7.534600e+03    0.000e+00    2.216e+01    1.832e-02
   41     876    7.534544e+03    0.000e+00    2.207e+01    9.600e-03
   42     893    7.534392e+03    0.000e+00    2.086e+01    1.835e-02
   43     910    7.534026e+03    0.000e+00    1.691e+01    3.645e-02
   44     927    7.533317e+03    0.000e+00    2.815e+01    7.624e-02
   45     944    7.532561e+03    0.000e+00    7.753e+01    9.590e-02
   46     961    7.531815e+03    0.000e+00    3.930e+01    8.443e-02
   47     978    7.531576e+03    0.000e+00    1.952e+00    3.666e-02
   48     995    7.531564e+03    0.000e+00    1.202e+01    1.819e-02
   49    1012    7.531561e+03    0.000e+00    1.524e+00    6.646e-03
   50    1029    7.531560e+03    0.000e+00    1.432e+00    2.327e-03
   51    1046    7.531560e+03    0.000e+00    7.289e-01    1.803e-03
   52    1063    7.531560e+03    0.000e+00    1.680e-01    4.757e-04
   53    1080    7.531560e+03    0.000e+00    3.462e-03    1.910e-04

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',5.796003e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 2.2234 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

   -0.0035
   -0.0003
   -0.0012
    0.0009
   -0.0015
    0.0019
    0.0004
   -0.0005
    0.0004
   -0.0006
    0.0001
    0.0006
    0.0018
   -0.0005
   -0.0001
    0.0016

Value of the log-likelihood function at convergence: -7531.5597
 
                      AIC                      BIC
              ------------------   -----------------------
                  15095.1193               15165.4702
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 8.2335e-08
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS          0.8383     0.0609    13.7712
A_SnGo         0.4466     0.0420    10.6253
A_AgeLT40      0.8700     0.0657    13.2322
A_ExpLT8       1.5323     0.0794    19.3009
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1          -2.0129     0.1211   -16.6265
Bc_2          -2.1661     0.1234   -17.5538
LV_Load        0.8343     0.0454    18.3604
Mu_12         -0.6644     0.0597   -11.1350
Mu_13         -0.5691     0.0563   -10.1069
Mu_14         -0.4254     0.0522    -8.1484
Mu_22         -0.3854     0.0491    -7.8549
Mu_23         -0.7124     0.0580   -12.2894
Mu_24         -0.6471     0.0575   -11.2475
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -0.8969     0.0368   -24.3891
C_VRC         -0.7333     0.0600   -12.2290
C_LV          -0.6395     0.0685    -9.3311
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    1.6960    0.6960
    0.6960    1.6960

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

    0.8383    0.4466    0.8700    1.5323   -2.0129   -2.1661    0.8343   -0.6644   -0.5691   -0.4254   -0.3854

  Columns 12 through 16

   -0.7124   -0.6471   -0.8969   -0.7333   -0.6395

The covariance matrix for these parameters is:

ihess =

  Columns 1 through 11

    0.0037    0.0007    0.0011    0.0017   -0.0034   -0.0035   -0.0013   -0.0005   -0.0004   -0.0004   -0.0005
    0.0007    0.0018    0.0006    0.0008   -0.0021   -0.0020   -0.0008   -0.0003   -0.0003   -0.0003   -0.0003
    0.0011    0.0006    0.0043    0.0020   -0.0003   -0.0003   -0.0014   -0.0005   -0.0004   -0.0005   -0.0004
    0.0017    0.0008    0.0020    0.0063    0.0007    0.0009   -0.0025   -0.0008   -0.0009   -0.0009   -0.0007
   -0.0034   -0.0021   -0.0003    0.0007    0.0147    0.0137   -0.0017   -0.0002   -0.0005   -0.0008   -0.0010
   -0.0035   -0.0020   -0.0003    0.0009    0.0137    0.0152   -0.0019   -0.0013   -0.0011   -0.0012   -0.0003
   -0.0013   -0.0008   -0.0014   -0.0025   -0.0017   -0.0019    0.0021    0.0009    0.0009    0.0009    0.0008
   -0.0005   -0.0003   -0.0005   -0.0008   -0.0002   -0.0013    0.0009    0.0036   -0.0000    0.0001    0.0003
   -0.0004   -0.0003   -0.0004   -0.0009   -0.0005   -0.0011    0.0009   -0.0000    0.0032    0.0003    0.0002
   -0.0004   -0.0003   -0.0005   -0.0009   -0.0008   -0.0012    0.0009    0.0001    0.0003    0.0027    0.0003
   -0.0005   -0.0003   -0.0004   -0.0007   -0.0010   -0.0003    0.0008    0.0003    0.0002    0.0003    0.0024
   -0.0005   -0.0003   -0.0004   -0.0008   -0.0011   -0.0007    0.0009    0.0003    0.0004    0.0003    0.0000
   -0.0005   -0.0002   -0.0005   -0.0007   -0.0011   -0.0008    0.0008    0.0003    0.0004    0.0004    0.0002
   -0.0000    0.0000   -0.0000   -0.0001   -0.0000   -0.0001    0.0000    0.0000    0.0001    0.0000   -0.0000
   -0.0000   -0.0001    0.0001   -0.0000    0.0000   -0.0000    0.0000   -0.0001    0.0002    0.0002   -0.0001
    0.0022    0.0011    0.0010    0.0014   -0.0028   -0.0028   -0.0010   -0.0002   -0.0004   -0.0004   -0.0003

  Columns 12 through 16

   -0.0005   -0.0005   -0.0000   -0.0000    0.0022
   -0.0003   -0.0002    0.0000   -0.0001    0.0011
   -0.0004   -0.0005   -0.0000    0.0001    0.0010
   -0.0008   -0.0007   -0.0001   -0.0000    0.0014
   -0.0011   -0.0011   -0.0000    0.0000   -0.0028
   -0.0007   -0.0008   -0.0001   -0.0000   -0.0028
    0.0009    0.0008    0.0000    0.0000   -0.0010
    0.0003    0.0003    0.0000   -0.0001   -0.0002
    0.0004    0.0004    0.0001    0.0002   -0.0004
    0.0003    0.0004    0.0000    0.0002   -0.0004
    0.0000    0.0002   -0.0000   -0.0001   -0.0003
    0.0034    0.0000   -0.0000   -0.0000   -0.0004
    0.0000    0.0033    0.0000    0.0001   -0.0004
   -0.0000    0.0000    0.0014    0.0008    0.0004
   -0.0000    0.0001    0.0008    0.0036    0.0005
   -0.0004   -0.0004    0.0004    0.0005    0.0047

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 29 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.368893e+04    0.000e+00    3.153e+03
User objective function returned Inf; trying a new point...
    1      39    9.536223e+03    0.000e+00    4.014e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.571847e+03    0.000e+00    2.126e+03    9.999e-01
User objective function returned Inf; trying a new point...
    3      79    8.508399e+03    0.000e+00    4.864e+02    2.000e+00
User objective function returned Inf; trying a new point...
    4      99    8.481353e+03    0.000e+00    9.737e+02    4.999e-01
User objective function returned Inf; trying a new point...
    5     120    8.187944e+03    0.000e+00    3.170e+02    9.999e-01
User objective function returned Inf; trying a new point...
    6     138    8.084333e+03    0.000e+00    4.615e+02    2.000e+00
User objective function returned Inf; trying a new point...
    7     162    8.059923e+03    0.000e+00    8.086e+02    4.999e-01
User objective function returned Inf; trying a new point...
    8     181    8.046245e+03    0.000e+00    7.330e+02    2.500e-01
User objective function returned Inf; trying a new point...
    9     202    8.023122e+03    0.000e+00    4.789e+02    4.999e-01
User objective function returned Inf; trying a new point...
   10     222    8.019808e+03    0.000e+00    5.970e+02    1.250e-01
User objective function returned Inf; trying a new point...
   11     243    7.963490e+03    0.000e+00    1.157e+02    2.500e-01
User objective function returned Inf; trying a new point...
   12     262    7.961298e+03    0.000e+00    1.028e+02    2.500e-01
User objective function returned Inf; trying a new point...
   13     283    7.950598e+03    0.000e+00    1.305e+02    4.999e-01
User objective function returned Inf; trying a new point...
   14     303    7.946572e+03    0.000e+00    1.700e+02    2.500e-01
User objective function returned Inf; trying a new point...
   15     325    7.933737e+03    0.000e+00    1.400e+02    2.500e-01
User objective function returned Inf; trying a new point...
   16     349    7.930301e+03    0.000e+00    1.516e+02    2.187e-01
User objective function returned Inf; trying a new point...
   17     368    7.929626e+03    0.000e+00    1.388e+02    2.187e-01
User objective function returned Inf; trying a new point...
   18     389    7.922693e+03    0.000e+00    9.537e+01    4.375e-01
User objective function returned Inf; trying a new point...
   19     409    7.922419e+03    0.000e+00    9.562e+01    2.187e-01
User objective function returned Inf; trying a new point...
   20     430    7.916168e+03    0.000e+00    2.288e+02    4.375e-01
User objective function returned Inf; trying a new point...
   21     448    7.912907e+03    0.000e+00    2.416e+02    4.375e-01
User objective function returned Inf; trying a new point...
   22     471    7.899741e+03    0.000e+00    9.596e+01    2.187e-01
User objective function returned Inf; trying a new point...
   23     491    7.899342e+03    0.000e+00    9.815e+01    1.094e-01
   24     512    7.893974e+03    0.000e+00    8.152e+01    2.187e-01
User objective function returned Inf; trying a new point...
   25     532    7.893528e+03    0.000e+00    8.633e+01    1.094e-01
   26     553    7.878142e+03    0.000e+00    8.236e+01    2.187e-01
User objective function returned Inf; trying a new point...
   27     576    7.844617e+03    0.000e+00    1.513e+02    3.828e-01
User objective function returned Inf; trying a new point...
   28     599    7.822133e+03    0.000e+00    3.679e+02    6.699e-01
User objective function returned Inf; trying a new point...
   29     621    7.811512e+03    0.000e+00    3.798e+02    6.699e-01
User objective function returned Inf; trying a new point...
   30     643    7.789187e+03    0.000e+00    4.325e+01    3.349e-01

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     666    7.786430e+03    0.000e+00    1.622e+02    5.861e-01
User objective function returned Inf; trying a new point...
   32     684    7.776654e+03    0.000e+00    2.022e+02    1.172e+00
User objective function returned Inf; trying a new point...
   33     707    7.774708e+03    0.000e+00    4.751e+02    5.861e-01
User objective function returned Inf; trying a new point...
   34     726    7.766467e+03    0.000e+00    5.154e+02    2.931e-01
   35     745    7.739738e+03    0.000e+00    3.743e+02    1.476e+00
   36     763    7.711986e+03    0.000e+00    2.788e+02    7.501e-01
   37     782    7.692519e+03    0.000e+00    3.061e+02    9.001e-01
   38     799    7.667967e+03    0.000e+00    5.016e+01    5.271e-01
   39     816    7.663301e+03    0.000e+00    1.179e+02    2.850e-01
   40     833    7.661715e+03    0.000e+00    2.349e+01    3.818e-01
   41     850    7.660916e+03    0.000e+00    1.830e+01    1.383e-01
   42     867    7.660824e+03    0.000e+00    3.406e+01    3.159e-02
   43     884    7.660764e+03    0.000e+00    2.632e+01    1.367e-02
   44     901    7.660596e+03    0.000e+00    1.287e+01    2.091e-02
   45     918    7.660298e+03    0.000e+00    1.094e+01    3.800e-02
   46     935    7.660143e+03    0.000e+00    7.100e+00    3.484e-02
   47     952    7.660112e+03    0.000e+00    4.849e+00    1.962e-02
   48     969    7.660107e+03    0.000e+00    1.297e+00    4.983e-03
   49     986    7.660107e+03    0.000e+00    1.973e-01    2.239e-03
   50    1003    7.660107e+03    0.000e+00    1.033e-01    6.438e-04
   51    1020    7.660107e+03    0.000e+00    3.777e-02    2.354e-04
   52    1037    7.660107e+03    0.000e+00    2.060e-03    7.141e-05

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',3.847546e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 2.108 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

   -0.0005
   -0.0014
   -0.0001
   -0.0007
    0.0005
    0.0005
   -0.0021
    0.0009
    0.0011
   -0.0004
         0
   -0.0001
   -0.0010
    0.0004
   -0.0001
    0.0001

Value of the log-likelihood function at convergence: -7660.1067
 
                      AIC                      BIC
              ------------------   -----------------------
                  15352.2135               15422.5644
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 2.2434e-08
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS         -0.5318     0.0477   -11.1444
A_SnGo        -0.3292     0.0384    -8.5836
A_AgeLT40     -0.9445     0.0577   -16.3559
A_ExpLT8      -0.3055     0.0495    -6.1729
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1          -0.8296     0.1376    -6.0303
Bc_2          -1.0363     0.1362    -7.6062
LV_Load       -1.0687     0.0511   -20.9088
Mu_12         -0.2765     0.0545    -5.0711
Mu_13         -0.7932     0.0579   -13.7029
Mu_14         -0.4597     0.0532    -8.6430
Mu_22         -0.3458     0.0530    -6.5202
Mu_23         -0.6246     0.0591   -10.5681
Mu_24         -0.8519     0.0658   -12.9501
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -0.8567     0.0352   -24.3491
C_VRC         -0.6605     0.0568   -11.6377
C_LV           0.5408     0.0912     5.9328
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    2.1422    1.1422
    1.1422    2.1422

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

   -0.5318   -0.3292   -0.9445   -0.3055   -0.8296   -1.0363   -1.0687   -0.2765   -0.7932   -0.4597   -0.3458

  Columns 12 through 16

   -0.6246   -0.8519   -0.8567   -0.6605    0.5408

The covariance matrix for these parameters is:

ihess =

  Columns 1 through 11

    0.0023    0.0003    0.0005    0.0001    0.0042    0.0041   -0.0007    0.0003    0.0003    0.0002    0.0003
    0.0003    0.0015    0.0006    0.0001    0.0031    0.0030   -0.0006    0.0002    0.0001    0.0002    0.0003
    0.0005    0.0006    0.0033    0.0002    0.0019    0.0018   -0.0012    0.0003    0.0005    0.0005    0.0003
    0.0001    0.0001    0.0002    0.0024    0.0013    0.0013   -0.0004    0.0002    0.0002    0.0002    0.0003
    0.0042    0.0031    0.0019    0.0013    0.0189    0.0172    0.0004    0.0009    0.0001    0.0001   -0.0002
    0.0041    0.0030    0.0018    0.0013    0.0172    0.0186    0.0006   -0.0003   -0.0005   -0.0004    0.0009
   -0.0007   -0.0006   -0.0012   -0.0004    0.0004    0.0006    0.0026   -0.0011   -0.0010   -0.0011   -0.0011
    0.0003    0.0002    0.0003    0.0002    0.0009   -0.0003   -0.0011    0.0030    0.0000    0.0003    0.0004
    0.0003    0.0001    0.0005    0.0002    0.0001   -0.0005   -0.0010    0.0000    0.0034    0.0001    0.0004
    0.0002    0.0002    0.0005    0.0002    0.0001   -0.0004   -0.0011    0.0003    0.0001    0.0028    0.0004
    0.0003    0.0003    0.0003    0.0003   -0.0002    0.0009   -0.0011    0.0004    0.0004    0.0004    0.0028
    0.0002    0.0002    0.0003    0.0001   -0.0007   -0.0001   -0.0011    0.0004    0.0003    0.0004    0.0001
    0.0001    0.0002    0.0005    0.0001   -0.0008   -0.0005   -0.0011    0.0005    0.0004    0.0006    0.0002
   -0.0000   -0.0000   -0.0000    0.0000    0.0000   -0.0001    0.0000    0.0000    0.0000    0.0001    0.0000
   -0.0000    0.0000    0.0000    0.0001    0.0000    0.0000    0.0000    0.0001   -0.0000    0.0001    0.0000
    0.0014    0.0015    0.0008    0.0001    0.0048    0.0046   -0.0009    0.0004    0.0003    0.0001    0.0004

  Columns 12 through 16

    0.0002    0.0001   -0.0000   -0.0000    0.0014
    0.0002    0.0002   -0.0000    0.0000    0.0015
    0.0003    0.0005   -0.0000    0.0000    0.0008
    0.0001    0.0001    0.0000    0.0001    0.0001
   -0.0007   -0.0008    0.0000    0.0000    0.0048
   -0.0001   -0.0005   -0.0001    0.0000    0.0046
   -0.0011   -0.0011    0.0000    0.0000   -0.0009
    0.0004    0.0005    0.0000    0.0001    0.0004
    0.0003    0.0004    0.0000   -0.0000    0.0003
    0.0004    0.0006    0.0001    0.0001    0.0001
    0.0001    0.0002    0.0000    0.0000    0.0004
    0.0035    0.0000   -0.0000    0.0000    0.0002
    0.0000    0.0043    0.0000    0.0000   -0.0002
   -0.0000    0.0000    0.0012    0.0007   -0.0003
    0.0000    0.0000    0.0007    0.0032   -0.0005
    0.0002   -0.0002   -0.0003   -0.0005    0.0083

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 30 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.210295e+04    0.000e+00    2.200e+03
User objective function returned Inf; trying a new point...
    1      39    1.023096e+04    0.000e+00    4.935e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.392442e+03    0.000e+00    2.697e+02    9.999e-01
User objective function returned Inf; trying a new point...
    3      80    8.364494e+03    0.000e+00    1.565e+03    9.999e-01
User objective function returned Inf; trying a new point...
    4      98    8.283304e+03    0.000e+00    1.924e+03    9.999e-01
User objective function returned Inf; trying a new point...
    5     120    8.224287e+03    0.000e+00    5.307e+02    9.999e-01
User objective function returned Inf; trying a new point...
    6     139    8.169193e+03    0.000e+00    5.953e+02    5.000e-01
User objective function returned Inf; trying a new point...
    7     160    7.983960e+03    0.000e+00    4.129e+02    9.999e-01
User objective function returned Inf; trying a new point...
    8     183    7.977950e+03    0.000e+00    5.300e+02    4.999e-01
User objective function returned Inf; trying a new point...
    9     201    7.977186e+03    0.000e+00    3.091e+02    5.000e-01
User objective function returned Inf; trying a new point...
   10     223    7.955886e+03    0.000e+00    3.964e+02    5.000e-01
User objective function returned Inf; trying a new point...
   11     241    7.951465e+03    0.000e+00    1.342e+02    5.000e-01
User objective function returned Inf; trying a new point...
   12     263    7.917997e+03    0.000e+00    3.306e+02    5.000e-01
User objective function returned Inf; trying a new point...
   13     282    7.907064e+03    0.000e+00    2.751e+02    4.999e-01
User objective function returned Inf; trying a new point...
   14     304    7.900235e+03    0.000e+00    8.681e+01    4.999e-01
User objective function returned Inf; trying a new point...
   15     323    7.895476e+03    0.000e+00    9.144e+01    2.500e-01
User objective function returned Inf; trying a new point...
   16     345    7.883908e+03    0.000e+00    1.893e+02    2.500e-01
User objective function returned Inf; trying a new point...
   17     363    7.874641e+03    0.000e+00    2.929e+02    4.999e-01
User objective function returned Inf; trying a new point...
   18     384    7.871003e+03    0.000e+00    1.209e+02    9.999e-01
User objective function returned Inf; trying a new point...
   19     403    7.863461e+03    0.000e+00    2.210e+02    4.999e-01
User objective function returned Inf; trying a new point...
   20     425    7.860711e+03    0.000e+00    3.315e+02    4.999e-01
   21     445    7.860237e+03    0.000e+00    2.812e+02    1.250e-01
User objective function returned Inf; trying a new point...
   22     466    7.852033e+03    0.000e+00    3.174e+02    2.500e-01
User objective function returned Inf; trying a new point...
   23     486    7.851013e+03    0.000e+00    3.059e+02    1.250e-01
User objective function returned Inf; trying a new point...
   24     507    7.840872e+03    0.000e+00    8.360e+01    2.500e-01
User objective function returned Inf; trying a new point...
   25     530    7.839710e+03    0.000e+00    6.578e+01    1.250e-01
   26     548    7.838374e+03    0.000e+00    4.827e+01    2.500e-01
User objective function returned Inf; trying a new point...
   27     570    7.838265e+03    0.000e+00    1.911e+02    2.500e-01
User objective function returned Inf; trying a new point...
   28     590    7.838124e+03    0.000e+00    1.770e+02    6.249e-02
   29     611    7.835737e+03    0.000e+00    9.475e+01    1.250e-01
User objective function returned Inf; trying a new point...
   30     629    7.835467e+03    0.000e+00    1.268e+02    2.500e-01

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     650    7.831752e+03    0.000e+00    1.730e+02    4.999e-01
User objective function returned Inf; trying a new point...
   32     674    7.830504e+03    0.000e+00    1.576e+02    1.250e-01
   33     691    7.822857e+03    0.000e+00    1.071e+02    1.436e+00
User objective function returned Inf; trying a new point...
   34     717    7.821352e+03    0.000e+00    1.768e+02    8.977e-02
User objective function returned Inf; trying a new point...
   35     735    7.820615e+03    0.000e+00    1.850e+02    1.795e-01
   36     752    7.813733e+03    0.000e+00    8.031e+01    1.711e+00
   37     769    7.807399e+03    0.000e+00    1.636e+02    2.834e+00
   38     787    7.803606e+03    0.000e+00    5.177e+02    2.607e+00
   39     804    7.798795e+03    0.000e+00    6.344e+02    4.481e+00
   40     821    7.796436e+03    0.000e+00    1.095e+02    2.156e-01
   41     838    7.794006e+03    0.000e+00    8.643e+01    3.060e+00
   42     856    7.793885e+03    0.000e+00    9.111e+02    4.263e+00
   43     874    7.792916e+03    0.000e+00    1.336e+03    3.765e+00
   44     891    7.792881e+03    0.000e+00    8.140e+02    1.290e+00
   45     908    7.790656e+03    0.000e+00    1.241e+02    1.413e+00
   46     925    7.790058e+03    0.000e+00    3.762e+02    2.888e+00
   47     942    7.789289e+03    0.000e+00    4.818e+02    3.058e+00
   48     959    7.787592e+03    0.000e+00    2.832e+02    7.657e+00
   49     976    7.786751e+03    0.000e+00    2.429e+02    6.652e+00
   50     995    7.786404e+03    0.000e+00    6.759e+02    6.699e+00
   51    1012    7.785991e+03    0.000e+00    8.362e+02    4.588e+00
   52    1029    7.785313e+03    0.000e+00    1.210e+02    4.256e+00
   53    1047    7.785035e+03    0.000e+00    9.327e+02    8.451e+00
   54    1064    7.784661e+03    0.000e+00    4.091e+02    3.191e+00
   55    1081    7.784219e+03    0.000e+00    6.650e+02    1.295e+01
   56    1098    7.783984e+03    0.000e+00    9.939e+01    3.901e+00
   57    1115    7.783844e+03    0.000e+00    1.729e+02    3.914e+00
   58    1132    7.783891e+03    0.000e+00    9.651e+01    1.756e+00
   59    1149    7.783884e+03    0.000e+00    1.968e+01    1.569e-01
   60    1166    7.783885e+03    0.000e+00    1.265e+00    1.250e-02

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   61    1183    7.783885e+03    0.000e+00    2.527e-01    4.701e-03

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',5.650149e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 2.4336 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

   -0.1132
    0.2527
   -0.0027
   -0.0033
   -0.0027
   -0.0010
   -0.0031
    0.0009
   -0.0001
    0.0010
    0.0012
    0.0004
    0.0013
   -0.0004
   -0.0003
   -0.0311

Value of the log-likelihood function at convergence: -7783.8849
 
                      AIC                      BIC
              ------------------   -----------------------
                  15599.7698               15670.1207
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 1.1471
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS         -0.0076     0.0028    -2.7379
A_SnGo        -0.0030     0.0011    -2.6046
A_AgeLT40      0.5768     0.0497    11.6125
A_ExpLT8       0.4261     0.0478     8.9172
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1           0.4141     0.0581     7.1305
Bc_2           0.1738     0.0572     3.0391
LV_Load        1.1919     0.0525    22.7092
Mu_12         -0.4433     0.0531    -8.3459
Mu_13         -0.6689     0.0581   -11.5072
Mu_14         -0.7149     0.0605   -11.8203
Mu_22         -0.3434     0.0492    -6.9855
Mu_23         -0.6849     0.0597   -11.4780
Mu_24         -0.6227     0.0600   -10.3835
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -1.0311     0.0400   -25.7608
C_VRC         -1.0197     0.0649   -15.7165
C_LV          96.8397    34.4014     2.8150
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    2.4207    1.4207
    1.4207    2.4207

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

   -0.0076   -0.0030    0.5768    0.4261    0.4141    0.1738    1.1919   -0.4433   -0.6689   -0.7149   -0.3434

  Columns 12 through 16

   -0.6849   -0.6227   -1.0311   -1.0197   96.8397

The covariance matrix for these parameters is:

ihess =

   1.0e+03 *

  Columns 1 through 11

    0.0000    0.0000    0.0000    0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000    0.0000    0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000    0.0000    0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000
    0.0000    0.0000    0.0000    0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000
   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000   -0.0000   -0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000   -0.0000    0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000   -0.0000    0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000    0.0000    0.0000    0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000   -0.0000
    0.0000    0.0000   -0.0000   -0.0000    0.0000   -0.0000    0.0000    0.0000   -0.0000   -0.0000    0.0000
    0.0001    0.0000    0.0000    0.0000   -0.0004   -0.0004    0.0002    0.0001    0.0001    0.0001    0.0001

  Columns 12 through 16

    0.0000    0.0000    0.0000    0.0000    0.0001
    0.0000    0.0000    0.0000    0.0000    0.0000
   -0.0000   -0.0000    0.0000   -0.0000    0.0000
   -0.0000   -0.0000    0.0000   -0.0000    0.0000
    0.0000    0.0000    0.0000    0.0000   -0.0004
    0.0000    0.0000   -0.0000   -0.0000   -0.0004
    0.0000    0.0000    0.0000    0.0000    0.0002
    0.0000    0.0000    0.0000    0.0000    0.0001
    0.0000    0.0000    0.0000   -0.0000    0.0001
    0.0000    0.0000    0.0000   -0.0000    0.0001
    0.0000    0.0000   -0.0000    0.0000    0.0001
    0.0000    0.0000   -0.0000    0.0000    0.0001
    0.0000    0.0000    0.0000   -0.0000    0.0001
   -0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000   -0.0000    0.0000    0.0000    0.0001
    0.0001    0.0001    0.0000    0.0001    1.1835

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 31 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.172273e+04    0.000e+00    1.987e+03
User objective function returned Inf; trying a new point...
    1      39    1.045722e+04    0.000e+00    5.194e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.460406e+03    0.000e+00    4.449e+02    9.999e-01
User objective function returned Inf; trying a new point...
    3      79    8.330485e+03    0.000e+00    1.427e+03    2.000e+00
User objective function returned Inf; trying a new point...
    4      99    8.266056e+03    0.000e+00    9.616e+02    4.999e-01
User objective function returned Inf; trying a new point...
    5     120    8.015916e+03    0.000e+00    4.764e+02    9.999e-01
User objective function returned Inf; trying a new point...
    6     140    8.010533e+03    0.000e+00    2.188e+02    4.999e-01
User objective function returned Inf; trying a new point...
    7     162    7.960549e+03    0.000e+00    4.000e+02    4.999e-01
User objective function returned Inf; trying a new point...
    8     182    7.950263e+03    0.000e+00    5.911e+02    2.500e-01
User objective function returned Inf; trying a new point...
    9     203    7.934333e+03    0.000e+00    5.259e+02    5.000e-01
User objective function returned Inf; trying a new point...
   10     223    7.933080e+03    0.000e+00    3.859e+02    2.500e-01
User objective function returned Inf; trying a new point...
   11     244    7.916478e+03    0.000e+00    2.726e+02    4.999e-01
User objective function returned Inf; trying a new point...
   12     263    7.902869e+03    0.000e+00    1.310e+02    4.999e-01
User objective function returned Inf; trying a new point...
   13     285    7.867308e+03    0.000e+00    3.311e+02    4.999e-01
User objective function returned Inf; trying a new point...
   14     309    7.860008e+03    0.000e+00    8.208e+01    4.375e-01
User objective function returned Inf; trying a new point...
   15     329    7.856256e+03    0.000e+00    9.421e+01    2.187e-01
User objective function returned Inf; trying a new point...
   16     350    7.852500e+03    0.000e+00    3.101e+02    4.375e-01
User objective function returned Inf; trying a new point...
   17     369    7.852402e+03    0.000e+00    2.713e+02    2.187e-01
User objective function returned Inf; trying a new point...
   18     390    7.836241e+03    0.000e+00    8.094e+01    4.375e-01
User objective function returned Inf; trying a new point...
   19     410    7.836232e+03    0.000e+00    1.033e+02    2.187e-01
User objective function returned Inf; trying a new point...
   20     433    7.831437e+03    0.000e+00    3.348e+01    1.094e-01
User objective function returned Inf; trying a new point...
   21     451    7.831363e+03    0.000e+00    4.180e+01    2.187e-01
User objective function returned Inf; trying a new point...
   22     473    7.828859e+03    0.000e+00    1.446e+02    2.187e-01
User objective function returned Inf; trying a new point...
   23     493    7.828400e+03    0.000e+00    1.516e+02    1.094e-01
User objective function returned Inf; trying a new point...
   24     514    7.827549e+03    0.000e+00    7.004e+01    2.187e-01
User objective function returned Inf; trying a new point...
   25     532    7.825805e+03    0.000e+00    6.419e+01    2.187e-01
User objective function returned Inf; trying a new point...
   26     554    7.824917e+03    0.000e+00    1.143e+02    2.187e-01
User objective function returned Inf; trying a new point...
   27     572    7.823937e+03    0.000e+00    1.374e+02    2.187e-01
   28     589    7.815868e+03    0.000e+00    2.428e+02    1.636e+00
User objective function returned Inf; trying a new point...
   29     616    7.815677e+03    0.000e+00    1.736e+02    5.113e-02
User objective function returned Inf; trying a new point...
   30     634    7.815277e+03    0.000e+00    1.676e+02    5.113e-02

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     651    7.811229e+03    0.000e+00    2.356e+02    1.741e+00
   32     670    7.809483e+03    0.000e+00    3.019e+02    3.001e-01
   33     687    7.806394e+03    0.000e+00    1.160e+02    1.829e-01
   34     704    7.803460e+03    0.000e+00    6.321e+01    1.204e+00
   35     721    7.799816e+03    0.000e+00    4.965e+02    3.703e+00
   36     738    7.798307e+03    0.000e+00    4.359e+02    2.516e+00
   37     756    7.796716e+03    0.000e+00    4.004e+02    8.150e-01
   38     774    7.795305e+03    0.000e+00    4.238e+02    1.862e+00
   39     791    7.794345e+03    0.000e+00    6.232e+01    8.262e-01
   40     808    7.793281e+03    0.000e+00    1.197e+02    3.452e+00
   41     825    7.792222e+03    0.000e+00    2.738e+02    5.326e+00
   42     842    7.791308e+03    0.000e+00    2.153e+02    4.651e+00
   43     861    7.790857e+03    0.000e+00    4.605e+02    5.746e+00
   44     878    7.790214e+03    0.000e+00    1.190e+02    1.822e+00
   45     895    7.789895e+03    0.000e+00    9.613e+02    9.437e+00
   46     912    7.789638e+03    0.000e+00    7.444e+02    4.367e+00
   47     929    7.789557e+03    0.000e+00    4.776e+02    3.048e+00
   48     946    7.789270e+03    0.000e+00    4.210e+02    3.424e+00
   49     963    7.789128e+03    0.000e+00    2.778e+02    2.694e+00
   50     980    7.788913e+03    0.000e+00    3.351e+02    5.076e+00
   51     997    7.788610e+03    0.000e+00    5.066e+02    1.036e+01
   52    1014    7.788352e+03    0.000e+00    5.633e+02    1.375e+01
   53    1032    7.788160e+03    0.000e+00    3.049e+02    5.909e+00
   54    1049    7.788101e+03    0.000e+00    2.967e+02    2.827e-01
   55    1066    7.788064e+03    0.000e+00    1.207e+02    1.101e+00
   56    1083    7.788039e+03    0.000e+00    1.029e+02    1.478e+00
   57    1100    7.788026e+03    0.000e+00    4.481e+01    7.408e-01
   58    1117    7.788024e+03    0.000e+00    1.413e+00    8.710e-02
   59    1134    7.788024e+03    0.000e+00    2.612e-01    3.254e-03

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',4.765258e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 2.3434 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

   -0.2612
    0.2310
   -0.0009
   -0.0014
   -0.0004
   -0.0004
   -0.0003
    0.0006
   -0.0003
   -0.0001
    0.0002
    0.0001
    0.0001
   -0.0004
   -0.0004
   -0.0159

Value of the log-likelihood function at convergence: -7788.0243
 
                      AIC                      BIC
              ------------------   -----------------------
                  15608.0486               15678.3995
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 0.71221
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS         -0.0033     0.0019    -1.7152
A_SnGo        -0.0036     0.0021    -1.7366
A_AgeLT40      0.5138     0.0490    10.4801
A_ExpLT8       0.7767     0.0501    15.4942
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1          -0.0749     0.0606    -1.2349
Bc_2           0.1373     0.0598     2.2943
LV_Load        1.2407     0.0552    22.4740
Mu_12         -0.5126     0.0580    -8.8427
Mu_13         -0.4906     0.0558    -8.7938
Mu_14         -0.5315     0.0585    -9.0801
Mu_22         -0.4032     0.0548    -7.3536
Mu_23         -0.3995     0.0524    -7.6238
Mu_24         -0.6806     0.0636   -10.6960
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -0.9385     0.0380   -24.7209
C_VRC         -0.8488     0.0608   -13.9543
C_LV          93.9226    52.9486     1.7738
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    2.5393    1.5393
    1.5393    2.5393

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

   -0.0033   -0.0036    0.5138    0.7767   -0.0749    0.1373    1.2407   -0.5126   -0.4906   -0.5315   -0.4032

  Columns 12 through 16

   -0.3995   -0.6806   -0.9385   -0.8488   93.9226

The covariance matrix for these parameters is:

ihess =

   1.0e+03 *

  Columns 1 through 11

    0.0000    0.0000   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
   -0.0000   -0.0000    0.0000    0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000
   -0.0000   -0.0000    0.0000    0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000
   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000   -0.0000    0.0000    0.0000    0.0000   -0.0000
   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000   -0.0000    0.0000   -0.0000    0.0000
    0.0000    0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000   -0.0000    0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000   -0.0000    0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000    0.0000    0.0000    0.0000   -0.0000   -0.0000    0.0000    0.0000   -0.0000
    0.0000    0.0000   -0.0000    0.0000    0.0000    0.0000   -0.0000   -0.0000    0.0000   -0.0000   -0.0000
    0.0001    0.0001   -0.0001   -0.0001   -0.0005   -0.0004    0.0002    0.0002    0.0001    0.0001    0.0001

  Columns 12 through 16

    0.0000    0.0000    0.0000    0.0000    0.0001
    0.0000    0.0000    0.0000    0.0000    0.0001
   -0.0000   -0.0000   -0.0000   -0.0000   -0.0001
   -0.0000   -0.0000    0.0000    0.0000   -0.0001
   -0.0000   -0.0000    0.0000    0.0000   -0.0005
    0.0000    0.0000    0.0000    0.0000   -0.0004
    0.0000    0.0000   -0.0000   -0.0000    0.0002
    0.0000    0.0000   -0.0000   -0.0000    0.0002
    0.0000    0.0000    0.0000    0.0000    0.0001
    0.0000    0.0000    0.0000   -0.0000    0.0001
    0.0000    0.0000   -0.0000   -0.0000    0.0001
    0.0000    0.0000    0.0000    0.0000    0.0001
    0.0000    0.0000   -0.0000   -0.0000    0.0001
    0.0000   -0.0000    0.0000    0.0000   -0.0000
    0.0000   -0.0000    0.0000    0.0000   -0.0001
    0.0001    0.0001   -0.0000   -0.0001    2.8036

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 32 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.178891e+04    0.000e+00    2.164e+03
User objective function returned Inf; trying a new point...
    1      39    1.057895e+04    0.000e+00    5.122e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.640307e+03    0.000e+00    3.647e+02    9.999e-01
User objective function returned Inf; trying a new point...
    3      80    8.523966e+03    0.000e+00    1.575e+03    9.999e-01
User objective function returned Inf; trying a new point...
    4      99    8.411915e+03    0.000e+00    1.239e+03    9.999e-01
User objective function returned Inf; trying a new point...
    5     122    8.247589e+03    0.000e+00    3.129e+02    4.999e-01
User objective function returned Inf; trying a new point...
    6     142    8.225027e+03    0.000e+00    2.063e+02    2.500e-01
User objective function returned Inf; trying a new point...
    7     163    8.194466e+03    0.000e+00    6.301e+02    4.999e-01
User objective function returned Inf; trying a new point...
    8     182    8.179734e+03    0.000e+00    7.233e+02    4.999e-01
User objective function returned Inf; trying a new point...
    9     204    8.142520e+03    0.000e+00    2.333e+02    4.999e-01
User objective function returned Inf; trying a new point...
   10     223    8.114524e+03    0.000e+00    3.577e+02    5.000e-01
User objective function returned Inf; trying a new point...
   11     246    8.082011e+03    0.000e+00    1.633e+02    2.500e-01
User objective function returned Inf; trying a new point...
   12     265    8.080271e+03    0.000e+00    1.796e+02    2.500e-01
User objective function returned Inf; trying a new point...
   13     286    8.058833e+03    0.000e+00    7.632e+01    5.000e-01
User objective function returned Inf; trying a new point...
   14     305    8.049846e+03    0.000e+00    9.925e+01    5.000e-01
User objective function returned Inf; trying a new point...
   15     327    8.030262e+03    0.000e+00    3.540e+02    5.000e-01
User objective function returned Inf; trying a new point...
   16     345    8.018509e+03    0.000e+00    5.334e+02    9.999e-01
User objective function returned Inf; trying a new point...
   17     368    7.975000e+03    0.000e+00    3.157e+02    5.000e-01
User objective function returned Inf; trying a new point...
   18     390    7.969929e+03    0.000e+00    1.696e+02    5.000e-01
User objective function returned Inf; trying a new point...
   19     412    7.956791e+03    0.000e+00    8.141e+01    2.500e-01
User objective function returned Inf; trying a new point...
   20     432    7.956485e+03    0.000e+00    5.805e+01    1.250e-01
User objective function returned Inf; trying a new point...
   21     453    7.952628e+03    0.000e+00    1.190e+02    2.500e-01
User objective function returned Inf; trying a new point...
   22     473    7.951980e+03    0.000e+00    1.457e+02    1.250e-01
User objective function returned Inf; trying a new point...
   23     495    7.948867e+03    0.000e+00    7.520e+01    1.250e-01
User objective function returned Inf; trying a new point...
   24     515    7.948612e+03    0.000e+00    5.213e+01    6.249e-02
   25     536    7.946728e+03    0.000e+00    2.335e+01    1.250e-01
   26     559    7.946410e+03    0.000e+00    5.650e+01    2.187e-01
   27     580    7.946180e+03    0.000e+00    1.700e+01    2.187e-01
User objective function returned Inf; trying a new point...
   28     600    7.946085e+03    0.000e+00    1.810e+01    5.468e-02
   29     621    7.944632e+03    0.000e+00    3.431e+01    1.094e-01
   30     645    7.944330e+03    0.000e+00    1.076e+01    5.997e-02

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     669    7.944291e+03    0.000e+00    1.205e+01    1.499e-02
   32     690    7.944287e+03    0.000e+00    4.259e+00    2.999e-02
   33     709    7.944285e+03    0.000e+00    5.961e+00    1.499e-02
   34     731    7.944276e+03    0.000e+00    1.195e+01    1.499e-02
   35     750    7.944271e+03    0.000e+00    8.848e+00    1.499e-02
   36     767    7.944254e+03    0.000e+00    6.614e+00    1.046e-02
   37     784    7.944249e+03    0.000e+00    6.073e+00    2.306e-03
   38     801    7.944228e+03    0.000e+00    2.806e+00    1.059e-02
   39     818    7.944219e+03    0.000e+00    5.825e-01    7.903e-03
   40     835    7.944218e+03    0.000e+00    2.393e-01    3.246e-03
   41     852    7.944218e+03    0.000e+00    4.640e-02    9.004e-04
   42     869    7.944218e+03    0.000e+00    1.062e-02    1.585e-04
   43     886    7.944218e+03    0.000e+00    1.828e-03    1.727e-05

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',9.164439e-06,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 1.8561 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

   -0.0016
   -0.0007
    0.0002
   -0.0005
   -0.0003
   -0.0008
   -0.0018
   -0.0002
   -0.0005
    0.0002
   -0.0002
    0.0002
   -0.0002
   -0.0009
   -0.0004
   -0.0002

Value of the log-likelihood function at convergence: -7944.2177
 
                      AIC                      BIC
              ------------------   -----------------------
                  15920.4355               15990.7864
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 8.5519e-09
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS          0.5153     0.0519     9.9228
A_SnGo         0.3356     0.0385     8.7068
A_AgeLT40      0.5340     0.0562     9.4957
A_ExpLT8       0.5623     0.0567     9.9234
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1          -0.9049     0.1150    -7.8721
Bc_2          -1.2550     0.1140   -11.0096
LV_Load        0.8775     0.0484    18.1396
Mu_12         -0.7197     0.0585   -12.3018
Mu_13         -0.4924     0.0514    -9.5751
Mu_14         -0.4742     0.0519    -9.1282
Mu_22         -0.3937     0.0466    -8.4500
Mu_23         -0.8215     0.0595   -13.8031
Mu_24         -0.8640     0.0642   -13.4502
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -1.0758     0.0416   -25.8437
C_VRC         -0.6760     0.0610   -11.0868
C_LV          -0.7129     0.1040    -6.8519
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    1.7700    0.7700
    0.7700    1.7700

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

    0.5153    0.3356    0.5340    0.5623   -0.9049   -1.2550    0.8775   -0.7197   -0.4924   -0.4742   -0.3937

  Columns 12 through 16

   -0.8215   -0.8640   -1.0758   -0.6760   -0.7129

The covariance matrix for these parameters is:

ihess =

  Columns 1 through 11

    0.0027    0.0005    0.0006    0.0005   -0.0039   -0.0037   -0.0010   -0.0004   -0.0003   -0.0005   -0.0003
    0.0005    0.0015    0.0005    0.0003   -0.0025   -0.0022   -0.0008   -0.0003   -0.0003   -0.0003   -0.0003
    0.0006    0.0005    0.0032    0.0005   -0.0016   -0.0014   -0.0009   -0.0003   -0.0003   -0.0004   -0.0004
    0.0005    0.0003    0.0005    0.0032   -0.0012   -0.0011   -0.0010   -0.0004   -0.0004   -0.0004   -0.0004
   -0.0039   -0.0025   -0.0016   -0.0012    0.0132    0.0118   -0.0003    0.0006    0.0001    0.0002   -0.0004
   -0.0037   -0.0022   -0.0014   -0.0011    0.0118    0.0130   -0.0007   -0.0006   -0.0006   -0.0004    0.0000
   -0.0010   -0.0008   -0.0009   -0.0010   -0.0003   -0.0007    0.0023    0.0010    0.0010    0.0011    0.0009
   -0.0004   -0.0003   -0.0003   -0.0004    0.0006   -0.0006    0.0010    0.0034    0.0002    0.0003    0.0004
   -0.0003   -0.0003   -0.0003   -0.0004    0.0001   -0.0006    0.0010    0.0002    0.0026    0.0003    0.0004
   -0.0005   -0.0003   -0.0004   -0.0004    0.0002   -0.0004    0.0011    0.0003    0.0003    0.0027    0.0005
   -0.0003   -0.0003   -0.0004   -0.0004   -0.0004    0.0000    0.0009    0.0004    0.0004    0.0005    0.0022
   -0.0004   -0.0003   -0.0004   -0.0004   -0.0002   -0.0000    0.0011    0.0005    0.0005    0.0005    0.0001
   -0.0005   -0.0003   -0.0003   -0.0004   -0.0001   -0.0002    0.0010    0.0004    0.0004    0.0005    0.0002
    0.0000   -0.0001    0.0000   -0.0000   -0.0000   -0.0002    0.0001    0.0000   -0.0000    0.0001    0.0000
   -0.0001   -0.0000   -0.0000   -0.0001    0.0001    0.0000    0.0000   -0.0000   -0.0001    0.0001    0.0000
    0.0026    0.0016    0.0009    0.0006   -0.0052   -0.0050   -0.0013   -0.0004   -0.0005   -0.0005   -0.0004

  Columns 12 through 16

   -0.0004   -0.0005    0.0000   -0.0001    0.0026
   -0.0003   -0.0003   -0.0001   -0.0000    0.0016
   -0.0004   -0.0003    0.0000   -0.0000    0.0009
   -0.0004   -0.0004   -0.0000   -0.0001    0.0006
   -0.0002   -0.0001   -0.0000    0.0001   -0.0052
   -0.0000   -0.0002   -0.0002    0.0000   -0.0050
    0.0011    0.0010    0.0001    0.0000   -0.0013
    0.0005    0.0004    0.0000   -0.0000   -0.0004
    0.0005    0.0004   -0.0000   -0.0001   -0.0005
    0.0005    0.0005    0.0001    0.0001   -0.0005
    0.0001    0.0002    0.0000    0.0000   -0.0004
    0.0035    0.0001    0.0000    0.0000   -0.0004
    0.0001    0.0041    0.0000    0.0001   -0.0005
    0.0000    0.0000    0.0017    0.0008    0.0005
    0.0000    0.0001    0.0008    0.0037    0.0007
   -0.0004   -0.0005    0.0005    0.0007    0.0108

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 33 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.285477e+04    0.000e+00    2.554e+03
User objective function returned Inf; trying a new point...
    1      39    9.788806e+03    0.000e+00    4.569e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.204930e+03    0.000e+00    1.033e+03    9.999e-01
User objective function returned Inf; trying a new point...
    3      80    8.168530e+03    0.000e+00    1.316e+03    9.999e-01
User objective function returned Inf; trying a new point...
    4      98    8.040672e+03    0.000e+00    2.069e+03    9.999e-01
User objective function returned Inf; trying a new point...
    5     120    7.908189e+03    0.000e+00    5.836e+02    9.999e-01
User objective function returned Inf; trying a new point...
    6     140    7.871976e+03    0.000e+00    3.044e+02    4.999e-01
User objective function returned Inf; trying a new point...
    7     162    7.771654e+03    0.000e+00    1.169e+02    4.999e-01
User objective function returned Inf; trying a new point...
    8     185    7.725540e+03    0.000e+00    5.337e+02    8.749e-01
User objective function returned Inf; trying a new point...
    9     204    7.717823e+03    0.000e+00    7.156e+02    4.375e-01
User objective function returned Inf; trying a new point...
   10     225    7.685983e+03    0.000e+00    7.777e+02    8.749e-01
User objective function returned Inf; trying a new point...
   11     245    7.667876e+03    0.000e+00    6.150e+02    4.375e-01
User objective function returned Inf; trying a new point...
   12     268    7.624202e+03    0.000e+00    2.855e+02    2.187e-01
User objective function returned Inf; trying a new point...
   13     286    7.604162e+03    0.000e+00    3.210e+02    4.375e-01
User objective function returned Inf; trying a new point...
   14     308    7.562217e+03    0.000e+00    2.254e+02    4.375e-01
User objective function returned Inf; trying a new point...
   15     326    7.542535e+03    0.000e+00    2.879e+02    8.749e-01
User objective function returned Inf; trying a new point...
   16     349    7.523969e+03    0.000e+00    2.354e+02    4.375e-01
User objective function returned Inf; trying a new point...
   17     369    7.522973e+03    0.000e+00    1.695e+02    2.187e-01
User objective function returned Inf; trying a new point...
   18     391    7.510450e+03    0.000e+00    2.181e+02    2.187e-01
User objective function returned Inf; trying a new point...
   19     417    7.509356e+03    0.000e+00    2.731e+02    4.785e-02
User objective function returned Inf; trying a new point...
   20     435    7.508804e+03    0.000e+00    2.650e+02    4.785e-02
User objective function returned Inf; trying a new point...
   21     456    7.500416e+03    0.000e+00    9.220e+01    9.569e-02
   22     478    7.495486e+03    0.000e+00    2.199e+02    3.349e-01
User objective function returned Inf; trying a new point...
   23     497    7.492881e+03    0.000e+00    3.376e+02    3.349e-01
User objective function returned Inf; trying a new point...
   24     519    7.491805e+03    0.000e+00    9.100e+01    3.349e-01
User objective function returned Inf; trying a new point...
   25     537    7.488982e+03    0.000e+00    8.568e+01    3.349e-01
User objective function returned Inf; trying a new point...
   26     559    7.477879e+03    0.000e+00    1.109e+02    3.349e-01
   27     579    7.475931e+03    0.000e+00    4.099e+01    1.675e-01
   28     601    7.470510e+03    0.000e+00    3.529e+01    1.675e-01
User objective function returned Inf; trying a new point...
   29     625    7.469328e+03    0.000e+00    3.465e+01    1.465e-01
User objective function returned Inf; trying a new point...
   30     645    7.469119e+03    0.000e+00    7.406e+01    7.327e-02

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     666    7.469041e+03    0.000e+00    6.438e+01    1.465e-01
User objective function returned Inf; trying a new point...
   32     684    7.468608e+03    0.000e+00    6.211e+01    1.465e-01
   33     707    7.467749e+03    0.000e+00    2.770e+01    7.327e-02
   34     730    7.467697e+03    0.000e+00    1.054e+01    3.663e-02
   35     752    7.467693e+03    0.000e+00    7.032e+00    3.663e-02
   36     771    7.467679e+03    0.000e+00    8.025e+00    1.832e-02
   37     788    7.467631e+03    0.000e+00    2.422e+00    1.861e-02
   38     805    7.467630e+03    0.000e+00    1.875e+00    2.185e-03
   39     822    7.467630e+03    0.000e+00    1.078e+00    2.373e-03
   40     839    7.467629e+03    0.000e+00    9.241e-02    4.858e-03
   41     856    7.467629e+03    0.000e+00    1.012e-01    1.283e-03
   42     873    7.467629e+03    0.000e+00    1.331e-02    3.006e-04
   43     890    7.467629e+03    0.000e+00    1.404e-03    9.689e-05

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',4.289225e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 1.818 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

    0.0010
    0.0014
    0.0003
         0
   -0.0011
    0.0011
    0.0003
    0.0010
    0.0004
    0.0003
         0
   -0.0004
   -0.0005
    0.0001
    0.0001
   -0.0005

Value of the log-likelihood function at convergence: -7467.6288
 
                      AIC                      BIC
              ------------------   -----------------------
                  14967.2577               15037.6085
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 9.1433e-09
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS          0.6099     0.0451    13.5342
A_SnGo         0.0538     0.0275     1.9601
A_AgeLT40      0.5745     0.0503    11.4193
A_ExpLT8       0.9517     0.0518    18.3759
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1          -1.1697     0.1295    -9.0321
Bc_2          -1.5743     0.1307   -12.0435
LV_Load        1.2486     0.0551    22.6568
Mu_12         -0.3406     0.0556    -6.1280
Mu_13         -0.6494     0.0606   -10.7171
Mu_14         -0.7871     0.0661   -11.9026
Mu_22         -0.3281     0.0534    -6.1461
Mu_23         -0.7951     0.0657   -12.0976
Mu_24         -0.5818     0.0598    -9.7350
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -0.8207     0.0348   -23.5928
C_VRC         -0.6609     0.0596   -11.0888
C_LV          -0.8590     0.1100    -7.8092
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    2.5591    1.5591
    1.5591    2.5591

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

    0.6099    0.0538    0.5745    0.9517   -1.1697   -1.5743    1.2486   -0.3406   -0.6494   -0.7871   -0.3281

  Columns 12 through 16

   -0.7951   -0.5818   -0.8207   -0.6609   -0.8590

The covariance matrix for these parameters is:

ihess =

  Columns 1 through 11

    0.0020   -0.0000    0.0003    0.0003   -0.0035   -0.0035   -0.0008   -0.0003   -0.0002   -0.0001   -0.0002
   -0.0000    0.0008    0.0001   -0.0000   -0.0017   -0.0016   -0.0001   -0.0000   -0.0000    0.0000   -0.0000
    0.0003    0.0001    0.0025    0.0002   -0.0014   -0.0011   -0.0007   -0.0003   -0.0003   -0.0001   -0.0000
    0.0003   -0.0000    0.0002    0.0027   -0.0008   -0.0007   -0.0011   -0.0003   -0.0004   -0.0005   -0.0004
   -0.0035   -0.0017   -0.0014   -0.0008    0.0168    0.0153   -0.0014    0.0002   -0.0001   -0.0005   -0.0008
   -0.0035   -0.0016   -0.0011   -0.0007    0.0153    0.0171   -0.0019   -0.0010   -0.0009   -0.0010   -0.0000
   -0.0008   -0.0001   -0.0007   -0.0011   -0.0014   -0.0019    0.0030    0.0013    0.0012    0.0011    0.0012
   -0.0003   -0.0000   -0.0003   -0.0003    0.0002   -0.0010    0.0013    0.0031    0.0000    0.0003    0.0004
   -0.0002   -0.0000   -0.0003   -0.0004   -0.0001   -0.0009    0.0012    0.0000    0.0037   -0.0001    0.0005
   -0.0001    0.0000   -0.0001   -0.0005   -0.0005   -0.0010    0.0011    0.0003   -0.0001    0.0044    0.0005
   -0.0002   -0.0000   -0.0000   -0.0004   -0.0008   -0.0000    0.0012    0.0004    0.0005    0.0005    0.0029
   -0.0002    0.0000   -0.0002   -0.0003   -0.0010   -0.0006    0.0012    0.0005    0.0005    0.0006    0.0001
   -0.0002   -0.0000   -0.0003   -0.0003   -0.0007   -0.0005    0.0012    0.0005    0.0005    0.0005    0.0002
   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000   -0.0000    0.0001   -0.0001
   -0.0001   -0.0001   -0.0000    0.0001    0.0001    0.0001    0.0001   -0.0000   -0.0000   -0.0001    0.0000
    0.0028   -0.0001    0.0003    0.0005   -0.0048   -0.0045   -0.0012   -0.0004   -0.0006   -0.0007   -0.0006

  Columns 12 through 16

   -0.0002   -0.0002   -0.0000   -0.0001    0.0028
    0.0000   -0.0000   -0.0000   -0.0001   -0.0001
   -0.0002   -0.0003   -0.0000   -0.0000    0.0003
   -0.0003   -0.0003    0.0000    0.0001    0.0005
   -0.0010   -0.0007    0.0000    0.0001   -0.0048
   -0.0006   -0.0005    0.0000    0.0001   -0.0045
    0.0012    0.0012    0.0000    0.0001   -0.0012
    0.0005    0.0005    0.0000   -0.0000   -0.0004
    0.0005    0.0005   -0.0000   -0.0000   -0.0006
    0.0006    0.0005    0.0001   -0.0001   -0.0007
    0.0001    0.0002   -0.0001    0.0000   -0.0006
    0.0043    0.0001    0.0000   -0.0000   -0.0004
    0.0001    0.0036    0.0001    0.0000   -0.0004
    0.0000    0.0001    0.0012    0.0007    0.0004
   -0.0000    0.0000    0.0007    0.0036    0.0006
   -0.0004   -0.0004    0.0004    0.0006    0.0121

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 34 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.283193e+04    0.000e+00    2.535e+03
User objective function returned Inf; trying a new point...
    1      39    1.020076e+04    0.000e+00    4.761e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.519537e+03    0.000e+00    6.427e+02    9.999e-01
User objective function returned Inf; trying a new point...
    3      81    8.436677e+03    0.000e+00    1.353e+03    4.999e-01
User objective function returned Inf; trying a new point...
    4      99    8.305364e+03    0.000e+00    1.434e+03    5.000e-01
User objective function returned Inf; trying a new point...
    5     120    8.256649e+03    0.000e+00    4.600e+02    9.999e-01
User objective function returned Inf; trying a new point...
    6     140    8.251082e+03    0.000e+00    5.456e+02    2.500e-01
User objective function returned Inf; trying a new point...
    7     161    8.150303e+03    0.000e+00    5.015e+02    4.999e-01
User objective function returned Inf; trying a new point...
    8     180    8.119168e+03    0.000e+00    3.776e+02    5.000e-01
User objective function returned Inf; trying a new point...
    9     202    8.088317e+03    0.000e+00    2.735e+02    4.999e-01
User objective function returned Inf; trying a new point...
   10     221    8.072035e+03    0.000e+00    2.578e+02    4.999e-01
User objective function returned Inf; trying a new point...
   11     244    8.031573e+03    0.000e+00    2.075e+02    2.500e-01
User objective function returned Inf; trying a new point...
   12     267    8.016981e+03    0.000e+00    3.066e+02    4.375e-01
User objective function returned Inf; trying a new point...
   13     285    7.997504e+03    0.000e+00    2.155e+02    4.375e-01
User objective function returned Inf; trying a new point...
   14     307    7.959184e+03    0.000e+00    3.375e+02    4.375e-01
User objective function returned Inf; trying a new point...
   15     326    7.954035e+03    0.000e+00    4.430e+02    4.375e-01
User objective function returned Inf; trying a new point...
   16     348    7.942995e+03    0.000e+00    2.819e+02    4.375e-01
User objective function returned Inf; trying a new point...
   17     368    7.939693e+03    0.000e+00    1.849e+02    2.187e-01
User objective function returned Inf; trying a new point...
   18     389    7.930228e+03    0.000e+00    2.088e+02    4.375e-01
User objective function returned Inf; trying a new point...
   19     408    7.927296e+03    0.000e+00    2.947e+02    4.375e-01
   20     430    7.923851e+03    0.000e+00    1.223e+02    4.375e-01
User objective function returned Inf; trying a new point...
   21     448    7.919267e+03    0.000e+00    2.723e+02    4.375e-01
User objective function returned Inf; trying a new point...
   22     471    7.908541e+03    0.000e+00    1.220e+02    2.187e-01
User objective function returned Inf; trying a new point...
   23     494    7.908060e+03    0.000e+00    7.702e+01    1.094e-01
User objective function returned Inf; trying a new point...
   24     512    7.907438e+03    0.000e+00    9.658e+01    1.094e-01
User objective function returned Inf; trying a new point...
   25     533    7.903708e+03    0.000e+00    4.312e+01    2.187e-01
User objective function returned Inf; trying a new point...
   26     552    7.903106e+03    0.000e+00    5.140e+01    2.187e-01
User objective function returned Inf; trying a new point...
   27     573    7.898497e+03    0.000e+00    5.464e+01    4.375e-01
User objective function returned Inf; trying a new point...
   28     599    7.897514e+03    0.000e+00    3.778e+01    9.569e-02
User objective function returned Inf; trying a new point...
   29     618    7.897305e+03    0.000e+00    4.884e+01    9.569e-02
   30     639    7.895588e+03    0.000e+00    3.367e+01    1.914e-01
User objective function returned complex; trying a new point...

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     663    7.894997e+03    0.000e+00    6.276e+01    1.675e-01
   32     685    7.894748e+03    0.000e+00    2.666e+01    1.675e-01
   33     704    7.894426e+03    0.000e+00    4.006e+01    8.373e-02
   34     725    7.893940e+03    0.000e+00    3.386e+01    1.675e-01
   35     744    7.893936e+03    0.000e+00    2.620e+01    8.373e-02
   36     761    7.884880e+03    0.000e+00    1.629e+02    1.995e+00
   37     778    7.881734e+03    0.000e+00    2.692e+02    1.543e+00
   38     795    7.876532e+03    0.000e+00    1.848e+02    1.752e+00
   39     813    7.875523e+03    0.000e+00    2.629e+02    8.843e-01
   40     831    7.874020e+03    0.000e+00    5.569e+02    3.029e+00
   41     848    7.872665e+03    0.000e+00    4.144e+02    4.425e-01
   42     865    7.870323e+03    0.000e+00    1.356e+02    8.341e-01
   43     882    7.869179e+03    0.000e+00    4.374e+02    2.582e+00
   44     899    7.867746e+03    0.000e+00    1.802e+02    1.148e+00
   45     916    7.865692e+03    0.000e+00    2.510e+02    5.250e+00
   46     933    7.864909e+03    0.000e+00    2.395e+02    3.222e+00
   47     951    7.864470e+03    0.000e+00    1.081e+02    2.905e+00
   48     968    7.864297e+03    0.000e+00    3.297e+02    2.406e+00
   49     985    7.863661e+03    0.000e+00    3.346e+02    4.300e+00
   50    1002    7.862835e+03    0.000e+00    3.258e+02    4.188e+00
   51    1020    7.862136e+03    0.000e+00    6.413e+02    8.113e+00
   52    1037    7.861736e+03    0.000e+00    5.077e+02    1.998e+00
   53    1054    7.861497e+03    0.000e+00    1.414e+02    2.844e+00
   54    1071    7.861401e+03    0.000e+00    7.169e+02    6.555e+00
   55    1088    7.861155e+03    0.000e+00    4.444e+02    2.256e+00
   56    1105    7.860914e+03    0.000e+00    7.320e+01    3.713e+00
   57    1123    7.860668e+03    0.000e+00    7.948e+02    1.102e+01
   58    1140    7.860461e+03    0.000e+00    2.895e+02    3.724e-01
   59    1157    7.860299e+03    0.000e+00    1.435e+02    6.078e+00
   60    1174    7.860143e+03    0.000e+00    6.675e+02    1.022e+01

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   61    1191    7.860112e+03    0.000e+00    2.577e+02    2.299e+00
   62    1208    7.860065e+03    0.000e+00    9.234e+01    1.718e+00
   63    1225    7.860039e+03    0.000e+00    1.997e+01    1.150e+00
   64    1242    7.860039e+03    0.000e+00    1.261e+00    6.632e-03
   65    1259    7.860039e+03    0.000e+00    2.686e-01    2.200e-02
   66    1276    7.860039e+03    0.000e+00    3.754e-02    5.645e-03

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',5.937914e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 2.6419 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

   -0.0247
    0.0375
   -0.0003
   -0.0003
    0.0001
   -0.0007
    0.0003
         0
   -0.0001
   -0.0005
   -0.0004
   -0.0001
    0.0001
   -0.0001
   -0.0001
   -0.0197

Value of the log-likelihood function at convergence: -7860.0385
 
                      AIC                      BIC
              ------------------   -----------------------
                  15752.0770               15822.4279
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 0.60329
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS         -0.0071     0.0030    -2.4010
A_SnGo        -0.0010     0.0006    -1.5547
A_AgeLT40      0.8881     0.0632    14.0628
A_ExpLT8       0.9411     0.0629    14.9711
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1           0.2268     0.0509     4.4508
Bc_2           0.1343     0.0503     2.6710
LV_Load        0.8853     0.0466    18.9955
Mu_12         -0.7374     0.0604   -12.2005
Mu_13         -0.5765     0.0521   -11.0760
Mu_14         -0.5387     0.0532   -10.1303
Mu_22         -0.6470     0.0579   -11.1682
Mu_23         -0.5853     0.0522   -11.2242
Mu_24         -0.9300     0.0622   -14.9611
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -0.7825     0.0315   -24.8230
C_VRC         -0.5874     0.0553   -10.6143
C_LV          95.0647    39.3254     2.4174
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    1.7838    0.7838
    0.7838    1.7838

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

   -0.0071   -0.0010    0.8881    0.9411    0.2268    0.1343    0.8853   -0.7374   -0.5765   -0.5387   -0.6470

  Columns 12 through 16

   -0.5853   -0.9300   -0.7825   -0.5874   95.0647

The covariance matrix for these parameters is:

ihess =

   1.0e+03 *

  Columns 1 through 11

    0.0000    0.0000   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
   -0.0000   -0.0000    0.0000    0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000
   -0.0000   -0.0000    0.0000    0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000
   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000   -0.0000
   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000   -0.0000   -0.0000   -0.0000    0.0000
    0.0000    0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000   -0.0000    0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000   -0.0000    0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000   -0.0000    0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000   -0.0000    0.0000   -0.0000
    0.0000    0.0000    0.0000   -0.0000    0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000   -0.0000
    0.0001    0.0000   -0.0001   -0.0001   -0.0002   -0.0002    0.0002    0.0001    0.0001    0.0001    0.0002

  Columns 12 through 16

    0.0000    0.0000    0.0000    0.0000    0.0001
    0.0000    0.0000    0.0000    0.0000    0.0000
   -0.0000   -0.0000   -0.0000    0.0000   -0.0001
   -0.0000   -0.0000   -0.0000   -0.0000   -0.0001
    0.0000    0.0000    0.0000    0.0000   -0.0002
    0.0000    0.0000    0.0000   -0.0000   -0.0002
    0.0000    0.0000    0.0000    0.0000    0.0002
    0.0000    0.0000    0.0000    0.0000    0.0001
    0.0000    0.0000   -0.0000    0.0000    0.0001
    0.0000    0.0000    0.0000    0.0000    0.0001
    0.0000    0.0000   -0.0000   -0.0000    0.0002
    0.0000    0.0000   -0.0000   -0.0000    0.0001
    0.0000    0.0000    0.0000    0.0000    0.0000
   -0.0000    0.0000    0.0000    0.0000   -0.0000
   -0.0000    0.0000    0.0000    0.0000    0.0000
    0.0001    0.0000   -0.0000    0.0000    1.5465

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 35 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.230313e+04    0.000e+00    2.296e+03
User objective function returned Inf; trying a new point...
    1      39    1.035881e+04    0.000e+00    5.007e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.498404e+03    0.000e+00    3.713e+02    9.999e-01
User objective function returned Inf; trying a new point...
    3      82    8.451110e+03    0.000e+00    1.078e+03    2.500e-01
User objective function returned Inf; trying a new point...
    4     100    8.343971e+03    0.000e+00    9.147e+02    5.000e-01
User objective function returned Inf; trying a new point...
    5     121    8.276193e+03    0.000e+00    3.340e+02    9.999e-01
User objective function returned Inf; trying a new point...
    6     145    8.247795e+03    0.000e+00    6.808e+02    2.500e-01
User objective function returned Inf; trying a new point...
    7     163    8.241845e+03    0.000e+00    7.103e+02    2.500e-01
User objective function returned Inf; trying a new point...
    8     185    8.216735e+03    0.000e+00    3.393e+02    2.500e-01
User objective function returned Inf; trying a new point...
    9     203    8.194615e+03    0.000e+00    4.564e+02    2.500e-01
User objective function returned Inf; trying a new point...
   10     224    8.155524e+03    0.000e+00    2.832e+02    4.999e-01
User objective function returned Inf; trying a new point...
   11     243    8.150530e+03    0.000e+00    5.468e+02    4.999e-01
User objective function returned Inf; trying a new point...
   12     265    8.106760e+03    0.000e+00    9.554e+01    5.000e-01
User objective function returned Inf; trying a new point...
   13     285    8.103461e+03    0.000e+00    8.778e+01    2.500e-01
User objective function returned Inf; trying a new point...
   14     306    8.082072e+03    0.000e+00    2.479e+02    4.999e-01
User objective function returned Inf; trying a new point...
   15     325    8.063668e+03    0.000e+00    1.350e+02    5.000e-01
User objective function returned Inf; trying a new point...
   16     347    8.036242e+03    0.000e+00    1.653e+02    5.000e-01
User objective function returned Inf; trying a new point...
   17     366    8.032845e+03    0.000e+00    1.638e+02    5.000e-01
User objective function returned Inf; trying a new point...
   18     391    8.028755e+03    0.000e+00    1.704e+02    6.249e-02
User objective function returned Inf; trying a new point...
   19     409    8.027302e+03    0.000e+00    1.546e+02    1.250e-01
   20     430    8.018868e+03    0.000e+00    8.387e+01    2.500e-01
User objective function returned Inf; trying a new point...
   21     453    8.015397e+03    0.000e+00    5.191e+01    1.250e-01
User objective function returned Inf; trying a new point...
   22     472    8.014923e+03    0.000e+00    4.906e+01    1.250e-01
   23     493    8.012085e+03    0.000e+00    5.495e+01    2.500e-01
User objective function returned Inf; trying a new point...
   24     516    8.011480e+03    0.000e+00    5.313e+01    1.250e-01
User objective function returned Inf; trying a new point...
   25     536    8.011168e+03    0.000e+00    4.478e+01    6.249e-02
   26     557    8.010419e+03    0.000e+00    3.934e+01    1.250e-01
User objective function returned Inf; trying a new point...
   27     577    8.010066e+03    0.000e+00    3.581e+01    6.249e-02
   28     599    8.009727e+03    0.000e+00    2.154e+01    6.249e-02
   29     621    8.009406e+03    0.000e+00    3.610e+01    6.249e-02
   30     644    8.009092e+03    0.000e+00    2.640e+01    3.125e-02

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     664    8.009071e+03    0.000e+00    1.928e+01    5.468e-02
   32     686    8.008624e+03    0.000e+00    1.218e+01    5.468e-02
User objective function returned Inf; trying a new point...
   33     710    8.008309e+03    0.000e+00    7.486e+00    4.785e-02
   34     733    8.008240e+03    0.000e+00    3.747e+00    2.392e-02
   35     753    8.008235e+03    0.000e+00    1.433e+00    1.196e-02
   36     770    8.008218e+03    0.000e+00    3.081e+00    2.807e-02
   37     787    8.008216e+03    0.000e+00    4.786e-01    4.752e-03
   38     804    8.008216e+03    0.000e+00    1.669e-01    1.426e-03
   39     821    8.008216e+03    0.000e+00    8.070e-03    2.853e-04
   40     838    8.008216e+03    0.000e+00    1.099e-03    6.414e-05

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',4.086032e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 1.7589 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

   -0.0007
   -0.0004
    0.0011
    0.0005
   -0.0001
   -0.0004
   -0.0007
   -0.0002
   -0.0002
   -0.0005
         0
    0.0004
   -0.0001
    0.0002
    0.0001
   -0.0003

Value of the log-likelihood function at convergence: -8008.2164
 
                      AIC                      BIC
              ------------------   -----------------------
                  16048.4328               16118.7836
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 1.1522e-08
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS          0.4700     0.0506     9.2844
A_SnGo         0.0305     0.0316     0.9652
A_AgeLT40      0.1181     0.0508     2.3264
A_ExpLT8       0.7358     0.0553    13.3146
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1          -0.3816     0.1133    -3.3689
Bc_2          -0.4812     0.1141    -4.2158
LV_Load        0.9718     0.0464    20.9483
Mu_12         -0.4228     0.0506    -8.3479
Mu_13         -0.9029     0.0639   -14.1403
Mu_14         -0.6591     0.0543   -12.1383
Mu_22         -0.6152     0.0545   -11.2973
Mu_23         -0.6550     0.0544   -12.0443
Mu_24         -0.5537     0.0538   -10.2989
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -0.9379     0.0362   -25.9244
C_VRC         -0.5861     0.0601    -9.7523
C_LV          -0.7351     0.1416    -5.1909
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    1.9444    0.9444
    0.9444    1.9444

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

    0.4700    0.0305    0.1181    0.7358   -0.3816   -0.4812    0.9718   -0.4228   -0.9029   -0.6591   -0.6152

  Columns 12 through 16

   -0.6550   -0.5537   -0.9379   -0.5861   -0.7351

The covariance matrix for these parameters is:

ihess =

  Columns 1 through 11

    0.0026    0.0000    0.0001    0.0003   -0.0037   -0.0038   -0.0008   -0.0002   -0.0003   -0.0003   -0.0003
    0.0000    0.0010    0.0002    0.0000   -0.0020   -0.0020   -0.0000   -0.0000    0.0000   -0.0000    0.0000
    0.0001    0.0002    0.0026    0.0001   -0.0014   -0.0014   -0.0002   -0.0000   -0.0001   -0.0001   -0.0000
    0.0003    0.0000    0.0001    0.0031   -0.0011   -0.0010   -0.0010   -0.0003   -0.0004   -0.0003   -0.0002
   -0.0037   -0.0020   -0.0014   -0.0011    0.0128    0.0116   -0.0001    0.0006    0.0005    0.0002   -0.0001
   -0.0038   -0.0020   -0.0014   -0.0010    0.0116    0.0130   -0.0002   -0.0003   -0.0001   -0.0002    0.0007
   -0.0008   -0.0000   -0.0002   -0.0010   -0.0001   -0.0002    0.0022    0.0009    0.0010    0.0008    0.0008
   -0.0002   -0.0000   -0.0000   -0.0003    0.0006   -0.0003    0.0009    0.0026    0.0001    0.0002    0.0004
   -0.0003    0.0000   -0.0001   -0.0004    0.0005   -0.0001    0.0010    0.0001    0.0041    0.0001    0.0003
   -0.0003   -0.0000   -0.0001   -0.0003    0.0002   -0.0002    0.0008    0.0002    0.0001    0.0029    0.0003
   -0.0003    0.0000   -0.0000   -0.0002   -0.0001    0.0007    0.0008    0.0004    0.0003    0.0003    0.0030
   -0.0003   -0.0000   -0.0002   -0.0003   -0.0001    0.0004    0.0009    0.0004    0.0004    0.0004    0.0000
   -0.0002   -0.0000   -0.0000   -0.0002   -0.0002    0.0001    0.0009    0.0004    0.0003    0.0003    0.0002
    0.0000   -0.0000    0.0000    0.0001   -0.0001   -0.0000   -0.0000   -0.0000   -0.0001   -0.0000   -0.0000
   -0.0000   -0.0001   -0.0001    0.0000    0.0003    0.0002    0.0000    0.0000    0.0001    0.0000    0.0000
    0.0040    0.0003    0.0001    0.0005   -0.0066   -0.0066   -0.0010   -0.0003   -0.0003   -0.0004   -0.0005

  Columns 12 through 16

   -0.0003   -0.0002    0.0000   -0.0000    0.0040
   -0.0000   -0.0000   -0.0000   -0.0001    0.0003
   -0.0002   -0.0000    0.0000   -0.0001    0.0001
   -0.0003   -0.0002    0.0001    0.0000    0.0005
   -0.0001   -0.0002   -0.0001    0.0003   -0.0066
    0.0004    0.0001   -0.0000    0.0002   -0.0066
    0.0009    0.0009   -0.0000    0.0000   -0.0010
    0.0004    0.0004   -0.0000    0.0000   -0.0003
    0.0004    0.0003   -0.0001    0.0001   -0.0003
    0.0004    0.0003   -0.0000    0.0000   -0.0004
    0.0000    0.0002   -0.0000    0.0000   -0.0005
    0.0030    0.0001   -0.0000   -0.0001   -0.0004
    0.0001    0.0029    0.0000   -0.0000   -0.0003
   -0.0000    0.0000    0.0013    0.0005    0.0002
   -0.0001   -0.0000    0.0005    0.0036    0.0003
   -0.0004   -0.0003    0.0002    0.0003    0.0201

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 36 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.172312e+04    0.000e+00    1.951e+03
User objective function returned Inf; trying a new point...
    1      39    1.053821e+04    0.000e+00    5.231e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.594388e+03    0.000e+00    4.733e+02    9.999e-01
User objective function returned Inf; trying a new point...
    3      79    8.589498e+03    0.000e+00    1.471e+03    2.000e+00
User objective function returned Inf; trying a new point...
    4      99    8.550390e+03    0.000e+00    1.087e+03    5.000e-01
User objective function returned Inf; trying a new point...
    5     120    8.220884e+03    0.000e+00    4.558e+02    9.999e-01
User objective function returned Inf; trying a new point...
    6     140    8.183293e+03    0.000e+00    2.058e+02    4.999e-01
User objective function returned Inf; trying a new point...
    7     163    8.151706e+03    0.000e+00    2.836e+02    2.500e-01
User objective function returned Inf; trying a new point...
    8     183    8.146459e+03    0.000e+00    2.410e+02    1.250e-01
User objective function returned Inf; trying a new point...
    9     204    8.127312e+03    0.000e+00    3.475e+02    2.500e-01
User objective function returned Inf; trying a new point...
   10     226    8.116057e+03    0.000e+00    5.760e+02    8.749e-01
User objective function returned Inf; trying a new point...
   11     246    8.105866e+03    0.000e+00    6.493e+02    4.375e-01
User objective function returned Inf; trying a new point...
   12     269    8.099892e+03    0.000e+00    6.003e+02    2.187e-01
User objective function returned Inf; trying a new point...
   13     287    8.093073e+03    0.000e+00    5.869e+02    2.187e-01
User objective function returned Inf; trying a new point...
   14     308    8.071335e+03    0.000e+00    1.524e+02    4.375e-01
User objective function returned Inf; trying a new point...
   15     326    8.062211e+03    0.000e+00    2.353e+02    8.749e-01
User objective function returned Inf; trying a new point...
   16     349    8.026982e+03    0.000e+00    2.017e+02    4.375e-01
User objective function returned Inf; trying a new point...
   17     367    8.019742e+03    0.000e+00    2.620e+02    8.749e-01
User objective function returned Inf; trying a new point...
   18     390    7.970835e+03    0.000e+00    3.680e+02    4.375e-01
User objective function returned Inf; trying a new point...
   19     409    7.967815e+03    0.000e+00    3.403e+02    4.375e-01
User objective function returned Inf; trying a new point...
   20     430    7.958211e+03    0.000e+00    1.760e+02    8.749e-01
User objective function returned Inf; trying a new point...
   21     450    7.953966e+03    0.000e+00    2.000e+02    2.187e-01
User objective function returned complex; trying a new point...
   22     471    7.917002e+03    0.000e+00    2.796e+02    4.375e-01
User objective function returned Inf; trying a new point...
   23     491    7.914578e+03    0.000e+00    2.619e+02    2.187e-01
User objective function returned Inf; trying a new point...
   24     512    7.909498e+03    0.000e+00    3.301e+02    4.375e-01
User objective function returned Inf; trying a new point...
   25     533    7.904058e+03    0.000e+00    1.994e+02    4.375e-01
User objective function returned Inf; trying a new point...
   26     553    7.903167e+03    0.000e+00    2.226e+02    1.094e-01
User objective function returned Inf; trying a new point...
   27     574    7.892883e+03    0.000e+00    4.668e+01    2.187e-01
   28     597    7.891336e+03    0.000e+00    8.356e+01    1.094e-01
   29     619    7.890528e+03    0.000e+00    2.735e+01    1.094e-01
User objective function returned Inf; trying a new point...
   30     642    7.890161e+03    0.000e+00    1.759e+01    5.468e-02

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     663    7.889982e+03    0.000e+00    3.309e+01    1.094e-01
User objective function returned Inf; trying a new point...
   32     683    7.889827e+03    0.000e+00    4.024e+01    5.468e-02
   33     704    7.889817e+03    0.000e+00    2.627e+01    6.099e-02
   34     726    7.889593e+03    0.000e+00    2.600e+01    5.468e-02
   35     746    7.889580e+03    0.000e+00    1.601e+01    2.734e-02
   36     763    7.889449e+03    0.000e+00    2.333e+01    3.346e-02
   37     780    7.889371e+03    0.000e+00    1.234e+01    1.561e-02
   38     797    7.889268e+03    0.000e+00    7.512e+00    1.978e-02
   39     814    7.889218e+03    0.000e+00    3.626e+00    2.079e-02
   40     831    7.889216e+03    0.000e+00    5.844e-01    3.714e-03
   41     848    7.889216e+03    0.000e+00    2.889e-02    8.186e-04
   42     865    7.889216e+03    0.000e+00    8.851e-03    1.633e-04

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',8.819913e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 1.7909 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

    0.0040
    0.0089
    0.0020
    0.0029
    0.0035
   -0.0007
    0.0082
   -0.0048
   -0.0035
   -0.0008
    0.0004
    0.0013
    0.0004
   -0.0021
    0.0013
    0.0010

Value of the log-likelihood function at convergence: -7889.2158
 
                      AIC                      BIC
              ------------------   -----------------------
                  15810.4315               15880.7824
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 7.4918e-08
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS          0.6097     0.0485    12.5758
A_SnGo         0.1316     0.0275     4.7859
A_AgeLT40      0.5366     0.0512    10.4896
A_ExpLT8       0.5290     0.0508    10.4048
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1          -1.2400     0.1164   -10.6554
Bc_2          -1.2221     0.1191   -10.2633
LV_Load        1.1072     0.0494    22.4317
Mu_12         -0.4527     0.0513    -8.8306
Mu_13         -0.6291     0.0553   -11.3773
Mu_14         -0.9132     0.0675   -13.5266
Mu_22         -0.2453     0.0470    -5.2160
Mu_23         -0.3875     0.0484    -8.0047
Mu_24         -0.9218     0.0686   -13.4365
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -0.8086     0.0352   -22.9634
C_VRC         -0.6134     0.0560   -10.9576
C_LV          -0.9731     0.1134    -8.5796
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    2.2260    1.2260
    1.2260    2.2260

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

    0.6097    0.1316    0.5366    0.5290   -1.2400   -1.2221    1.1072   -0.4527   -0.6291   -0.9132   -0.2453

  Columns 12 through 16

   -0.3875   -0.9218   -0.8086   -0.6134   -0.9731

The covariance matrix for these parameters is:

ihess =

  Columns 1 through 11

    0.0024   -0.0000    0.0002    0.0003   -0.0033   -0.0036   -0.0007   -0.0001   -0.0002   -0.0001   -0.0003
   -0.0000    0.0008    0.0001   -0.0000   -0.0014   -0.0013   -0.0002   -0.0001   -0.0001   -0.0002   -0.0000
    0.0002    0.0001    0.0026    0.0002   -0.0009   -0.0009   -0.0006   -0.0002   -0.0002   -0.0001   -0.0002
    0.0003   -0.0000    0.0002    0.0026   -0.0010   -0.0010   -0.0006   -0.0001   -0.0001   -0.0001   -0.0001
   -0.0033   -0.0014   -0.0009   -0.0010    0.0135    0.0125   -0.0012   -0.0000   -0.0003   -0.0005   -0.0006
   -0.0036   -0.0013   -0.0009   -0.0010    0.0125    0.0142   -0.0012   -0.0009   -0.0008   -0.0008    0.0001
   -0.0007   -0.0002   -0.0006   -0.0006   -0.0012   -0.0012    0.0024    0.0009    0.0010    0.0010    0.0010
   -0.0001   -0.0001   -0.0002   -0.0001   -0.0000   -0.0009    0.0009    0.0026    0.0000    0.0002    0.0004
   -0.0002   -0.0001   -0.0002   -0.0001   -0.0003   -0.0008    0.0010    0.0000    0.0031    0.0001    0.0004
   -0.0001   -0.0002   -0.0001   -0.0001   -0.0005   -0.0008    0.0010    0.0002    0.0001    0.0046    0.0005
   -0.0003   -0.0000   -0.0002   -0.0001   -0.0006    0.0001    0.0010    0.0004    0.0004    0.0005    0.0022
   -0.0003   -0.0001   -0.0002   -0.0002   -0.0004    0.0000    0.0010    0.0003    0.0004    0.0005    0.0002
   -0.0002   -0.0001   -0.0001   -0.0001   -0.0007   -0.0004    0.0010    0.0004    0.0004    0.0005    0.0003
    0.0002   -0.0000   -0.0000   -0.0000   -0.0003   -0.0003   -0.0000    0.0000    0.0001   -0.0000   -0.0000
    0.0000   -0.0000   -0.0000   -0.0001    0.0000   -0.0000   -0.0000    0.0000    0.0001   -0.0001    0.0000
    0.0036    0.0002    0.0002    0.0004   -0.0055   -0.0059   -0.0012   -0.0002   -0.0002   -0.0001   -0.0005

  Columns 12 through 16

   -0.0003   -0.0002    0.0002    0.0000    0.0036
   -0.0001   -0.0001   -0.0000   -0.0000    0.0002
   -0.0002   -0.0001   -0.0000   -0.0000    0.0002
   -0.0002   -0.0001   -0.0000   -0.0001    0.0004
   -0.0004   -0.0007   -0.0003    0.0000   -0.0055
    0.0000   -0.0004   -0.0003   -0.0000   -0.0059
    0.0010    0.0010   -0.0000   -0.0000   -0.0012
    0.0003    0.0004    0.0000    0.0000   -0.0002
    0.0004    0.0004    0.0001    0.0001   -0.0002
    0.0005    0.0005   -0.0000   -0.0001   -0.0001
    0.0002    0.0003   -0.0000    0.0000   -0.0005
    0.0023    0.0002    0.0000    0.0000   -0.0005
    0.0002    0.0047   -0.0000   -0.0001   -0.0004
    0.0000   -0.0000    0.0012    0.0006    0.0009
    0.0000   -0.0001    0.0006    0.0031    0.0007
   -0.0005   -0.0004    0.0009    0.0007    0.0129

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 37 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.206902e+04    0.000e+00    2.165e+03
User objective function returned Inf; trying a new point...
    1      39    1.046368e+04    0.000e+00    5.120e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.556657e+03    0.000e+00    2.970e+02    9.999e-01
User objective function returned Inf; trying a new point...
    3      81    8.378725e+03    0.000e+00    8.952e+02    4.999e-01
User objective function returned Inf; trying a new point...
    4     100    8.275825e+03    0.000e+00    4.005e+02    1.750e+00
User objective function returned Inf; trying a new point...
    5     123    8.267691e+03    0.000e+00    4.418e+02    8.749e-01
User objective function returned Inf; trying a new point...
    6     141    8.249056e+03    0.000e+00    3.042e+02    8.749e-01
User objective function returned Inf; trying a new point...
    7     162    8.184452e+03    0.000e+00    3.595e+02    1.750e+00
User objective function returned Inf; trying a new point...
    8     182    8.155414e+03    0.000e+00    3.664e+02    4.375e-01
User objective function returned Inf; trying a new point...
    9     203    7.996640e+03    0.000e+00    1.381e+02    8.749e-01
User objective function returned Inf; trying a new point...
   10     228    7.971150e+03    0.000e+00    3.873e+02    3.828e-01
User objective function returned Inf; trying a new point...
   11     247    7.952136e+03    0.000e+00    2.535e+02    3.828e-01
User objective function returned Inf; trying a new point...
   12     268    7.942984e+03    0.000e+00    2.894e+02    7.655e-01
User objective function returned Inf; trying a new point...
   13     288    7.937772e+03    0.000e+00    9.979e+01    1.914e-01
User objective function returned Inf; trying a new point...
   14     309    7.918962e+03    0.000e+00    1.396e+02    3.828e-01
User objective function returned Inf; trying a new point...
   15     333    7.917055e+03    0.000e+00    1.465e+02    9.569e-02
User objective function returned Inf; trying a new point...
   16     351    7.916072e+03    0.000e+00    1.193e+02    1.914e-01
User objective function returned Inf; trying a new point...
   17     373    7.915211e+03    0.000e+00    4.886e+01    1.914e-01
User objective function returned Inf; trying a new point...
   18     392    7.915113e+03    0.000e+00    9.535e+01    9.569e-02
   19     414    7.912869e+03    0.000e+00    5.834e+01    9.569e-02
   20     439    7.912627e+03    0.000e+00    4.813e+01    4.187e-02
   21     458    7.912512e+03    0.000e+00    4.732e+01    4.187e-02
   22     479    7.912049e+03    0.000e+00    3.938e+01    8.373e-02
   23     498    7.911603e+03    0.000e+00    3.466e+01    8.373e-02
User objective function returned Inf; trying a new point...
   24     520    7.909759e+03    0.000e+00    2.756e+01    8.373e-02
User objective function returned Inf; trying a new point...
   25     540    7.909380e+03    0.000e+00    3.327e+01    1.465e-01
   26     562    7.908451e+03    0.000e+00    3.991e+01    1.465e-01
User objective function returned Inf; trying a new point...
   27     581    7.908437e+03    0.000e+00    8.754e+01    1.465e-01
   28     603    7.907941e+03    0.000e+00    3.675e+01    1.465e-01
User objective function returned Inf; trying a new point...
   29     623    7.907748e+03    0.000e+00    5.319e+01    3.663e-02
   30     644    7.907120e+03    0.000e+00    1.058e+01    7.327e-02

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     667    7.907101e+03    0.000e+00    1.433e+01    3.663e-02
   32     687    7.907096e+03    0.000e+00    1.140e+01    9.158e-03
   33     708    7.907036e+03    0.000e+00    3.479e+00    1.832e-02
   34     732    7.907033e+03    0.000e+00    2.397e+00    1.603e-02
   35     756    7.907032e+03    0.000e+00    6.771e-01    4.007e-03
   36     775    7.907031e+03    0.000e+00    5.550e-01    2.972e-03
   37     793    7.907031e+03    0.000e+00    5.925e-01    3.025e-03
   38     810    7.907031e+03    0.000e+00    1.466e-02    1.207e-03
   39     827    7.907031e+03    0.000e+00    8.470e-03    8.080e-05

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',3.400493e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 1.7407 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

   -0.0044
   -0.0068
   -0.0018
   -0.0030
   -0.0017
   -0.0002
   -0.0085
    0.0026
    0.0002
    0.0018
    0.0017
    0.0014
    0.0004
    0.0009
   -0.0005
    0.0005

Value of the log-likelihood function at convergence: -7907.0308
 
                      AIC                      BIC
              ------------------   -----------------------
                  15846.0617               15916.4125
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 4.5441e-08
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS          0.7010     0.0522    13.4219
A_SnGo         0.1714     0.0342     5.0183
A_AgeLT40      0.4021     0.0517     7.7760
A_ExpLT8       0.6710     0.0535    12.5490
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1          -1.1094     0.1197    -9.2684
Bc_2          -1.4231     0.1211   -11.7544
LV_Load        1.0057     0.0493    20.3971
Mu_12         -0.3170     0.0489    -6.4859
Mu_13         -0.6038     0.0535   -11.2865
Mu_14         -0.7277     0.0588   -12.3819
Mu_22         -0.6550     0.0553   -11.8485
Mu_23         -0.5526     0.0520   -10.6286
Mu_24         -0.8455     0.0640   -13.2207
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -0.9131     0.0371   -24.6340
C_VRC         -0.6545     0.0573   -11.4200
C_LV          -0.6081     0.0854    -7.1163
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    2.0115    1.0115
    1.0115    2.0115

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

    0.7010    0.1714    0.4021    0.6710   -1.1094   -1.4231    1.0057   -0.3170   -0.6038   -0.7277   -0.6550

  Columns 12 through 16

   -0.5526   -0.8455   -0.9131   -0.6545   -0.6081

The covariance matrix for these parameters is:

ihess =

  Columns 1 through 11

    0.0027    0.0001    0.0003    0.0003   -0.0035   -0.0034   -0.0010   -0.0003   -0.0003   -0.0003   -0.0003
    0.0001    0.0012    0.0002   -0.0000   -0.0021   -0.0020   -0.0003   -0.0001   -0.0001   -0.0001   -0.0001
    0.0003    0.0002    0.0027    0.0003   -0.0012   -0.0011   -0.0006   -0.0002   -0.0001   -0.0002   -0.0002
    0.0003   -0.0000    0.0003    0.0029   -0.0005   -0.0004   -0.0008   -0.0003   -0.0002   -0.0002   -0.0002
   -0.0035   -0.0021   -0.0012   -0.0005    0.0143    0.0131   -0.0012    0.0000   -0.0002   -0.0004   -0.0008
   -0.0034   -0.0020   -0.0011   -0.0004    0.0131    0.0147   -0.0015   -0.0009   -0.0007   -0.0008   -0.0001
   -0.0010   -0.0003   -0.0006   -0.0008   -0.0012   -0.0015    0.0024    0.0010    0.0009    0.0010    0.0010
   -0.0003   -0.0001   -0.0002   -0.0003    0.0000   -0.0009    0.0010    0.0024    0.0001    0.0002    0.0004
   -0.0003   -0.0001   -0.0001   -0.0002   -0.0002   -0.0007    0.0009    0.0001    0.0029    0.0000    0.0004
   -0.0003   -0.0001   -0.0002   -0.0002   -0.0004   -0.0008    0.0010    0.0002    0.0000    0.0035    0.0005
   -0.0003   -0.0001   -0.0002   -0.0002   -0.0008   -0.0001    0.0010    0.0004    0.0004    0.0005    0.0031
   -0.0003   -0.0001   -0.0002   -0.0003   -0.0007   -0.0004    0.0009    0.0004    0.0004    0.0004    0.0001
   -0.0003   -0.0001   -0.0001   -0.0002   -0.0007   -0.0005    0.0010    0.0004    0.0004    0.0005    0.0002
    0.0001    0.0000    0.0001    0.0000   -0.0001   -0.0001   -0.0001   -0.0000   -0.0000   -0.0000   -0.0000
    0.0001    0.0000    0.0000    0.0000   -0.0000   -0.0000   -0.0001   -0.0000   -0.0000   -0.0000    0.0000
    0.0023    0.0005    0.0005    0.0002   -0.0035   -0.0034   -0.0010   -0.0004   -0.0004   -0.0003   -0.0003

  Columns 12 through 16

   -0.0003   -0.0003    0.0001    0.0001    0.0023
   -0.0001   -0.0001    0.0000    0.0000    0.0005
   -0.0002   -0.0001    0.0001    0.0000    0.0005
   -0.0003   -0.0002    0.0000    0.0000    0.0002
   -0.0007   -0.0007   -0.0001   -0.0000   -0.0035
   -0.0004   -0.0005   -0.0001   -0.0000   -0.0034
    0.0009    0.0010   -0.0001   -0.0001   -0.0010
    0.0004    0.0004   -0.0000   -0.0000   -0.0004
    0.0004    0.0004   -0.0000   -0.0000   -0.0004
    0.0004    0.0005   -0.0000   -0.0000   -0.0003
    0.0001    0.0002   -0.0000    0.0000   -0.0003
    0.0027    0.0001    0.0000   -0.0000   -0.0002
    0.0001    0.0041    0.0000    0.0001   -0.0002
    0.0000    0.0000    0.0014    0.0008    0.0005
   -0.0000    0.0001    0.0008    0.0033    0.0005
   -0.0002   -0.0002    0.0005    0.0005    0.0073

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 38 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.322632e+04    0.000e+00    2.819e+03
User objective function returned Inf; trying a new point...
    1      39    9.869851e+03    0.000e+00    4.376e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.523993e+03    0.000e+00    1.369e+03    9.999e-01
User objective function returned Inf; trying a new point...
    3      80    8.436268e+03    0.000e+00    9.921e+02    9.999e-01
User objective function returned Inf; trying a new point...
    4      98    8.146245e+03    0.000e+00    1.328e+03    9.999e-01
User objective function returned Inf; trying a new point...
    5     121    8.055643e+03    0.000e+00    9.964e+02    5.000e-01
User objective function returned Inf; trying a new point...
    6     139    8.030527e+03    0.000e+00    1.181e+03    9.999e-01
User objective function returned Inf; trying a new point...
    7     162    7.958404e+03    0.000e+00    6.947e+02    5.000e-01
User objective function returned Inf; trying a new point...
    8     181    7.943132e+03    0.000e+00    6.634e+02    2.500e-01
User objective function returned Inf; trying a new point...
    9     202    7.846486e+03    0.000e+00    3.760e+02    5.000e-01
User objective function returned Inf; trying a new point...
   10     228    7.840398e+03    0.000e+00    6.430e+02    1.094e-01
User objective function returned Inf; trying a new point...
   11     246    7.834746e+03    0.000e+00    6.931e+02    1.094e-01
User objective function returned Inf; trying a new point...
   12     267    7.787745e+03    0.000e+00    1.134e+02    2.187e-01
User objective function returned Inf; trying a new point...
   13     289    7.778859e+03    0.000e+00    9.282e+02    7.655e-01
User objective function returned Inf; trying a new point...
   14     309    7.778303e+03    0.000e+00    1.080e+03    1.914e-01
User objective function returned Inf; trying a new point...
   15     330    7.737068e+03    0.000e+00    1.220e+02    2.261e-01
User objective function returned Inf; trying a new point...
   16     349    7.735260e+03    0.000e+00    9.594e+01    2.261e-01
User objective function returned Inf; trying a new point...
   17     370    7.723908e+03    0.000e+00    6.712e+01    4.523e-01
User objective function returned Inf; trying a new point...
   18     389    7.719143e+03    0.000e+00    1.260e+02    4.523e-01
User objective function returned Inf; trying a new point...
   19     411    7.719033e+03    0.000e+00    1.043e+02    4.523e-01
User objective function returned Inf; trying a new point...
   20     431    7.718022e+03    0.000e+00    1.102e+02    1.131e-01
User objective function returned Inf; trying a new point...
   21     452    7.707003e+03    0.000e+00    6.569e+01    2.261e-01
User objective function returned Inf; trying a new point...
   22     477    7.705672e+03    0.000e+00    4.579e+01    9.894e-02
User objective function returned Inf; trying a new point...
   23     496    7.705495e+03    0.000e+00    8.004e+01    9.894e-02
   24     517    7.704500e+03    0.000e+00    9.159e+01    1.979e-01
User objective function returned Inf; trying a new point...
   25     537    7.703731e+03    0.000e+00    1.418e+02    9.894e-02
   26     559    7.702396e+03    0.000e+00    1.040e+02    9.894e-02
User objective function returned Inf; trying a new point...
   27     578    7.701650e+03    0.000e+00    2.501e+02    9.894e-02
   28     599    7.701336e+03    0.000e+00    2.635e+02    1.979e-01
User objective function returned Inf; trying a new point...
   29     617    7.696859e+03    0.000e+00    2.820e+02    1.979e-01
User objective function returned Inf; trying a new point...
   30     638    7.692934e+03    0.000e+00    3.612e+02    3.958e-01
User objective function returned Inf; trying a new point...

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     658    7.690505e+03    0.000e+00    2.905e+02    1.979e-01
   32     679    7.689945e+03    0.000e+00    6.630e+01    3.958e-01
User objective function returned Inf; trying a new point...
   33     697    7.688543e+03    0.000e+00    2.632e+02    3.958e-01
   34     715    7.680314e+03    0.000e+00    2.093e+02    2.166e-01
   35     733    7.675449e+03    0.000e+00    1.454e+02    1.859e-01
   36     750    7.674246e+03    0.000e+00    1.804e+02    7.523e-02
   37     767    7.672495e+03    0.000e+00    1.151e+02    9.202e-02
   38     784    7.671633e+03    0.000e+00    4.403e+01    5.107e-02
   39     801    7.671264e+03    0.000e+00    2.145e+01    8.380e-02
   40     818    7.671222e+03    0.000e+00    2.031e+01    4.036e-02
   41     835    7.671199e+03    0.000e+00    9.780e-01    1.261e-02
   42     852    7.671198e+03    0.000e+00    6.927e-01    4.352e-03
   43     869    7.671198e+03    0.000e+00    3.602e-01    1.190e-03
   44     886    7.671197e+03    0.000e+00    5.935e-02    1.250e-03
   45     903    7.671197e+03    0.000e+00    2.260e-03    4.802e-05

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',1.894403e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 1.8006 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

   -0.0001
    0.0016
    0.0006
    0.0008
    0.0005
   -0.0007
    0.0022
   -0.0001
   -0.0005
    0.0002
    0.0015
    0.0005
    0.0007
         0
    0.0015
   -0.0023

Value of the log-likelihood function at convergence: -7671.1975
 
                      AIC                      BIC
              ------------------   -----------------------
                  15374.3950               15444.7459
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 4.6746e-08
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS          0.7448     0.0545    13.6714
A_SnGo         0.2908     0.0401     7.2596
A_AgeLT40      0.7866     0.0578    13.6141
A_ExpLT8       0.8263     0.0596    13.8751
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1          -1.3135     0.1246   -10.5403
Bc_2          -1.5361     0.1246   -12.3327
LV_Load        0.9588     0.0433    22.1180
Mu_12         -0.4595     0.0537    -8.5551
Mu_13         -0.6634     0.0578   -11.4804
Mu_14         -0.5830     0.0538   -10.8419
Mu_22         -0.7211     0.0597   -12.0829
Mu_23         -0.5236     0.0510   -10.2630
Mu_24         -0.6865     0.0562   -12.2182
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -0.9054     0.0393   -23.0233
C_VRC         -1.1033     0.0673   -16.3977
C_LV          -0.4662     0.0700    -6.6624
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    1.9193    0.9193
    0.9193    1.9193

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

    0.7448    0.2908    0.7866    0.8263   -1.3135   -1.5361    0.9588   -0.4595   -0.6634   -0.5830   -0.7211

  Columns 12 through 16

   -0.5236   -0.6865   -0.9054   -1.1033   -0.4662

The covariance matrix for these parameters is:

ihess =

  Columns 1 through 11

    0.0030    0.0001    0.0005    0.0003   -0.0035   -0.0035   -0.0009   -0.0002   -0.0003   -0.0002   -0.0002
    0.0001    0.0016    0.0004    0.0002   -0.0028   -0.0027   -0.0003   -0.0001   -0.0001   -0.0001   -0.0001
    0.0005    0.0004    0.0033    0.0006   -0.0011   -0.0010   -0.0009   -0.0002   -0.0003   -0.0002   -0.0001
    0.0003    0.0002    0.0006    0.0035   -0.0006   -0.0004   -0.0011   -0.0003   -0.0003   -0.0004   -0.0004
   -0.0035   -0.0028   -0.0011   -0.0006    0.0155    0.0143   -0.0010    0.0002   -0.0003   -0.0003   -0.0005
   -0.0035   -0.0027   -0.0010   -0.0004    0.0143    0.0155   -0.0012   -0.0008   -0.0009   -0.0008    0.0002
   -0.0009   -0.0003   -0.0009   -0.0011   -0.0010   -0.0012    0.0019    0.0008    0.0008    0.0008    0.0007
   -0.0002   -0.0001   -0.0002   -0.0003    0.0002   -0.0008    0.0008    0.0029   -0.0001    0.0001    0.0003
   -0.0003   -0.0001   -0.0003   -0.0003   -0.0003   -0.0009    0.0008   -0.0001    0.0033    0.0000    0.0003
   -0.0002   -0.0001   -0.0002   -0.0004   -0.0003   -0.0008    0.0008    0.0001    0.0000    0.0029    0.0003
   -0.0002   -0.0001   -0.0001   -0.0004   -0.0005    0.0002    0.0007    0.0003    0.0003    0.0003    0.0036
   -0.0003   -0.0001   -0.0002   -0.0003   -0.0007   -0.0003    0.0008    0.0003    0.0003    0.0004   -0.0001
   -0.0002   -0.0001   -0.0002   -0.0003   -0.0008   -0.0006    0.0008    0.0002    0.0004    0.0003    0.0000
    0.0000    0.0000   -0.0000    0.0001   -0.0000   -0.0000   -0.0000    0.0000   -0.0001   -0.0000   -0.0000
    0.0002   -0.0000    0.0001    0.0000    0.0000    0.0000   -0.0001    0.0001   -0.0001   -0.0001    0.0001
    0.0010    0.0010    0.0002    0.0002   -0.0039   -0.0039   -0.0000    0.0000   -0.0000   -0.0000    0.0000

  Columns 12 through 16

   -0.0003   -0.0002    0.0000    0.0002    0.0010
   -0.0001   -0.0001    0.0000   -0.0000    0.0010
   -0.0002   -0.0002   -0.0000    0.0001    0.0002
   -0.0003   -0.0003    0.0001    0.0000    0.0002
   -0.0007   -0.0008   -0.0000    0.0000   -0.0039
   -0.0003   -0.0006   -0.0000    0.0000   -0.0039
    0.0008    0.0008   -0.0000   -0.0001   -0.0000
    0.0003    0.0002    0.0000    0.0001    0.0000
    0.0003    0.0004   -0.0001   -0.0001   -0.0000
    0.0004    0.0003   -0.0000   -0.0001   -0.0000
   -0.0001    0.0000   -0.0000    0.0001    0.0000
    0.0026    0.0001   -0.0000   -0.0000    0.0000
    0.0001    0.0032   -0.0001   -0.0001    0.0000
   -0.0000   -0.0001    0.0015    0.0013    0.0004
   -0.0000   -0.0001    0.0013    0.0045    0.0007
    0.0000    0.0000    0.0004    0.0007    0.0049

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 39 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.276206e+04    0.000e+00    2.572e+03
User objective function returned Inf; trying a new point...
    1      39    1.009475e+04    0.000e+00    4.668e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.440329e+03    0.000e+00    7.783e+02    9.999e-01
User objective function returned Inf; trying a new point...
    3      81    8.327405e+03    0.000e+00    1.229e+03    4.999e-01
User objective function returned Inf; trying a new point...
    4      99    8.200720e+03    0.000e+00    1.520e+03    9.999e-01
User objective function returned Inf; trying a new point...
    5     121    8.171382e+03    0.000e+00    3.761e+02    9.999e-01
User objective function returned Inf; trying a new point...
    6     141    8.148242e+03    0.000e+00    1.988e+02    2.500e-01
User objective function returned Inf; trying a new point...
    7     162    8.068859e+03    0.000e+00    2.801e+02    4.999e-01
User objective function returned Inf; trying a new point...
    8     185    8.042117e+03    0.000e+00    8.520e+02    8.749e-01
User objective function returned Inf; trying a new point...
    9     204    8.035088e+03    0.000e+00    1.065e+03    4.375e-01
User objective function returned Inf; trying a new point...
   10     226    7.977436e+03    0.000e+00    1.909e+02    4.375e-01
User objective function returned Inf; trying a new point...
   11     245    7.972901e+03    0.000e+00    1.969e+02    4.375e-01
User objective function returned Inf; trying a new point...
   12     267    7.940386e+03    0.000e+00    3.515e+02    4.375e-01
User objective function returned Inf; trying a new point...
   13     286    7.934432e+03    0.000e+00    1.959e+02    4.375e-01
User objective function returned Inf; trying a new point...
   14     308    7.907233e+03    0.000e+00    1.123e+02    4.375e-01
User objective function returned Inf; trying a new point...
   15     327    7.898736e+03    0.000e+00    8.255e+01    4.375e-01
User objective function returned Inf; trying a new point...
   16     350    7.889449e+03    0.000e+00    1.531e+02    2.187e-01
User objective function returned Inf; trying a new point...
   17     369    7.887108e+03    0.000e+00    7.225e+01    2.187e-01
User objective function returned Inf; trying a new point...
   18     391    7.876199e+03    0.000e+00    8.301e+01    2.187e-01
User objective function returned Inf; trying a new point...
   19     416    7.875813e+03    0.000e+00    6.074e+01    9.569e-02
User objective function returned Inf; trying a new point...
   20     434    7.874964e+03    0.000e+00    4.218e+01    9.569e-02
User objective function returned Inf; trying a new point...
   21     455    7.873576e+03    0.000e+00    5.480e+01    1.914e-01
User objective function returned Inf; trying a new point...
   22     473    7.872988e+03    0.000e+00    6.701e+01    3.828e-01
User objective function returned Inf; trying a new point...
   23     496    7.871222e+03    0.000e+00    1.401e+02    1.914e-01
   24     519    7.869792e+03    0.000e+00    6.857e+01    9.569e-02
User objective function returned Inf; trying a new point...
   25     537    7.868290e+03    0.000e+00    6.598e+01    1.914e-01
User objective function returned Inf; trying a new point...
   26     558    7.865876e+03    0.000e+00    4.833e+01    3.828e-01
User objective function returned Inf; trying a new point...
   27     577    7.865777e+03    0.000e+00    5.189e+01    3.828e-01
User objective function returned Inf; trying a new point...
   28     600    7.862327e+03    0.000e+00    7.053e+01    1.914e-01
User objective function returned Inf; trying a new point...
   29     623    7.861686e+03    0.000e+00    3.458e+01    9.569e-02
   30     642    7.861434e+03    0.000e+00    1.408e+01    9.569e-02

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     662    7.861311e+03    0.000e+00    3.009e+02    1.888e+00
User objective function returned Inf; trying a new point...
   32     687    7.855569e+03    0.000e+00    1.404e+02    2.360e-01
User objective function returned Inf; trying a new point...
   33     705    7.855543e+03    0.000e+00    1.778e+02    4.720e-01
   34     724    7.853886e+03    0.000e+00    1.492e+02    4.298e-01
   35     742    7.850756e+03    0.000e+00    2.954e+02    1.458e+00
   36     759    7.847743e+03    0.000e+00    1.998e+02    8.764e-01
   37     776    7.846433e+03    0.000e+00    2.714e+02    1.064e+00
   38     793    7.844832e+03    0.000e+00    1.454e+02    1.013e+00
   39     810    7.843111e+03    0.000e+00    2.181e+02    1.328e+00
   40     827    7.842279e+03    0.000e+00    2.654e+02    1.562e+00
   41     844    7.840915e+03    0.000e+00    1.508e+02    1.684e+00
   42     861    7.839744e+03    0.000e+00    3.148e+02    3.147e+00
   43     879    7.839353e+03    0.000e+00    4.182e+02    2.826e+00
   44     896    7.838627e+03    0.000e+00    5.267e+02    2.326e+00
   45     913    7.837662e+03    0.000e+00    5.134e+01    2.347e+00
   46     931    7.837332e+03    0.000e+00    2.400e+02    2.859e+00
   47     948    7.836830e+03    0.000e+00    3.020e+02    4.082e+00
   48     965    7.836136e+03    0.000e+00    1.845e+02    6.341e+00
   49     982    7.836117e+03    0.000e+00    9.331e+02    9.414e+00
   50     999    7.835910e+03    0.000e+00    8.362e+02    1.354e+00
   51    1016    7.835879e+03    0.000e+00    7.552e+02    4.366e-01
   52    1033    7.835394e+03    0.000e+00    1.972e+02    4.629e+00
   53    1050    7.835249e+03    0.000e+00    2.965e+02    4.325e+00
   54    1067    7.834968e+03    0.000e+00    3.445e+02    7.338e+00
   55    1084    7.834913e+03    0.000e+00    1.032e+03    1.250e+01
   56    1101    7.834782e+03    0.000e+00    6.789e+02    1.559e+00
   57    1118    7.834567e+03    0.000e+00    4.035e+02    2.179e+00
   58    1135    7.834473e+03    0.000e+00    4.081e+02    5.824e+00
   59    1152    7.834415e+03    0.000e+00    1.323e+02    1.648e+00
   60    1169    7.834321e+03    0.000e+00    3.091e+01    5.828e+00

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   61    1186    7.834316e+03    0.000e+00    1.375e+01    3.085e-01
   62    1203    7.834316e+03    0.000e+00    2.815e+00    2.807e-02
   63    1220    7.834316e+03    0.000e+00    1.149e+00    3.305e-03
   64    1237    7.834317e+03    0.000e+00    3.927e-01    1.427e-02
   65    1254    7.834317e+03    0.000e+00    1.447e-02    6.845e-04

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',7.350717e-06,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 2.5728 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

    0.0107
    0.0048
   -0.0001
   -0.0003
   -0.0001
   -0.0003
   -0.0003
    0.0002
    0.0005
    0.0001
    0.0004
   -0.0003
    0.0003
         0
    0.0005
   -0.0140

Value of the log-likelihood function at convergence: -7834.3166
 
                      AIC                      BIC
              ------------------   -----------------------
                  15700.6333               15770.9841
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 0.46513
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS         -0.0057     0.0031    -1.8585
A_SnGo        -0.0001     0.0005    -0.2242
A_AgeLT40      0.0582     0.0563     1.0333
A_ExpLT8       1.1152     0.0621    17.9662
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1           0.4786     0.0558     8.5751
Bc_2           0.2499     0.0541     4.6188
LV_Load        0.9828     0.0493    19.9444
Mu_12         -0.6927     0.0603   -11.4777
Mu_13         -0.3609     0.0497    -7.2602
Mu_14         -0.7770     0.0613   -12.6792
Mu_22         -0.5932     0.0575   -10.3097
Mu_23         -0.7601     0.0589   -12.9149
Mu_24         -0.7775     0.0624   -12.4519
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -0.8040     0.0338   -23.8101
C_VRC         -0.6661     0.0572   -11.6529
C_LV          93.1147    48.6905     1.9124
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    1.9660    0.9660
    0.9660    1.9660

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

   -0.0057   -0.0001    0.0582    1.1152    0.4786    0.2499    0.9828   -0.6927   -0.3609   -0.7770   -0.5932

  Columns 12 through 16

   -0.7601   -0.7775   -0.8040   -0.6661   93.1147

The covariance matrix for these parameters is:

ihess =

   1.0e+03 *

  Columns 1 through 11

    0.0000    0.0000   -0.0000    0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000
    0.0000    0.0000    0.0000    0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000
   -0.0000    0.0000    0.0000   -0.0000   -0.0000   -0.0000    0.0000   -0.0000   -0.0000   -0.0000    0.0000
    0.0000    0.0000   -0.0000    0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000
   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000   -0.0000    0.0000    0.0000    0.0000
   -0.0000   -0.0000    0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
   -0.0000   -0.0000   -0.0000   -0.0000    0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
   -0.0000   -0.0000    0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
   -0.0000    0.0000    0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
   -0.0000   -0.0000    0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000   -0.0000    0.0000    0.0000    0.0000
    0.0000   -0.0000    0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000   -0.0000   -0.0000    0.0000
    0.0001    0.0000   -0.0000    0.0002   -0.0002   -0.0002   -0.0003   -0.0001   -0.0001   -0.0001   -0.0001

  Columns 12 through 16

   -0.0000   -0.0000    0.0000    0.0000    0.0001
    0.0000   -0.0000   -0.0000   -0.0000    0.0000
    0.0000    0.0000   -0.0000    0.0000   -0.0000
   -0.0000   -0.0000   -0.0000   -0.0000    0.0002
    0.0000    0.0000   -0.0000   -0.0000   -0.0002
    0.0000    0.0000    0.0000    0.0000   -0.0002
    0.0000    0.0000    0.0000    0.0000   -0.0003
    0.0000    0.0000   -0.0000    0.0000   -0.0001
    0.0000    0.0000    0.0000   -0.0000   -0.0001
    0.0000    0.0000    0.0000   -0.0000   -0.0001
    0.0000    0.0000    0.0000    0.0000   -0.0001
    0.0000    0.0000    0.0000    0.0000   -0.0001
    0.0000    0.0000    0.0000    0.0000   -0.0002
    0.0000    0.0000    0.0000    0.0000    0.0001
    0.0000    0.0000    0.0000    0.0000    0.0001
   -0.0001   -0.0002    0.0001    0.0001    2.3708

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 40 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.266176e+04    0.000e+00    2.525e+03
User objective function returned Inf; trying a new point...
    1      39    1.041938e+04    0.000e+00    4.897e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.735555e+03    0.000e+00    5.291e+02    9.999e-01
User objective function returned Inf; trying a new point...
    3      81    8.668468e+03    0.000e+00    1.557e+03    4.999e-01
User objective function returned Inf; trying a new point...
    4      99    8.543665e+03    0.000e+00    1.649e+03    5.000e-01
User objective function returned Inf; trying a new point...
    5     120    8.497394e+03    0.000e+00    7.237e+02    9.999e-01
User objective function returned Inf; trying a new point...
    6     140    8.484610e+03    0.000e+00    8.036e+02    2.500e-01
User objective function returned Inf; trying a new point...
    7     161    8.366697e+03    0.000e+00    8.817e+02    4.999e-01
User objective function returned Inf; trying a new point...
    8     180    8.354699e+03    0.000e+00    8.954e+02    4.999e-01
User objective function returned Inf; trying a new point...
    9     201    8.353896e+03    0.000e+00    1.007e+03    9.999e-01
User objective function returned Inf; trying a new point...
   10     221    8.351486e+03    0.000e+00    9.802e+02    2.500e-01
User objective function returned Inf; trying a new point...
   11     242    8.254650e+03    0.000e+00    2.206e+02    5.000e-01
User objective function returned Inf; trying a new point...
   12     261    8.252932e+03    0.000e+00    2.770e+02    4.999e-01
User objective function returned Inf; trying a new point...
   13     283    8.220872e+03    0.000e+00    2.823e+02    4.999e-01
User objective function returned Inf; trying a new point...
   14     302    8.218920e+03    0.000e+00    2.946e+02    4.999e-01
User objective function returned Inf; trying a new point...
   15     324    8.172268e+03    0.000e+00    1.337e+02    5.000e-01
User objective function returned Inf; trying a new point...
   16     343    8.154269e+03    0.000e+00    1.494e+02    4.999e-01
User objective function returned Inf; trying a new point...
   17     365    8.124527e+03    0.000e+00    1.959e+02    4.999e-01
User objective function returned Inf; trying a new point...
   18     385    8.123741e+03    0.000e+00    2.943e+02    2.500e-01
User objective function returned Inf; trying a new point...
   19     407    8.104462e+03    0.000e+00    5.802e+01    2.500e-01
User objective function returned Inf; trying a new point...
   20     427    8.102291e+03    0.000e+00    8.161e+01    4.375e-01
User objective function returned Inf; trying a new point...
   21     448    8.087443e+03    0.000e+00    2.174e+02    8.749e-01
User objective function returned Inf; trying a new point...
   22     468    8.077605e+03    0.000e+00    3.303e+02    4.375e-01
User objective function returned Inf; trying a new point...
   23     490    8.021601e+03    0.000e+00    9.379e+01    4.375e-01
User objective function returned Inf; trying a new point...
   24     514    8.014812e+03    0.000e+00    2.397e+02    3.828e-01
User objective function returned Inf; trying a new point...
   25     533    8.011466e+03    0.000e+00    1.788e+02    1.914e-01
User objective function returned Inf; trying a new point...
   26     554    8.001425e+03    0.000e+00    1.757e+02    3.828e-01
User objective function returned Inf; trying a new point...
   27     574    7.999578e+03    0.000e+00    1.556e+02    1.914e-01
User objective function returned Inf; trying a new point...
   28     595    7.997769e+03    0.000e+00    4.074e+01    3.828e-01
User objective function returned Inf; trying a new point...
   29     614    7.997223e+03    0.000e+00    8.278e+01    1.914e-01
   30     636    7.990326e+03    0.000e+00    1.519e+01    1.914e-01

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     660    7.989361e+03    0.000e+00    2.005e+01    1.150e-01
   32     684    7.989300e+03    0.000e+00    1.865e+01    1.006e-01
User objective function returned Inf; trying a new point...
   33     702    7.989290e+03    0.000e+00    6.361e+01    1.006e-01
   34     719    7.988923e+03    0.000e+00    7.806e+00    5.650e-02
   35     736    7.988905e+03    0.000e+00    9.718e+00    7.965e-03
   36     753    7.988892e+03    0.000e+00    1.082e+01    7.172e-03
   37     770    7.988847e+03    0.000e+00    1.030e+01    2.061e-02
   38     787    7.988803e+03    0.000e+00    8.133e+00    1.380e-02
   39     804    7.988772e+03    0.000e+00    2.050e+00    1.854e-02
   40     821    7.988767e+03    0.000e+00    4.877e-01    1.056e-02
   41     838    7.988767e+03    0.000e+00    1.626e-01    2.532e-03
   42     855    7.988767e+03    0.000e+00    1.280e-02    4.268e-04
   43     872    7.988767e+03    0.000e+00    1.343e-03    4.995e-05

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',3.152716e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 1.8882 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

   -0.0006
    0.0013
    0.0004
    0.0005
   -0.0001
   -0.0004
    0.0010
   -0.0001
   -0.0001
   -0.0007
   -0.0006
   -0.0002
   -0.0001
   -0.0002
    0.0004
   -0.0005

Value of the log-likelihood function at convergence: -7988.7666
 
                      AIC                      BIC
              ------------------   -----------------------
                  16009.5332               16079.8841
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 1.078e-08
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS          0.6167     0.0537    11.4787
A_SnGo         0.1613     0.0331     4.8775
A_AgeLT40      0.9745     0.0590    16.5262
A_ExpLT8       0.5038     0.0547     9.2169
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1          -0.7174     0.1137    -6.3111
Bc_2          -0.8527     0.1147    -7.4330
LV_Load        0.8962     0.0463    19.3700
Mu_12         -0.3871     0.0508    -7.6143
Mu_13         -0.5081     0.0532    -9.5591
Mu_14         -0.7801     0.0589   -13.2394
Mu_22         -0.4801     0.0544    -8.8304
Mu_23         -0.5954     0.0532   -11.1978
Mu_24         -0.5495     0.0512   -10.7258
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -0.8546     0.0358   -23.8785
C_VRC         -0.7830     0.0582   -13.4544
C_LV          -0.6536     0.1090    -5.9945
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    1.8031    0.8031
    0.8031    1.8031

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

    0.6167    0.1613    0.9745    0.5038   -0.7174   -0.8527    0.8962   -0.3871   -0.5081   -0.7801   -0.4801

  Columns 12 through 16

   -0.5954   -0.5495   -0.8546   -0.7830   -0.6536

The covariance matrix for these parameters is:

ihess =

  Columns 1 through 11

    0.0029    0.0003    0.0007    0.0003   -0.0039   -0.0040   -0.0009   -0.0003   -0.0003   -0.0002   -0.0003
    0.0003    0.0011    0.0003    0.0001   -0.0021   -0.0020   -0.0003   -0.0001   -0.0001   -0.0000   -0.0001
    0.0007    0.0003    0.0035    0.0005   -0.0008   -0.0007   -0.0015   -0.0005   -0.0005   -0.0005   -0.0005
    0.0003    0.0001    0.0005    0.0030   -0.0008   -0.0008   -0.0008   -0.0002   -0.0003   -0.0002   -0.0002
   -0.0039   -0.0021   -0.0008   -0.0008    0.0129    0.0115   -0.0007    0.0004    0.0002   -0.0006   -0.0006
   -0.0040   -0.0020   -0.0007   -0.0008    0.0115    0.0132   -0.0008   -0.0006   -0.0005   -0.0008    0.0004
   -0.0009   -0.0003   -0.0015   -0.0008   -0.0007   -0.0008    0.0021    0.0009    0.0009    0.0009    0.0009
   -0.0003   -0.0001   -0.0005   -0.0002    0.0004   -0.0006    0.0009    0.0026    0.0001    0.0002    0.0004
   -0.0003   -0.0001   -0.0005   -0.0003    0.0002   -0.0005    0.0009    0.0001    0.0028    0.0000    0.0002
   -0.0002   -0.0000   -0.0005   -0.0002   -0.0006   -0.0008    0.0009    0.0002    0.0000    0.0035    0.0003
   -0.0003   -0.0001   -0.0005   -0.0002   -0.0006    0.0004    0.0009    0.0004    0.0002    0.0003    0.0030
   -0.0003   -0.0001   -0.0005   -0.0003   -0.0003    0.0002    0.0009    0.0004    0.0004    0.0004    0.0001
   -0.0003   -0.0001   -0.0005   -0.0003   -0.0005   -0.0003    0.0009    0.0004    0.0004    0.0004    0.0001
    0.0000   -0.0001   -0.0000   -0.0000    0.0001    0.0001    0.0000   -0.0000    0.0000   -0.0000   -0.0000
    0.0000   -0.0002   -0.0000   -0.0001    0.0004    0.0005   -0.0000   -0.0000    0.0000    0.0000    0.0000
    0.0032    0.0010    0.0007    0.0001   -0.0056   -0.0056   -0.0007   -0.0001   -0.0003   -0.0001   -0.0002

  Columns 12 through 16

   -0.0003   -0.0003    0.0000    0.0000    0.0032
   -0.0001   -0.0001   -0.0001   -0.0002    0.0010
   -0.0005   -0.0005   -0.0000   -0.0000    0.0007
   -0.0003   -0.0003   -0.0000   -0.0001    0.0001
   -0.0003   -0.0005    0.0001    0.0004   -0.0056
    0.0002   -0.0003    0.0001    0.0005   -0.0056
    0.0009    0.0009    0.0000   -0.0000   -0.0007
    0.0004    0.0004   -0.0000   -0.0000   -0.0001
    0.0004    0.0004    0.0000    0.0000   -0.0003
    0.0004    0.0004   -0.0000    0.0000   -0.0001
    0.0001    0.0001   -0.0000    0.0000   -0.0002
    0.0028    0.0001   -0.0000    0.0000   -0.0003
    0.0001    0.0026    0.0000    0.0000   -0.0002
   -0.0000    0.0000    0.0013    0.0007    0.0005
    0.0000    0.0000    0.0007    0.0034    0.0006
   -0.0003   -0.0002    0.0005    0.0006    0.0119

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 41 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.315240e+04    0.000e+00    2.818e+03
User objective function returned Inf; trying a new point...
    1      39    9.683711e+03    0.000e+00    4.429e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.313917e+03    0.000e+00    1.465e+03    9.999e-01
User objective function returned Inf; trying a new point...
    3      80    8.271717e+03    0.000e+00    1.102e+03    9.999e-01
User objective function returned Inf; trying a new point...
    4      98    8.105489e+03    0.000e+00    1.745e+03    9.999e-01
User objective function returned Inf; trying a new point...
    5     120    8.004036e+03    0.000e+00    4.376e+02    9.999e-01
User objective function returned Inf; trying a new point...
    6     140    7.986411e+03    0.000e+00    4.419e+02    2.500e-01
User objective function returned Inf; trying a new point...
    7     161    7.869770e+03    0.000e+00    2.800e+02    4.999e-01
User objective function returned Inf; trying a new point...
    8     185    7.821564e+03    0.000e+00    5.991e+02    4.375e-01
User objective function returned Inf; trying a new point...
    9     204    7.793367e+03    0.000e+00    7.080e+02    4.375e-01
User objective function returned Inf; trying a new point...
   10     226    7.775281e+03    0.000e+00    2.701e+02    4.375e-01
User objective function returned Inf; trying a new point...
   11     244    7.757632e+03    0.000e+00    9.655e+02    8.749e-01
User objective function returned Inf; trying a new point...
   12     266    7.706687e+03    0.000e+00    5.069e+02    8.749e-01
User objective function returned Inf; trying a new point...
   13     286    7.699981e+03    0.000e+00    5.264e+02    4.375e-01
User objective function returned Inf; trying a new point...
   14     308    7.665917e+03    0.000e+00    4.676e+02    4.375e-01
User objective function returned Inf; trying a new point...
   15     328    7.661096e+03    0.000e+00    3.361e+02    2.187e-01
User objective function returned Inf; trying a new point...
   16     350    7.636590e+03    0.000e+00    1.566e+02    2.187e-01
User objective function returned Inf; trying a new point...
   17     373    7.633191e+03    0.000e+00    3.403e+02    3.828e-01
User objective function returned Inf; trying a new point...
   18     394    7.632735e+03    0.000e+00    1.389e+02    3.828e-01
User objective function returned Inf; trying a new point...
   19     413    7.628848e+03    0.000e+00    1.531e+02    1.914e-01
User objective function returned Inf; trying a new point...
   20     434    7.612281e+03    0.000e+00    2.212e+02    3.828e-01
User objective function returned Inf; trying a new point...
   21     457    7.596522e+03    0.000e+00    4.865e+01    1.914e-01
User objective function returned Inf; trying a new point...
   22     481    7.595487e+03    0.000e+00    9.958e+01    1.675e-01
User objective function returned Inf; trying a new point...
   23     501    7.595422e+03    0.000e+00    1.115e+02    4.187e-02
   24     520    7.595090e+03    0.000e+00    1.203e+02    1.663e-01
User objective function returned Inf; trying a new point...
   25     543    7.591451e+03    0.000e+00    1.300e+02    8.313e-02
User objective function returned Inf; trying a new point...
   26     562    7.590903e+03    0.000e+00    1.003e+02    8.313e-02
   27     583    7.587658e+03    0.000e+00    1.094e+02    1.663e-01
   28     605    7.586095e+03    0.000e+00    3.236e+01    1.663e-01
   29     629    7.585380e+03    0.000e+00    3.621e+01    4.156e-02
   30     648    7.585376e+03    0.000e+00    4.356e+01    4.156e-02

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     669    7.585162e+03    0.000e+00    2.445e+01    8.313e-02
   32     689    7.585150e+03    0.000e+00    2.590e+01    2.078e-02
   33     709    7.584775e+03    0.000e+00    1.879e+01    9.811e-02
   34     732    7.584680e+03    0.000e+00    1.746e+01    4.906e-02
   35     752    7.584652e+03    0.000e+00    1.653e+01    2.453e-02
   36     769    7.584500e+03    0.000e+00    1.276e+01    2.797e-02
   37     786    7.584452e+03    0.000e+00    8.850e+00    4.295e-02
   38     803    7.584362e+03    0.000e+00    5.431e+00    2.993e-02
   39     820    7.584322e+03    0.000e+00    9.444e-01    3.516e-02
   40     837    7.584321e+03    0.000e+00    1.267e-01    4.473e-03
   41     854    7.584321e+03    0.000e+00    2.300e-02    6.501e-04
   42     871    7.584321e+03    0.000e+00    6.040e-03    9.933e-05

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',4.949431e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 1.7748 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

   -0.0054
   -0.0060
   -0.0001
   -0.0006
   -0.0021
   -0.0019
   -0.0014
    0.0007
   -0.0003
    0.0001
   -0.0007
   -0.0008
    0.0007
   -0.0006
   -0.0015
   -0.0001

Value of the log-likelihood function at convergence: -7584.3212
 
                      AIC                      BIC
              ------------------   -----------------------
                  15200.6424               15270.9933
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 8.203e-08
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS          0.6117     0.0456    13.4029
A_SnGo         0.1226     0.0286     4.2896
A_AgeLT40      0.5091     0.0499    10.1940
A_ExpLT8       0.6464     0.0517    12.5067
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1          -1.0473     0.1296    -8.0790
Bc_2          -1.2169     0.1304    -9.3353
LV_Load        1.2145     0.0526    23.0955
Mu_12         -0.3483     0.0527    -6.6070
Mu_13         -0.7082     0.0610   -11.6147
Mu_14         -0.7744     0.0625   -12.3912
Mu_22         -0.3742     0.0525    -7.1313
Mu_23         -0.5706     0.0585    -9.7606
Mu_24         -0.8103     0.0653   -12.4143
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -0.8885     0.0360   -24.6640
C_VRC         -0.6544     0.0575   -11.3885
C_LV          -0.9503     0.1149    -8.2734
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    2.4749    1.4749
    1.4749    2.4749

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

    0.6117    0.1226    0.5091    0.6464   -1.0473   -1.2169    1.2145   -0.3483   -0.7082   -0.7744   -0.3742

  Columns 12 through 16

   -0.5706   -0.8103   -0.8885   -0.6544   -0.9503

The covariance matrix for these parameters is:

ihess =

  Columns 1 through 11

    0.0021    0.0002    0.0002    0.0002   -0.0037   -0.0037   -0.0010   -0.0003   -0.0004   -0.0004   -0.0002
    0.0002    0.0008    0.0001    0.0000   -0.0022   -0.0021   -0.0002   -0.0001   -0.0001   -0.0001   -0.0001
    0.0002    0.0001    0.0025    0.0003   -0.0014   -0.0014   -0.0006   -0.0002   -0.0002   -0.0002   -0.0002
    0.0002    0.0000    0.0003    0.0027   -0.0011   -0.0011   -0.0008   -0.0002   -0.0002   -0.0002   -0.0003
   -0.0037   -0.0022   -0.0014   -0.0011    0.0168    0.0152   -0.0003    0.0007    0.0003    0.0001   -0.0004
   -0.0037   -0.0021   -0.0014   -0.0011    0.0152    0.0170   -0.0005   -0.0004   -0.0003   -0.0003    0.0004
   -0.0010   -0.0002   -0.0006   -0.0008   -0.0003   -0.0005    0.0028    0.0010    0.0011    0.0012    0.0010
   -0.0003   -0.0001   -0.0002   -0.0002    0.0007   -0.0004    0.0010    0.0028    0.0001    0.0002    0.0005
   -0.0004   -0.0001   -0.0002   -0.0002    0.0003   -0.0003    0.0011    0.0001    0.0037    0.0001    0.0005
   -0.0004   -0.0001   -0.0002   -0.0002    0.0001   -0.0003    0.0012    0.0002    0.0001    0.0039    0.0005
   -0.0002   -0.0001   -0.0002   -0.0003   -0.0004    0.0004    0.0010    0.0005    0.0005    0.0005    0.0028
   -0.0004   -0.0000   -0.0001   -0.0002   -0.0003    0.0001    0.0012    0.0004    0.0006    0.0006    0.0000
   -0.0004   -0.0001   -0.0002   -0.0003   -0.0001    0.0002    0.0011    0.0004    0.0004    0.0005    0.0002
   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000   -0.0001    0.0000    0.0000   -0.0001   -0.0000    0.0001    0.0000    0.0001    0.0001    0.0001
    0.0030    0.0008    0.0004    0.0002   -0.0064   -0.0063   -0.0017   -0.0005   -0.0007   -0.0007   -0.0004

  Columns 12 through 16

   -0.0004   -0.0004   -0.0000    0.0000    0.0030
   -0.0000   -0.0001   -0.0000   -0.0001    0.0008
   -0.0001   -0.0002   -0.0000    0.0000    0.0004
   -0.0002   -0.0003   -0.0000    0.0000    0.0002
   -0.0003   -0.0001    0.0000   -0.0001   -0.0064
    0.0001    0.0002    0.0000   -0.0000   -0.0063
    0.0012    0.0011    0.0000    0.0001   -0.0017
    0.0004    0.0004    0.0000    0.0000   -0.0005
    0.0006    0.0004    0.0000    0.0001   -0.0007
    0.0006    0.0005    0.0000    0.0001   -0.0007
    0.0000    0.0002    0.0000    0.0001   -0.0004
    0.0034    0.0002   -0.0001    0.0001   -0.0007
    0.0002    0.0043   -0.0000    0.0001   -0.0008
   -0.0001   -0.0000    0.0013    0.0007    0.0007
    0.0001    0.0001    0.0007    0.0033    0.0007
   -0.0007   -0.0008    0.0007    0.0007    0.0132

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 42 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.299713e+04    0.000e+00    2.671e+03
User objective function returned Inf; trying a new point...
    1      39    1.002995e+04    0.000e+00    4.565e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.525771e+03    0.000e+00    9.817e+02    9.999e-01
User objective function returned Inf; trying a new point...
    3      80    8.515621e+03    0.000e+00    1.139e+03    9.999e-01
User objective function returned Inf; trying a new point...
    4      98    8.263617e+03    0.000e+00    1.474e+03    9.999e-01
User objective function returned Inf; trying a new point...
    5     121    8.098932e+03    0.000e+00    7.402e+02    5.000e-01
User objective function returned Inf; trying a new point...
    6     141    8.074783e+03    0.000e+00    9.360e+02    2.500e-01
User objective function returned Inf; trying a new point...
    7     162    7.996283e+03    0.000e+00    4.017e+02    5.000e-01
User objective function returned Inf; trying a new point...
    8     180    7.958834e+03    0.000e+00    8.976e+02    9.999e-01
User objective function returned Inf; trying a new point...
    9     202    7.878204e+03    0.000e+00    1.348e+03    9.999e-01
User objective function returned Inf; trying a new point...
   10     222    7.863886e+03    0.000e+00    2.858e+02    4.999e-01
User objective function returned Inf; trying a new point...
   11     244    7.805447e+03    0.000e+00    1.784e+02    5.000e-01
User objective function returned Inf; trying a new point...
   12     267    7.800297e+03    0.000e+00    2.376e+02    2.500e-01
User objective function returned Inf; trying a new point...
   13     285    7.799452e+03    0.000e+00    3.821e+02    2.500e-01
User objective function returned Inf; trying a new point...
   14     307    7.785351e+03    0.000e+00    4.497e+02    2.500e-01
User objective function returned Inf; trying a new point...
   15     325    7.783655e+03    0.000e+00    4.101e+02    4.999e-01
User objective function returned Inf; trying a new point...
   16     348    7.768284e+03    0.000e+00    1.124e+02    2.500e-01
User objective function returned Inf; trying a new point...
   17     372    7.766184e+03    0.000e+00    7.175e+01    2.187e-01
User objective function returned Inf; trying a new point...
   18     391    7.765297e+03    0.000e+00    5.793e+01    2.187e-01
   19     413    7.763393e+03    0.000e+00    7.551e+01    2.187e-01
User objective function returned Inf; trying a new point...
   20     433    7.762436e+03    0.000e+00    4.675e+01    1.094e-01
User objective function returned Inf; trying a new point...
   21     455    7.760725e+03    0.000e+00    1.127e+02    1.094e-01
User objective function returned Inf; trying a new point...
   22     475    7.760561e+03    0.000e+00    1.109e+02    5.468e-02
User objective function returned Inf; trying a new point...
   23     496    7.760448e+03    0.000e+00    6.139e+01    1.094e-01
   24     514    7.760286e+03    0.000e+00    7.541e+01    1.094e-01
   25     536    7.758627e+03    0.000e+00    4.823e+01    1.094e-01
User objective function returned Inf; trying a new point...
   26     560    7.757552e+03    0.000e+00    8.323e+01    9.569e-02
   27     580    7.757325e+03    0.000e+00    8.546e+01    4.785e-02
   28     601    7.753748e+03    0.000e+00    7.813e+01    9.569e-02
User objective function returned Inf; trying a new point...
   29     620    7.746942e+03    0.000e+00    2.436e+02    3.349e-01
User objective function returned Inf; trying a new point...
   30     643    7.740951e+03    0.000e+00    4.392e+02    1.675e-01

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     665    7.738818e+03    0.000e+00    6.479e+01    1.675e-01
   32     686    7.736654e+03    0.000e+00    2.893e+02    3.349e-01
User objective function returned Inf; trying a new point...
   33     709    7.732348e+03    0.000e+00    2.459e+02    1.675e-01
   34     732    7.730814e+03    0.000e+00    2.648e+01    8.373e-02
   35     751    7.730691e+03    0.000e+00    4.929e+01    8.373e-02
   36     773    7.728988e+03    0.000e+00    8.276e+01    8.373e-02
   37     794    7.728073e+03    0.000e+00    1.131e+02    9.970e-02
   38     818    7.727873e+03    0.000e+00    6.721e+01    8.724e-02
   39     838    7.727632e+03    0.000e+00    2.445e+01    4.362e-02
   40     855    7.727205e+03    0.000e+00    5.094e+00    7.433e-02
   41     872    7.727179e+03    0.000e+00    1.358e+00    1.715e-02
   42     889    7.727178e+03    0.000e+00    1.843e+00    3.936e-03
   43     906    7.727178e+03    0.000e+00    1.110e-01    9.047e-04
   44     923    7.727178e+03    0.000e+00    2.604e-02    4.050e-04
   45     940    7.727178e+03    0.000e+00    1.075e-02    1.721e-04

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',9.094364e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 1.9035 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

    0.0029
    0.0010
    0.0004
   -0.0032
   -0.0023
   -0.0002
   -0.0103
   -0.0001
   -0.0005
   -0.0012
    0.0034
    0.0010
         0
    0.0054
    0.0009
   -0.0107

Value of the log-likelihood function at convergence: -7727.1778
 
                      AIC                      BIC
              ------------------   -----------------------
                  15486.3555               15556.7064
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 5.7722e-07
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS          0.7053     0.0532    13.2515
A_SnGo         0.2019     0.0353     5.7238
A_AgeLT40      0.5630     0.0563    10.0090
A_ExpLT8       0.9863     0.0601    16.4205
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1          -0.9455     0.1093    -8.6475
Bc_2          -1.2297     0.1112   -11.0589
LV_Load        0.8933     0.0444    20.1001
Mu_12         -0.6035     0.0600   -10.0657
Mu_13         -0.5830     0.0546   -10.6839
Mu_14         -0.6256     0.0537   -11.6517
Mu_22         -0.4453     0.0513    -8.6780
Mu_23         -0.7760     0.0585   -13.2735
Mu_24         -0.7064     0.0580   -12.1836
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -0.9321     0.0381   -24.4854
C_VRC         -0.8754     0.0618   -14.1696
C_LV          -0.9507     0.0918   -10.3592
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    1.7979    0.7979
    0.7979    1.7979

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

    0.7053    0.2019    0.5630    0.9863   -0.9455   -1.2297    0.8933   -0.6035   -0.5830   -0.6256   -0.4453

  Columns 12 through 16

   -0.7760   -0.7064   -0.9321   -0.8754   -0.9507

The covariance matrix for these parameters is:

ihess =

  Columns 1 through 11

    0.0028    0.0002    0.0003    0.0005   -0.0033   -0.0033   -0.0009   -0.0003   -0.0002   -0.0003   -0.0003
    0.0002    0.0012    0.0001   -0.0000   -0.0020   -0.0020   -0.0003   -0.0001   -0.0001    0.0000   -0.0002
    0.0003    0.0001    0.0032    0.0004   -0.0005   -0.0005   -0.0007   -0.0001   -0.0001   -0.0002   -0.0002
    0.0005   -0.0000    0.0004    0.0036    0.0001    0.0002   -0.0013   -0.0004   -0.0003   -0.0005   -0.0002
   -0.0033   -0.0020   -0.0005    0.0001    0.0120    0.0110   -0.0011    0.0005   -0.0001   -0.0005   -0.0005
   -0.0033   -0.0020   -0.0005    0.0002    0.0110    0.0124   -0.0013   -0.0007   -0.0007   -0.0009    0.0002
   -0.0009   -0.0003   -0.0007   -0.0013   -0.0011   -0.0013    0.0020    0.0008    0.0008    0.0008    0.0008
   -0.0003   -0.0001   -0.0001   -0.0004    0.0005   -0.0007    0.0008    0.0036   -0.0000    0.0001    0.0003
   -0.0002   -0.0001   -0.0001   -0.0003   -0.0001   -0.0007    0.0008   -0.0000    0.0030   -0.0001    0.0004
   -0.0003    0.0000   -0.0002   -0.0005   -0.0005   -0.0009    0.0008    0.0001   -0.0001    0.0029    0.0003
   -0.0003   -0.0002   -0.0002   -0.0002   -0.0005    0.0002    0.0008    0.0003    0.0004    0.0003    0.0026
   -0.0003   -0.0001   -0.0002   -0.0004   -0.0006   -0.0003    0.0008    0.0003    0.0003    0.0004   -0.0000
   -0.0003   -0.0000   -0.0004   -0.0004   -0.0008   -0.0006    0.0009    0.0003    0.0004    0.0004    0.0001
    0.0000   -0.0001   -0.0000    0.0001    0.0001    0.0001   -0.0000   -0.0000    0.0000   -0.0000    0.0000
    0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000   -0.0000    0.0000    0.0000    0.0000   -0.0000
    0.0031    0.0011    0.0003    0.0003   -0.0057   -0.0054   -0.0007   -0.0001   -0.0002   -0.0003   -0.0002

  Columns 12 through 16

   -0.0003   -0.0003    0.0000    0.0000    0.0031
   -0.0001   -0.0000   -0.0001   -0.0000    0.0011
   -0.0002   -0.0004   -0.0000   -0.0000    0.0003
   -0.0004   -0.0004    0.0001    0.0000    0.0003
   -0.0006   -0.0008    0.0001    0.0000   -0.0057
   -0.0003   -0.0006    0.0001    0.0000   -0.0054
    0.0008    0.0009   -0.0000   -0.0000   -0.0007
    0.0003    0.0003   -0.0000    0.0000   -0.0001
    0.0003    0.0004    0.0000    0.0000   -0.0002
    0.0004    0.0004   -0.0000    0.0000   -0.0003
   -0.0000    0.0001    0.0000   -0.0000   -0.0002
    0.0034    0.0000    0.0000    0.0001   -0.0001
    0.0000    0.0034   -0.0000   -0.0000   -0.0003
    0.0000   -0.0000    0.0014    0.0010    0.0008
    0.0001   -0.0000    0.0010    0.0038    0.0010
   -0.0001   -0.0003    0.0008    0.0010    0.0084

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 43 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.283521e+04    0.000e+00    2.650e+03
User objective function returned Inf; trying a new point...
    1      39    1.019332e+04    0.000e+00    4.683e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.633839e+03    0.000e+00    9.349e+02    9.999e-01
User objective function returned Inf; trying a new point...
    3      81    8.513925e+03    0.000e+00    1.258e+03    4.999e-01
User objective function returned Inf; trying a new point...
    4      99    8.421520e+03    0.000e+00    1.635e+03    9.999e-01
User objective function returned Inf; trying a new point...
    5     121    8.337298e+03    0.000e+00    1.921e+02    9.999e-01
User objective function returned Inf; trying a new point...
    6     141    8.334336e+03    0.000e+00    4.328e+02    4.999e-01
User objective function returned Inf; trying a new point...
    7     163    8.255784e+03    0.000e+00    2.568e+02    4.999e-01
User objective function returned Inf; trying a new point...
    8     182    8.232954e+03    0.000e+00    5.221e+02    4.999e-01
User objective function returned Inf; trying a new point...
    9     203    8.227249e+03    0.000e+00    4.167e+02    9.999e-01
User objective function returned Inf; trying a new point...
   10     222    8.225345e+03    0.000e+00    5.735e+02    4.999e-01
User objective function returned Inf; trying a new point...
   11     244    8.187338e+03    0.000e+00    6.644e+02    4.999e-01
User objective function returned Inf; trying a new point...
   12     263    8.165362e+03    0.000e+00    7.932e+02    4.999e-01
User objective function returned complex; trying a new point...
   13     285    8.125722e+03    0.000e+00    3.618e+02    4.999e-01
User objective function returned Inf; trying a new point...
   14     304    8.122801e+03    0.000e+00    1.833e+02    4.999e-01
User objective function returned Inf; trying a new point...
   15     326    8.090356e+03    0.000e+00    2.216e+02    4.999e-01
User objective function returned Inf; trying a new point...
   16     350    8.082447e+03    0.000e+00    3.332e+02    4.375e-01
User objective function returned Inf; trying a new point...
   17     369    8.081421e+03    0.000e+00    2.523e+02    4.375e-01
User objective function returned Inf; trying a new point...
   18     391    8.073927e+03    0.000e+00    2.526e+02    4.375e-01
User objective function returned Inf; trying a new point...
   19     410    8.071651e+03    0.000e+00    8.274e+01    2.187e-01
User objective function returned Inf; trying a new point...
   20     432    8.060672e+03    0.000e+00    7.643e+01    2.187e-01
User objective function returned Inf; trying a new point...
   21     451    8.059151e+03    0.000e+00    8.482e+01    2.187e-01
User objective function returned Inf; trying a new point...
   22     473    8.054111e+03    0.000e+00    3.123e+01    2.187e-01
User objective function returned Inf; trying a new point...
   23     492    8.054096e+03    0.000e+00    1.060e+02    2.187e-01
   24     514    8.051090e+03    0.000e+00    4.553e+01    2.187e-01
User objective function returned Inf; trying a new point...
   25     533    8.049085e+03    0.000e+00    3.896e+01    2.187e-01
   26     555    8.047655e+03    0.000e+00    7.968e+01    2.187e-01
User objective function returned Inf; trying a new point...
   27     575    8.047505e+03    0.000e+00    1.040e+02    1.094e-01
   28     596    8.046922e+03    0.000e+00    7.726e+01    2.187e-01
User objective function returned Inf; trying a new point...
   29     614    8.045704e+03    0.000e+00    5.190e+01    2.187e-01
   30     635    8.041322e+03    0.000e+00    7.667e+01    4.375e-01
User objective function returned Inf; trying a new point...

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     661    8.041059e+03    0.000e+00    5.577e+01    9.569e-02
User objective function returned Inf; trying a new point...
   32     679    8.040574e+03    0.000e+00    5.905e+01    9.569e-02
   33     696    8.035148e+03    0.000e+00    1.641e+02    1.129e+00
   34     713    8.030834e+03    0.000e+00    9.536e+01    1.567e+00
   35     730    8.026280e+03    0.000e+00    2.585e+02    2.273e+00
   36     748    8.023625e+03    0.000e+00    2.828e+02    1.633e+00
   37     766    8.023499e+03    0.000e+00    3.959e+02    1.815e+00
   38     783    8.019868e+03    0.000e+00    7.602e+01    6.693e-01
   39     800    8.018290e+03    0.000e+00    3.010e+02    1.920e+00
   40     817    8.016005e+03    0.000e+00    4.356e+02    5.116e+00
   41     834    8.015175e+03    0.000e+00    9.667e+01    8.592e-01
   42     851    8.014621e+03    0.000e+00    1.549e+02    1.913e+00
   43     868    8.013227e+03    0.000e+00    5.466e+02    1.007e+01
   44     888    8.012617e+03    0.000e+00    9.385e+02    3.900e+00
   45     906    8.011874e+03    0.000e+00    5.366e+02    2.852e+00
   46     923    8.011586e+03    0.000e+00    2.003e+02    4.401e-01
   47     940    8.011267e+03    0.000e+00    1.522e+02    3.746e+00
   48     957    8.011069e+03    0.000e+00    6.214e+02    6.093e+00
   49     974    8.010742e+03    0.000e+00    2.411e+02    1.488e+00
   50     991    8.010261e+03    0.000e+00    1.677e+02    8.541e+00
   51    1008    8.010067e+03    0.000e+00    8.246e+02    1.197e+01
   52    1025    8.009744e+03    0.000e+00    2.098e+02    2.644e+00
   53    1042    8.009617e+03    0.000e+00    6.262e+02    8.565e+00
   54    1059    8.009466e+03    0.000e+00    6.114e+02    6.319e+00
   55    1076    8.009460e+03    0.000e+00    3.887e+02    2.567e+00
   56    1093    8.009326e+03    0.000e+00    8.859e+01    4.672e+00
   57    1110    8.009274e+03    0.000e+00    1.744e+02    3.017e+00
   58    1127    8.009269e+03    0.000e+00    4.514e+01    2.313e-02
   59    1144    8.009264e+03    0.000e+00    1.904e+00    2.892e-01
   60    1161    8.009263e+03    0.000e+00    6.600e-01    6.019e-02

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   61    1178    8.009262e+03    0.000e+00    8.008e-02    1.291e-02
   62    1195    8.009201e+03    0.000e+00    2.781e+01    3.637e+00
   63    1212    8.009190e+03    0.000e+00    5.183e+00    6.621e-01
   64    1229    8.009190e+03    0.000e+00    8.151e-01    2.269e-02
   65    1246    8.009190e+03    0.000e+00    3.094e-02    8.888e-04

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',8.997561e-06,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 2.6228 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

    0.0148
    0.0309
   -0.0001
         0
         0
    0.0002
    0.0001
   -0.0001
         0
   -0.0002
   -0.0001
   -0.0002
         0
   -0.0005
   -0.0005
   -0.0161

Value of the log-likelihood function at convergence: -8009.1903
 
                      AIC                      BIC
              ------------------   -----------------------
                  16050.3805               16120.7314
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 0.71674
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS         -0.0060     0.0032    -1.8841
A_SnGo        -0.0010     0.0007    -1.5035
A_AgeLT40      0.6189     0.0543    11.4018
A_ExpLT8       0.5576     0.0537    10.3779
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1           0.5977     0.0584    10.2342
Bc_2           0.4480     0.0569     7.8737
LV_Load        1.0636     0.0488    21.7938
Mu_12         -0.3359     0.0519    -6.4710
Mu_13         -0.6044     0.0552   -10.9593
Mu_14         -0.6258     0.0566   -11.0606
Mu_22         -0.5329     0.0539    -9.8902
Mu_23         -0.5065     0.0533    -9.5086
Mu_24         -0.8256     0.0647   -12.7597
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -0.7840     0.0346   -22.6308
C_VRC         -0.7209     0.0595   -12.1173
C_LV          98.7689    52.4398     1.8835
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    2.1311    1.1311
    1.1311    2.1311

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

   -0.0060   -0.0010    0.6189    0.5576    0.5977    0.4480    1.0636   -0.3359   -0.6044   -0.6258   -0.5329

  Columns 12 through 16

   -0.5065   -0.8256   -0.7840   -0.7209   98.7689

The covariance matrix for these parameters is:

ihess =

   1.0e+03 *

  Columns 1 through 11

    0.0000    0.0000   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000    0.0000    0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
   -0.0000    0.0000    0.0000    0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000
   -0.0000    0.0000    0.0000    0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000
   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000    0.0000    0.0000   -0.0000    0.0000   -0.0000   -0.0000    0.0000   -0.0000
   -0.0000    0.0000   -0.0000    0.0000    0.0000   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000
    0.0002    0.0000   -0.0000   -0.0000   -0.0004   -0.0004    0.0002    0.0002    0.0002    0.0000    0.0002

  Columns 12 through 16

    0.0000    0.0000    0.0000   -0.0000    0.0002
    0.0000   -0.0000    0.0000    0.0000    0.0000
   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000
   -0.0000   -0.0000    0.0000    0.0000   -0.0000
    0.0000    0.0000    0.0000    0.0000   -0.0004
    0.0000    0.0000   -0.0000   -0.0000   -0.0004
    0.0000    0.0000    0.0000   -0.0000    0.0002
    0.0000    0.0000   -0.0000   -0.0000    0.0002
    0.0000    0.0000   -0.0000   -0.0000    0.0002
    0.0000    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0000   -0.0000    0.0000    0.0002
    0.0000    0.0000    0.0000   -0.0000    0.0000
    0.0000    0.0000   -0.0000    0.0000    0.0001
    0.0000   -0.0000    0.0000    0.0000   -0.0000
   -0.0000    0.0000    0.0000    0.0000   -0.0001
    0.0000    0.0001   -0.0000   -0.0001    2.7499

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 44 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.202171e+04    0.000e+00    2.176e+03
User objective function returned Inf; trying a new point...
    1      39    1.051129e+04    0.000e+00    5.129e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.618492e+03    0.000e+00    3.454e+02    9.999e-01
User objective function returned Inf; trying a new point...
    3      80    8.574310e+03    0.000e+00    1.788e+03    9.999e-01
User objective function returned Inf; trying a new point...
    4      98    8.434576e+03    0.000e+00    2.003e+03    9.999e-01
User objective function returned Inf; trying a new point...
    5     120    8.283953e+03    0.000e+00    2.921e+02    9.999e-01
User objective function returned Inf; trying a new point...
    6     142    8.276019e+03    0.000e+00    3.831e+02    9.999e-01
User objective function returned Inf; trying a new point...
    7     161    8.251743e+03    0.000e+00    3.728e+02    4.999e-01
User objective function returned Inf; trying a new point...
    8     183    8.128478e+03    0.000e+00    3.894e+02    4.999e-01
User objective function returned Inf; trying a new point...
    9     207    8.099609e+03    0.000e+00    3.512e+02    4.375e-01
User objective function returned Inf; trying a new point...
   10     225    8.070556e+03    0.000e+00    1.713e+02    8.749e-01
User objective function returned Inf; trying a new point...
   11     247    8.062384e+03    0.000e+00    4.413e+02    8.749e-01
User objective function returned Inf; trying a new point...
   12     266    8.054980e+03    0.000e+00    3.182e+02    4.375e-01
User objective function returned Inf; trying a new point...
   13     287    7.994606e+03    0.000e+00    2.334e+02    8.749e-01
User objective function returned Inf; trying a new point...
   14     307    7.976668e+03    0.000e+00    2.116e+02    4.375e-01
User objective function returned Inf; trying a new point...
   15     329    7.975502e+03    0.000e+00    4.178e+02    4.375e-01
User objective function returned Inf; trying a new point...
   16     347    7.974958e+03    0.000e+00    1.908e+02    4.375e-01
User objective function returned Inf; trying a new point...
   17     369    7.949304e+03    0.000e+00    1.019e+02    4.375e-01
User objective function returned Inf; trying a new point...
   18     389    7.943129e+03    0.000e+00    6.711e+01    2.187e-01
User objective function returned Inf; trying a new point...
   19     411    7.937944e+03    0.000e+00    1.379e+02    2.187e-01
User objective function returned Inf; trying a new point...
   20     431    7.936770e+03    0.000e+00    1.149e+02    1.094e-01
User objective function returned Inf; trying a new point...
   21     452    7.933865e+03    0.000e+00    5.188e+01    2.187e-01
User objective function returned Inf; trying a new point...
   22     472    7.933734e+03    0.000e+00    5.373e+01    1.094e-01
User objective function returned Inf; trying a new point...
   23     493    7.930387e+03    0.000e+00    6.393e+01    2.187e-01
User objective function returned Inf; trying a new point...
   24     513    7.929236e+03    0.000e+00    1.094e+02    1.094e-01
User objective function returned Inf; trying a new point...
   25     535    7.926507e+03    0.000e+00    7.700e+01    1.094e-01
   26     558    7.926087e+03    0.000e+00    5.694e+01    1.914e-01
User objective function returned Inf; trying a new point...
   27     577    7.925927e+03    0.000e+00    5.584e+01    9.569e-02
   28     598    7.925651e+03    0.000e+00    8.651e+01    1.914e-01
   29     618    7.925503e+03    0.000e+00    7.392e+01    4.785e-02
   30     639    7.922823e+03    0.000e+00    5.456e+01    9.569e-02

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     663    7.921722e+03    0.000e+00    4.291e+01    8.305e-02
   32     687    7.920818e+03    0.000e+00    5.107e+01    7.267e-02
   33     710    7.920192e+03    0.000e+00    2.765e+01    1.272e-01
   34     733    7.919693e+03    0.000e+00    1.345e+01    6.358e-02
   35     756    7.919621e+03    0.000e+00    1.440e+01    3.179e-02
   36     779    7.919556e+03    0.000e+00    1.923e+00    1.590e-02
   37     799    7.919548e+03    0.000e+00    2.882e+00    7.948e-03
   38     816    7.919538e+03    0.000e+00    3.118e+00    1.972e-02
   39     833    7.919536e+03    0.000e+00    3.900e-01    4.336e-03
   40     850    7.919535e+03    0.000e+00    1.282e-01    1.861e-03
   41     867    7.919535e+03    0.000e+00    3.021e-01    1.409e-03
   42     884    7.919535e+03    0.000e+00    3.064e-02    1.520e-04

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',5.880067e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 1.8895 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

    0.0215
    0.0306
    0.0032
    0.0095
    0.0078
    0.0076
    0.0192
   -0.0023
   -0.0008
   -0.0002
   -0.0024
   -0.0002
   -0.0009
   -0.0002
   -0.0024
    0.0001

Value of the log-likelihood function at convergence: -7919.5353
 
                      AIC                      BIC
              ------------------   -----------------------
                  15871.0707               15941.4216
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 3.3967e-07
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS          0.5902     0.0488    12.1041
A_SnGo         0.1794     0.0345     5.1998
A_AgeLT40      0.1110     0.0542     2.0501
A_ExpLT8       0.7425     0.0564    13.1704
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1          -0.8736     0.1257    -6.9495
Bc_2          -0.9647     0.1244    -7.7542
LV_Load        0.9946     0.0476    20.8747
Mu_12         -0.3708     0.0495    -7.4869
Mu_13         -0.5629     0.0525   -10.7243
Mu_14         -0.6296     0.0569   -11.0666
Mu_22         -0.2305     0.0458    -5.0359
Mu_23         -0.9991     0.0659   -15.1505
Mu_24         -0.8053     0.0633   -12.7271
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -0.9859     0.0392   -25.1467
C_VRC         -0.7323     0.0609   -12.0198
C_LV          -0.7969     0.1076    -7.4071
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    1.9893    0.9893
    0.9893    1.9893

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

    0.5902    0.1794    0.1110    0.7425   -0.8736   -0.9647    0.9946   -0.3708   -0.5629   -0.6296   -0.2305

  Columns 12 through 16

   -0.9991   -0.8053   -0.9859   -0.7323   -0.7969

The covariance matrix for these parameters is:

ihess =

  Columns 1 through 11

    0.0024    0.0003    0.0001    0.0002   -0.0037   -0.0037   -0.0008   -0.0003   -0.0003   -0.0003   -0.0003
    0.0003    0.0012    0.0001    0.0000   -0.0027   -0.0026   -0.0002    0.0000   -0.0000   -0.0001   -0.0000
    0.0001    0.0001    0.0029    0.0002   -0.0015   -0.0015   -0.0002   -0.0001   -0.0002   -0.0000   -0.0000
    0.0002    0.0000    0.0002    0.0032   -0.0007   -0.0006   -0.0010   -0.0003   -0.0003   -0.0004   -0.0002
   -0.0037   -0.0027   -0.0015   -0.0007    0.0158    0.0143   -0.0010    0.0003   -0.0001   -0.0002   -0.0006
   -0.0037   -0.0026   -0.0015   -0.0006    0.0143    0.0155   -0.0011   -0.0006   -0.0005   -0.0005    0.0001
   -0.0008   -0.0002   -0.0002   -0.0010   -0.0010   -0.0011    0.0023    0.0009    0.0009    0.0010    0.0009
   -0.0003    0.0000   -0.0001   -0.0003    0.0003   -0.0006    0.0009    0.0025    0.0001    0.0002    0.0004
   -0.0003   -0.0000   -0.0002   -0.0003   -0.0001   -0.0005    0.0009    0.0001    0.0028    0.0000    0.0004
   -0.0003   -0.0001   -0.0000   -0.0004   -0.0002   -0.0005    0.0010    0.0002    0.0000    0.0032    0.0004
   -0.0003   -0.0000   -0.0000   -0.0002   -0.0006    0.0001    0.0009    0.0004    0.0004    0.0004    0.0021
   -0.0003   -0.0001   -0.0000   -0.0003   -0.0005   -0.0001    0.0009    0.0003    0.0003    0.0004    0.0000
   -0.0002   -0.0000   -0.0002   -0.0003   -0.0007   -0.0004    0.0010    0.0004    0.0003    0.0005    0.0001
    0.0000    0.0001    0.0000    0.0000   -0.0002   -0.0001    0.0000   -0.0000    0.0000    0.0000   -0.0000
    0.0001    0.0001   -0.0000    0.0001   -0.0002   -0.0002   -0.0001   -0.0000   -0.0000   -0.0001   -0.0000
    0.0027    0.0015    0.0003    0.0002   -0.0067   -0.0066   -0.0010   -0.0003   -0.0004   -0.0004   -0.0004

  Columns 12 through 16

   -0.0003   -0.0002    0.0000    0.0001    0.0027
   -0.0001   -0.0000    0.0001    0.0001    0.0015
   -0.0000   -0.0002    0.0000   -0.0000    0.0003
   -0.0003   -0.0003    0.0000    0.0001    0.0002
   -0.0005   -0.0007   -0.0002   -0.0002   -0.0067
   -0.0001   -0.0004   -0.0001   -0.0002   -0.0066
    0.0009    0.0010    0.0000   -0.0001   -0.0010
    0.0003    0.0004   -0.0000   -0.0000   -0.0003
    0.0003    0.0003    0.0000   -0.0000   -0.0004
    0.0004    0.0005    0.0000   -0.0001   -0.0004
    0.0000    0.0001   -0.0000   -0.0000   -0.0004
    0.0043   -0.0000    0.0000   -0.0000   -0.0004
   -0.0000    0.0040    0.0000   -0.0001   -0.0003
    0.0000    0.0000    0.0015    0.0009    0.0006
   -0.0000   -0.0001    0.0009    0.0037    0.0008
   -0.0004   -0.0003    0.0006    0.0008    0.0116

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 45 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.179050e+04    0.000e+00    2.086e+03
User objective function returned Inf; trying a new point...
    1      39    1.066349e+04    0.000e+00    5.354e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.700875e+03    0.000e+00    4.786e+02    9.999e-01
User objective function returned Inf; trying a new point...
    3      80    8.562278e+03    0.000e+00    1.819e+03    9.999e-01
User objective function returned Inf; trying a new point...
    4      99    8.388213e+03    0.000e+00    1.440e+03    9.999e-01
User objective function returned Inf; trying a new point...
    5     121    8.384348e+03    0.000e+00    5.125e+02    9.999e-01
User objective function returned Inf; trying a new point...
    6     141    8.374587e+03    0.000e+00    8.855e+02    2.500e-01
User objective function returned Inf; trying a new point...
    7     162    8.265500e+03    0.000e+00    3.365e+02    4.999e-01
User objective function returned Inf; trying a new point...
    8     181    8.261944e+03    0.000e+00    3.310e+02    5.000e-01
User objective function returned Inf; trying a new point...
    9     203    8.221601e+03    0.000e+00    2.513e+02    4.999e-01
User objective function returned Inf; trying a new point...
   10     223    8.209440e+03    0.000e+00    3.630e+02    2.500e-01
User objective function returned Inf; trying a new point...
   11     245    8.185225e+03    0.000e+00    9.607e+01    2.500e-01
User objective function returned Inf; trying a new point...
   12     264    8.179207e+03    0.000e+00    2.215e+02    8.749e-01
User objective function returned Inf; trying a new point...
   13     286    8.138532e+03    0.000e+00    2.331e+02    8.749e-01
User objective function returned Inf; trying a new point...
   14     308    8.135937e+03    0.000e+00    1.281e+02    8.749e-01
User objective function returned Inf; trying a new point...
   15     326    8.113831e+03    0.000e+00    1.505e+02    8.749e-01
User objective function returned Inf; trying a new point...
   16     348    8.085926e+03    0.000e+00    7.663e+02    8.749e-01
User objective function returned Inf; trying a new point...
   17     367    8.084986e+03    0.000e+00    6.226e+02    4.375e-01
User objective function returned Inf; trying a new point...
   18     389    8.034173e+03    0.000e+00    4.926e+02    4.375e-01
User objective function returned Inf; trying a new point...
   19     409    8.031128e+03    0.000e+00    4.333e+02    2.187e-01
User objective function returned Inf; trying a new point...
   20     430    8.029146e+03    0.000e+00    1.779e+02    4.375e-01
User objective function returned Inf; trying a new point...
   21     449    8.023092e+03    0.000e+00    8.115e+01    2.187e-01
User objective function returned Inf; trying a new point...
   22     470    8.022285e+03    0.000e+00    2.112e+02    4.375e-01
User objective function returned Inf; trying a new point...
   23     489    8.019852e+03    0.000e+00    1.551e+02    2.187e-01
User objective function returned Inf; trying a new point...
   24     511    8.008982e+03    0.000e+00    1.348e+02    2.187e-01
   25     534    8.006936e+03    0.000e+00    2.615e+01    1.094e-01
User objective function returned Inf; trying a new point...
   26     554    8.006935e+03    0.000e+00    3.468e+01    5.468e-02
   27     575    8.006319e+03    0.000e+00    2.074e+01    1.094e-01
   28     598    8.006130e+03    0.000e+00    1.951e+01    5.468e-02
   29     621    8.005990e+03    0.000e+00    8.881e+00    2.734e-02
   30     642    8.005979e+03    0.000e+00    8.973e+00    5.468e-02

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     660    8.005960e+03    0.000e+00    5.345e+00    5.468e-02
   32     683    8.005901e+03    0.000e+00    8.469e+00    2.734e-02
   33     708    8.005898e+03    0.000e+00    5.908e+00    1.196e-02
   34     728    8.005898e+03    0.000e+00    5.742e+00    2.990e-03
   35     748    8.005897e+03    0.000e+00    4.493e+00    1.394e-02
   36     767    8.005889e+03    0.000e+00    7.051e+00    1.152e-02
   37     784    8.005886e+03    0.000e+00    3.175e+00    4.263e-03
   38     801    8.005885e+03    0.000e+00    2.366e+00    6.598e-04
   39     818    8.005880e+03    0.000e+00    5.587e-01    4.645e-03
   40     835    8.005879e+03    0.000e+00    3.825e-01    3.722e-03
   41     852    8.005879e+03    0.000e+00    9.418e-02    3.958e-04
   42     869    8.005879e+03    0.000e+00    1.636e-03    6.515e-05

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',3.149028e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 1.8614 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

   -0.0016
   -0.0014
   -0.0002
   -0.0004
   -0.0009
    0.0001
   -0.0001
    0.0002
    0.0005
   -0.0001
    0.0002
    0.0008
         0
   -0.0001
    0.0002
         0

Value of the log-likelihood function at convergence: -8005.8792
 
                      AIC                      BIC
              ------------------   -----------------------
                  16043.7584               16114.1093
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 7.2454e-09
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS          0.5998     0.0455    13.1806
A_SnGo         0.0733     0.0252     2.9057
A_AgeLT40      0.3272     0.0503     6.5032
A_ExpLT8       0.1817     0.0484     3.7507
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1          -0.5327     0.1035    -5.1464
Bc_2          -0.6385     0.1072    -5.9580
LV_Load        1.0470     0.0467    22.4339
Mu_12         -0.2973     0.0461    -6.4539
Mu_13         -0.5896     0.0533   -11.0548
Mu_14         -0.9185     0.0628   -14.6224
Mu_22         -0.3902     0.0486    -8.0327
Mu_23         -0.3443     0.0460    -7.4900
Mu_24         -0.7537     0.0606   -12.4316
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -1.0425     0.0394   -26.4677
C_VRC         -0.9599     0.0660   -14.5469
C_LV          -1.2083     0.1356    -8.9138
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    2.0963    1.0963
    1.0963    2.0963

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

    0.5998    0.0733    0.3272    0.1817   -0.5327   -0.6385    1.0470   -0.2973   -0.5896   -0.9185   -0.3902

  Columns 12 through 16

   -0.3443   -0.7537   -1.0425   -0.9599   -1.2083

The covariance matrix for these parameters is:

ihess =

  Columns 1 through 11

    0.0021   -0.0000    0.0002    0.0001   -0.0030   -0.0031   -0.0007   -0.0001   -0.0001   -0.0003   -0.0002
   -0.0000    0.0006    0.0001   -0.0000   -0.0012   -0.0012   -0.0001   -0.0000   -0.0000    0.0001   -0.0001
    0.0002    0.0001    0.0025    0.0001   -0.0013   -0.0012   -0.0004   -0.0002   -0.0000   -0.0001   -0.0001
    0.0001   -0.0000    0.0001    0.0023   -0.0011   -0.0011   -0.0002   -0.0001   -0.0000   -0.0000   -0.0001
   -0.0030   -0.0012   -0.0013   -0.0011    0.0107    0.0097   -0.0005    0.0003   -0.0003   -0.0004   -0.0004
   -0.0031   -0.0012   -0.0012   -0.0011    0.0097    0.0115   -0.0006   -0.0005   -0.0008   -0.0005    0.0004
   -0.0007   -0.0001   -0.0004   -0.0002   -0.0005   -0.0006    0.0022    0.0008    0.0009    0.0009    0.0009
   -0.0001   -0.0000   -0.0002   -0.0001    0.0003   -0.0005    0.0008    0.0021    0.0001    0.0001    0.0003
   -0.0001   -0.0000   -0.0000   -0.0000   -0.0003   -0.0008    0.0009    0.0001    0.0028    0.0000    0.0004
   -0.0003    0.0001   -0.0001   -0.0000   -0.0004   -0.0005    0.0009    0.0001    0.0000    0.0039    0.0004
   -0.0002   -0.0001   -0.0001   -0.0001   -0.0004    0.0004    0.0009    0.0003    0.0004    0.0004    0.0024
   -0.0002   -0.0000   -0.0001   -0.0001   -0.0003    0.0000    0.0009    0.0003    0.0004    0.0005    0.0001
   -0.0002    0.0001   -0.0002   -0.0001   -0.0006   -0.0003    0.0009    0.0004    0.0004    0.0002    0.0001
   -0.0000   -0.0001   -0.0000   -0.0000    0.0002    0.0002    0.0000   -0.0000    0.0001   -0.0001    0.0000
   -0.0001   -0.0001   -0.0000   -0.0000    0.0003    0.0004    0.0000   -0.0001    0.0000   -0.0001    0.0001
    0.0041   -0.0000    0.0003    0.0002   -0.0057   -0.0061   -0.0014   -0.0002   -0.0001   -0.0005   -0.0004

  Columns 12 through 16

   -0.0002   -0.0002   -0.0000   -0.0001    0.0041
   -0.0000    0.0001   -0.0001   -0.0001   -0.0000
   -0.0001   -0.0002   -0.0000   -0.0000    0.0003
   -0.0001   -0.0001   -0.0000   -0.0000    0.0002
   -0.0003   -0.0006    0.0002    0.0003   -0.0057
    0.0000   -0.0003    0.0002    0.0004   -0.0061
    0.0009    0.0009    0.0000    0.0000   -0.0014
    0.0003    0.0004   -0.0000   -0.0001   -0.0002
    0.0004    0.0004    0.0001    0.0000   -0.0001
    0.0005    0.0002   -0.0001   -0.0001   -0.0005
    0.0001    0.0001    0.0000    0.0001   -0.0004
    0.0021    0.0002    0.0000    0.0000   -0.0004
    0.0002    0.0037   -0.0001   -0.0002   -0.0003
    0.0000   -0.0001    0.0016    0.0012    0.0011
    0.0000   -0.0002    0.0012    0.0044    0.0015
   -0.0004   -0.0003    0.0011    0.0015    0.0184

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 46 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.295056e+04    0.000e+00    2.698e+03
User objective function returned Inf; trying a new point...
    1      39    1.007107e+04    0.000e+00    4.608e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.586141e+03    0.000e+00    1.035e+03    9.999e-01
User objective function returned Inf; trying a new point...
    3      81    8.449199e+03    0.000e+00    1.224e+03    4.999e-01
User objective function returned Inf; trying a new point...
    4      99    8.390456e+03    0.000e+00    1.612e+03    9.999e-01
User objective function returned Inf; trying a new point...
    5     122    8.205396e+03    0.000e+00    3.982e+02    4.999e-01
User objective function returned Inf; trying a new point...
    6     142    8.194729e+03    0.000e+00    3.324e+02    2.500e-01
User objective function returned Inf; trying a new point...
    7     163    8.132207e+03    0.000e+00    1.624e+02    4.999e-01
User objective function returned Inf; trying a new point...
    8     186    8.113583e+03    0.000e+00    2.919e+02    8.749e-01
User objective function returned Inf; trying a new point...
    9     205    8.099585e+03    0.000e+00    5.591e+02    4.375e-01
User objective function returned Inf; trying a new point...
   10     227    8.017799e+03    0.000e+00    2.480e+02    4.375e-01
User objective function returned Inf; trying a new point...
   11     246    7.987610e+03    0.000e+00    2.791e+02    4.375e-01
User objective function returned Inf; trying a new point...
   12     267    7.942455e+03    0.000e+00    1.871e+02    8.749e-01
User objective function returned Inf; trying a new point...
   13     287    7.932498e+03    0.000e+00    2.535e+02    4.375e-01
User objective function returned Inf; trying a new point...
   14     308    7.889617e+03    0.000e+00    5.666e+02    8.749e-01
User objective function returned Inf; trying a new point...
   15     332    7.873730e+03    0.000e+00    4.330e+02    2.187e-01
User objective function returned Inf; trying a new point...
   16     350    7.864502e+03    0.000e+00    4.057e+02    4.375e-01
User objective function returned Inf; trying a new point...
   17     372    7.838472e+03    0.000e+00    1.548e+02    4.375e-01
User objective function returned Inf; trying a new point...
   18     392    7.835882e+03    0.000e+00    1.697e+02    2.187e-01
User objective function returned Inf; trying a new point...
   19     413    7.816877e+03    0.000e+00    1.077e+02    4.375e-01
User objective function returned Inf; trying a new point...
   20     433    7.816558e+03    0.000e+00    1.098e+02    2.187e-01
   21     455    7.810822e+03    0.000e+00    9.269e+01    2.187e-01
User objective function returned Inf; trying a new point...
   22     475    7.810162e+03    0.000e+00    8.857e+01    1.094e-01
   23     496    7.807322e+03    0.000e+00    8.835e+01    2.187e-01
   24     519    7.806659e+03    0.000e+00    4.018e+01    1.094e-01
   25     540    7.806547e+03    0.000e+00    2.873e+01    2.187e-01
User objective function returned Inf; trying a new point...
   26     559    7.806292e+03    0.000e+00    2.837e+01    1.094e-01
   27     581    7.805855e+03    0.000e+00    5.726e+01    1.094e-01
User objective function returned Inf; trying a new point...
   28     604    7.805278e+03    0.000e+00    4.484e+01    5.468e-02
   29     626    7.805210e+03    0.000e+00    2.327e+01    5.468e-02
   30     644    7.805186e+03    0.000e+00    2.280e+01    5.468e-02

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     666    7.805005e+03    0.000e+00    1.808e+01    5.468e-02
   32     685    7.804991e+03    0.000e+00    2.701e+01    5.468e-02
   33     706    7.804825e+03    0.000e+00    3.059e+01    6.945e-02
User objective function returned Inf; trying a new point...
   34     725    7.804777e+03    0.000e+00    3.444e+01    6.945e-02
   35     742    7.804547e+03    0.000e+00    1.548e+01    1.515e-01
   36     759    7.804271e+03    0.000e+00    1.083e+01    5.866e-02
   37     776    7.804054e+03    0.000e+00    1.919e+01    2.369e-02
   38     793    7.803793e+03    0.000e+00    5.923e+00    5.710e-02
   39     810    7.803780e+03    0.000e+00    1.961e+00    1.421e-02
   40     827    7.803779e+03    0.000e+00    5.215e-01    1.636e-03
   41     844    7.803779e+03    0.000e+00    7.210e-02    5.713e-04
   42     861    7.803779e+03    0.000e+00    3.147e-03    6.223e-05

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',4.279145e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 1.8025 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

    0.0013
    0.0008
    0.0010
   -0.0002
   -0.0013
    0.0026
    0.0031
    0.0002
   -0.0005
    0.0005
         0
    0.0004
    0.0007
    0.0005
   -0.0010
    0.0023

Value of the log-likelihood function at convergence: -7803.7794
 
                      AIC                      BIC
              ------------------   -----------------------
                  15639.5588               15709.9096
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 4.7047e-08
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS          0.7826     0.0490    15.9582
A_SnGo         0.2614     0.0335     7.7959
A_AgeLT40      0.7486     0.0522    14.3433
A_ExpLT8       0.6732     0.0515    13.0778
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1          -1.4824     0.1275   -11.6312
Bc_2          -1.6604     0.1295   -12.8261
LV_Load        1.0486     0.0492    21.2990
Mu_12         -0.5380     0.0604    -8.9062
Mu_13         -0.5368     0.0567    -9.4753
Mu_14         -0.6271     0.0564   -11.1240
Mu_22         -0.4316     0.0542    -7.9687
Mu_23         -0.4648     0.0516    -9.0105
Mu_24         -0.6226     0.0561   -11.0980
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -0.7966     0.0340   -23.4118
C_VRC         -0.7738     0.0592   -13.0794
C_LV          -0.4608     0.0693    -6.6531
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    2.0996    1.0996
    1.0996    2.0996

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

    0.7826    0.2614    0.7486    0.6732   -1.4824   -1.6604    1.0486   -0.5380   -0.5368   -0.6271   -0.4316

  Columns 12 through 16

   -0.4648   -0.6226   -0.7966   -0.7738   -0.4608

The covariance matrix for these parameters is:

ihess =

  Columns 1 through 11

    0.0024    0.0002    0.0004    0.0003   -0.0031   -0.0032   -0.0009   -0.0002   -0.0002   -0.0002   -0.0002
    0.0002    0.0011    0.0004    0.0002   -0.0021   -0.0021   -0.0003   -0.0001   -0.0001   -0.0001   -0.0001
    0.0004    0.0004    0.0027    0.0004   -0.0012   -0.0011   -0.0009   -0.0002   -0.0003   -0.0003   -0.0003
    0.0003    0.0002    0.0004    0.0026   -0.0007   -0.0008   -0.0008   -0.0001   -0.0002   -0.0002   -0.0003
   -0.0031   -0.0021   -0.0012   -0.0007    0.0162    0.0147   -0.0017   -0.0000   -0.0004   -0.0006   -0.0011
   -0.0032   -0.0021   -0.0011   -0.0008    0.0147    0.0168   -0.0020   -0.0014   -0.0013   -0.0012   -0.0003
   -0.0009   -0.0003   -0.0009   -0.0008   -0.0017   -0.0020    0.0024    0.0010    0.0010    0.0009    0.0010
   -0.0002   -0.0001   -0.0002   -0.0001   -0.0000   -0.0014    0.0010    0.0036    0.0002    0.0003    0.0005
   -0.0002   -0.0001   -0.0003   -0.0002   -0.0004   -0.0013    0.0010    0.0002    0.0032    0.0002    0.0005
   -0.0002   -0.0001   -0.0003   -0.0002   -0.0006   -0.0012    0.0009    0.0003    0.0002    0.0032    0.0005
   -0.0002   -0.0001   -0.0003   -0.0003   -0.0011   -0.0003    0.0010    0.0005    0.0005    0.0005    0.0029
   -0.0003   -0.0001   -0.0003   -0.0003   -0.0010   -0.0005    0.0010    0.0005    0.0004    0.0004    0.0001
   -0.0003   -0.0001   -0.0002   -0.0003   -0.0009   -0.0007    0.0010    0.0005    0.0005    0.0004    0.0002
   -0.0000    0.0000   -0.0001   -0.0000    0.0000    0.0000   -0.0000   -0.0000    0.0000    0.0000   -0.0000
   -0.0000   -0.0000    0.0001    0.0000    0.0000    0.0002   -0.0000    0.0001   -0.0001   -0.0000   -0.0001
    0.0012    0.0004    0.0004    0.0002   -0.0022   -0.0022   -0.0005   -0.0001   -0.0002   -0.0002   -0.0002

  Columns 12 through 16

   -0.0003   -0.0003   -0.0000   -0.0000    0.0012
   -0.0001   -0.0001    0.0000   -0.0000    0.0004
   -0.0003   -0.0002   -0.0001    0.0001    0.0004
   -0.0003   -0.0003   -0.0000    0.0000    0.0002
   -0.0010   -0.0009    0.0000    0.0000   -0.0022
   -0.0005   -0.0007    0.0000    0.0002   -0.0022
    0.0010    0.0010   -0.0000   -0.0000   -0.0005
    0.0005    0.0005   -0.0000    0.0001   -0.0001
    0.0004    0.0005    0.0000   -0.0001   -0.0002
    0.0004    0.0004    0.0000   -0.0000   -0.0002
    0.0001    0.0002   -0.0000   -0.0001   -0.0002
    0.0027    0.0001   -0.0000    0.0000   -0.0002
    0.0001    0.0031   -0.0000   -0.0000   -0.0002
   -0.0000   -0.0000    0.0012    0.0006    0.0002
    0.0000   -0.0000    0.0006    0.0035    0.0007
   -0.0002   -0.0002    0.0002    0.0007    0.0048

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 47 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.339335e+04    0.000e+00    2.892e+03
User objective function returned Inf; trying a new point...
    1      39    9.897470e+03    0.000e+00    4.311e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.592499e+03    0.000e+00    1.438e+03    9.999e-01
User objective function returned Inf; trying a new point...
    3      80    8.550941e+03    0.000e+00    8.581e+02    9.999e-01
User objective function returned Inf; trying a new point...
    4      98    8.256393e+03    0.000e+00    9.454e+02    9.999e-01
User objective function returned Inf; trying a new point...
    5     122    8.169151e+03    0.000e+00    5.924e+02    2.500e-01
User objective function returned Inf; trying a new point...
    6     140    8.100523e+03    0.000e+00    6.776e+02    5.000e-01
User objective function returned Inf; trying a new point...
    7     162    8.017780e+03    0.000e+00    3.140e+02    5.000e-01
User objective function returned Inf; trying a new point...
    8     181    7.985294e+03    0.000e+00    4.902e+02    5.000e-01
User objective function returned Inf; trying a new point...
    9     202    7.965556e+03    0.000e+00    5.405e+02    9.999e-01
User objective function returned Inf; trying a new point...
   10     222    7.962603e+03    0.000e+00    3.393e+02    2.500e-01
User objective function returned Inf; trying a new point...
   11     243    7.886632e+03    0.000e+00    1.849e+02    5.000e-01
User objective function returned Inf; trying a new point...
   12     266    7.875639e+03    0.000e+00    7.902e+01    2.500e-01
User objective function returned Inf; trying a new point...
   13     289    7.873512e+03    0.000e+00    1.185e+02    1.250e-01
User objective function returned Inf; trying a new point...
   14     309    7.872940e+03    0.000e+00    8.521e+01    6.249e-02
User objective function returned Inf; trying a new point...
   15     330    7.870476e+03    0.000e+00    9.188e+01    1.250e-01
User objective function returned Inf; trying a new point...
   16     355    7.868704e+03    0.000e+00    6.468e+01    5.468e-02
User objective function returned Inf; trying a new point...
   17     374    7.868483e+03    0.000e+00    6.771e+01    1.914e-01
User objective function returned Inf; trying a new point...
   18     396    7.867388e+03    0.000e+00    5.939e+01    1.914e-01
User objective function returned Inf; trying a new point...
   19     414    7.867179e+03    0.000e+00    6.721e+01    1.914e-01
User objective function returned Inf; trying a new point...
   20     435    7.866784e+03    0.000e+00    1.132e+02    3.828e-01
User objective function returned Inf; trying a new point...
   21     455    7.865910e+03    0.000e+00    1.112e+02    9.569e-02
User objective function returned Inf; trying a new point...
   22     476    7.857063e+03    0.000e+00    1.756e+02    1.914e-01
User objective function returned Inf; trying a new point...
   23     496    7.856685e+03    0.000e+00    1.722e+02    9.569e-02
   24     517    7.850964e+03    0.000e+00    1.692e+02    1.914e-01
User objective function returned Inf; trying a new point...
   25     540    7.850182e+03    0.000e+00    2.062e+02    3.349e-01
   26     562    7.840694e+03    0.000e+00    2.995e+02    1.675e-01
   27     587    7.839715e+03    0.000e+00    1.091e+02    7.327e-02
User objective function returned Inf; trying a new point...
   28     605    7.839636e+03    0.000e+00    1.016e+02    7.327e-02
   29     626    7.834601e+03    0.000e+00    1.382e+02    1.465e-01
   30     650    7.833160e+03    0.000e+00    2.053e+02    1.282e-01

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     672    7.832619e+03    0.000e+00    1.095e+02    1.282e-01
   32     692    7.832528e+03    0.000e+00    1.089e+02    3.205e-02
   33     712    7.832264e+03    0.000e+00    9.828e+01    7.029e-02
   34     737    7.831692e+03    0.000e+00    4.247e+01    8.786e-03
   35     755    7.831018e+03    0.000e+00    3.424e+01    1.757e-02
User objective function returned Inf; trying a new point...
   36     776    7.830130e+03    0.000e+00    1.553e+01    3.514e-02
   37     798    7.829210e+03    0.000e+00    8.867e+00    1.230e-01
User objective function returned Inf; trying a new point...
   38     818    7.829059e+03    0.000e+00    1.296e+01    6.150e-02
   39     835    7.828504e+03    0.000e+00    1.972e+01    1.277e-01
   40     852    7.828356e+03    0.000e+00    5.501e+00    4.435e-02
   41     869    7.828293e+03    0.000e+00    1.095e+00    4.680e-02
   42     886    7.828283e+03    0.000e+00    5.467e-01    2.611e-02
   43     903    7.828282e+03    0.000e+00    2.602e-01    3.925e-03
   44     920    7.828282e+03    0.000e+00    3.235e-02    5.683e-04
   45     937    7.828282e+03    0.000e+00    9.931e-03    1.953e-04
   46     954    7.828282e+03    0.000e+00    6.284e-03    2.976e-05

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',1.593341e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 1.9525 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

   -0.0035
   -0.0063
   -0.0012
   -0.0014
   -0.0013
   -0.0017
   -0.0058
    0.0003
    0.0005
    0.0005
    0.0004
    0.0007
    0.0005
         0
   -0.0001
    0.0001

Value of the log-likelihood function at convergence: -7828.2819
 
                      AIC                      BIC
              ------------------   -----------------------
                  15688.5638               15758.9147
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 8.4451e-09
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS          0.4787     0.0487     9.8366
A_SnGo         0.1534     0.0304     5.0408
A_AgeLT40      1.0243     0.0646    15.8580
A_ExpLT8       0.5611     0.0569     9.8589
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1          -0.4258     0.1150    -3.7026
Bc_2          -0.6217     0.1171    -5.3089
LV_Load        0.8736     0.0451    19.3790
Mu_12         -0.5285     0.0562    -9.4015
Mu_13         -0.8588     0.0607   -14.1537
Mu_14         -0.6208     0.0520   -11.9396
Mu_22         -0.5262     0.0542    -9.7152
Mu_23         -0.6940     0.0544   -12.7489
Mu_24         -0.5806     0.0532   -10.9180
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -0.7982     0.0348   -22.9118
C_VRC         -0.5744     0.0580    -9.9061
C_LV          -1.5509     0.1948    -7.9600
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    1.7632    0.7632
    0.7632    1.7632

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

    0.4787    0.1534    1.0243    0.5611   -0.4258   -0.6217    0.8736   -0.5285   -0.8588   -0.6208   -0.5262

  Columns 12 through 16

   -0.6940   -0.5806   -0.7982   -0.5744   -1.5509

The covariance matrix for these parameters is:

ihess =

  Columns 1 through 11

    0.0024    0.0006    0.0005    0.0002   -0.0040   -0.0040   -0.0006   -0.0001   -0.0001   -0.0001   -0.0001
    0.0006    0.0009    0.0003    0.0000   -0.0024   -0.0025   -0.0001    0.0001    0.0001   -0.0000    0.0000
    0.0005    0.0003    0.0042    0.0008   -0.0007   -0.0008   -0.0015   -0.0004   -0.0003   -0.0006   -0.0005
    0.0002    0.0000    0.0008    0.0032   -0.0008   -0.0009   -0.0008   -0.0002   -0.0002   -0.0003   -0.0003
   -0.0040   -0.0024   -0.0007   -0.0008    0.0132    0.0121   -0.0009    0.0003   -0.0001   -0.0003   -0.0008
   -0.0040   -0.0025   -0.0008   -0.0009    0.0121    0.0137   -0.0010   -0.0009   -0.0008   -0.0006    0.0000
   -0.0006   -0.0001   -0.0015   -0.0008   -0.0009   -0.0010    0.0020    0.0008    0.0007    0.0008    0.0009
   -0.0001    0.0001   -0.0004   -0.0002    0.0003   -0.0009    0.0008    0.0032   -0.0001    0.0001    0.0004
   -0.0001    0.0001   -0.0003   -0.0002   -0.0001   -0.0008    0.0007   -0.0001    0.0037   -0.0000    0.0004
   -0.0001   -0.0000   -0.0006   -0.0003   -0.0003   -0.0006    0.0008    0.0001   -0.0000    0.0027    0.0004
   -0.0001    0.0000   -0.0005   -0.0003   -0.0008    0.0000    0.0009    0.0004    0.0004    0.0004    0.0029
   -0.0002   -0.0000   -0.0005   -0.0002   -0.0004    0.0000    0.0008    0.0004    0.0003    0.0003    0.0000
   -0.0002   -0.0000   -0.0006   -0.0003   -0.0005   -0.0002    0.0009    0.0003    0.0003    0.0004    0.0003
   -0.0000    0.0001    0.0000    0.0000   -0.0001   -0.0001    0.0000    0.0001    0.0000   -0.0000    0.0000
    0.0000   -0.0000   -0.0001   -0.0000   -0.0001   -0.0000    0.0001    0.0000    0.0000    0.0001    0.0001
    0.0072    0.0038    0.0020    0.0006   -0.0156   -0.0158   -0.0015    0.0000    0.0000   -0.0003   -0.0001

  Columns 12 through 16

   -0.0002   -0.0002   -0.0000    0.0000    0.0072
   -0.0000   -0.0000    0.0001   -0.0000    0.0038
   -0.0005   -0.0006    0.0000   -0.0001    0.0020
   -0.0002   -0.0003    0.0000   -0.0000    0.0006
   -0.0004   -0.0005   -0.0001   -0.0001   -0.0156
    0.0000   -0.0002   -0.0001   -0.0000   -0.0158
    0.0008    0.0009    0.0000    0.0001   -0.0015
    0.0004    0.0003    0.0001    0.0000    0.0000
    0.0003    0.0003    0.0000    0.0000    0.0000
    0.0003    0.0004   -0.0000    0.0001   -0.0003
    0.0000    0.0003    0.0000    0.0001   -0.0001
    0.0030    0.0001    0.0001    0.0001   -0.0005
    0.0001    0.0028    0.0000    0.0001   -0.0006
    0.0001    0.0000    0.0012    0.0006    0.0010
    0.0001    0.0001    0.0006    0.0034    0.0010
   -0.0005   -0.0006    0.0010    0.0010    0.0380

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 48 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.247268e+04    0.000e+00    2.420e+03
User objective function returned Inf; trying a new point...
    1      39    1.017792e+04    0.000e+00    4.794e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.427448e+03    0.000e+00    5.244e+02    9.999e-01
User objective function returned Inf; trying a new point...
    3      81    8.379150e+03    0.000e+00    1.320e+03    4.999e-01
User objective function returned Inf; trying a new point...
    4      99    8.303017e+03    0.000e+00    1.420e+03    4.999e-01
User objective function returned Inf; trying a new point...
    5     121    8.206240e+03    0.000e+00    2.309e+02    4.999e-01
User objective function returned Inf; trying a new point...
    6     143    8.197532e+03    0.000e+00    3.136e+02    4.999e-01
User objective function returned Inf; trying a new point...
    7     161    8.149557e+03    0.000e+00    4.884e+02    4.999e-01
User objective function returned Inf; trying a new point...
    8     183    8.084999e+03    0.000e+00    3.900e+02    4.999e-01
User objective function returned Inf; trying a new point...
    9     202    8.062858e+03    0.000e+00    4.580e+02    5.000e-01
User objective function returned Inf; trying a new point...
   10     223    8.054998e+03    0.000e+00    2.280e+02    9.999e-01
User objective function returned Inf; trying a new point...
   11     241    8.015395e+03    0.000e+00    2.147e+02    9.999e-01
User objective function returned Inf; trying a new point...
   12     264    7.930780e+03    0.000e+00    1.517e+02    5.000e-01
User objective function returned Inf; trying a new point...
   13     283    7.910463e+03    0.000e+00    1.958e+02    5.000e-01
User objective function returned Inf; trying a new point...
   14     305    7.881491e+03    0.000e+00    4.306e+02    5.000e-01
User objective function returned Inf; trying a new point...
   15     324    7.869316e+03    0.000e+00    1.010e+02    5.000e-01
User objective function returned Inf; trying a new point...
   16     346    7.864944e+03    0.000e+00    7.110e+01    5.000e-01
User objective function returned Inf; trying a new point...
   17     365    7.861968e+03    0.000e+00    6.043e+01    2.500e-01
User objective function returned Inf; trying a new point...
   18     387    7.851065e+03    0.000e+00    4.625e+01    2.500e-01
User objective function returned Inf; trying a new point...
   19     412    7.850663e+03    0.000e+00    2.907e+01    1.094e-01
   20     432    7.850604e+03    0.000e+00    2.191e+01    2.734e-02
   21     453    7.849876e+03    0.000e+00    1.159e+01    5.468e-02
   22     472    7.849824e+03    0.000e+00    1.483e+01    5.468e-02
   23     494    7.849565e+03    0.000e+00    1.102e+01    5.468e-02
   24     514    7.849544e+03    0.000e+00    4.263e+00    2.734e-02
   25     535    7.849445e+03    0.000e+00    8.587e+00    5.468e-02
   26     558    7.849373e+03    0.000e+00    3.236e+00    2.734e-02
   27     580    7.849360e+03    0.000e+00    6.709e+00    2.734e-02
   28     602    7.849327e+03    0.000e+00    3.645e+00    1.367e-02
   29     625    7.849322e+03    0.000e+00    1.807e+00    6.835e-03
   30     645    7.849322e+03    0.000e+00    3.084e+00    3.418e-03

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     666    7.849317e+03    0.000e+00    1.927e+00    6.835e-03
   32     690    7.849316e+03    0.000e+00    2.756e+00    5.981e-03
   33     710    7.849316e+03    0.000e+00    2.671e+00    1.495e-03
   34     731    7.849314e+03    0.000e+00    2.128e+00    2.990e-03
   35     753    7.849314e+03    0.000e+00    1.191e+00    1.047e-02
   36     773    7.849313e+03    0.000e+00    1.088e+00    2.617e-03
   37     792    7.849313e+03    0.000e+00    8.979e-01    2.741e-03
   38     809    7.849312e+03    0.000e+00    2.185e+00    6.814e-03
   39     826    7.849311e+03    0.000e+00    1.529e+00    9.511e-04
   40     843    7.849310e+03    0.000e+00    7.124e-01    3.405e-03
   41     860    7.849309e+03    0.000e+00    6.997e-01    1.932e-03
   42     877    7.849309e+03    0.000e+00    1.347e-01    1.043e-03
   43     894    7.849309e+03    0.000e+00    2.331e-02    3.446e-04
   44     911    7.849309e+03    0.000e+00    4.215e-03    3.105e-05

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',2.243540e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 1.8693 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

    0.0027
    0.0033
    0.0008
    0.0009
    0.0003
    0.0007
    0.0042
   -0.0003
   -0.0002
   -0.0004
   -0.0012
   -0.0007
   -0.0004
   -0.0002
   -0.0004
    0.0003

Value of the log-likelihood function at convergence: -7849.3092
 
                      AIC                      BIC
              ------------------   -----------------------
                  15730.6183               15800.9692
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 1.0054e-08
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS          0.6802     0.0487    13.9630
A_SnGo         0.3322     0.0370     8.9896
A_AgeLT40      0.5865     0.0534    10.9785
A_ExpLT8       0.3136     0.0518     6.0552
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1          -1.3296     0.1215   -10.9389
Bc_2          -1.3934     0.1206   -11.5536
LV_Load        0.9696     0.0471    20.6069
Mu_12         -0.8108     0.0618   -13.1139
Mu_13         -0.6100     0.0539   -11.3074
Mu_14         -0.5038     0.0509    -9.9065
Mu_22         -0.4202     0.0496    -8.4727
Mu_23         -0.7894     0.0583   -13.5356
Mu_24         -0.9623     0.0656   -14.6666
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -0.9696     0.0377   -25.6917
C_VRC         -0.5182     0.0582    -8.9107
C_LV          -0.5525     0.0797    -6.9315
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    1.9401    0.9401
    0.9401    1.9401

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

    0.6802    0.3322    0.5865    0.3136   -1.3296   -1.3934    0.9696   -0.8108   -0.6100   -0.5038   -0.4202

  Columns 12 through 16

   -0.7894   -0.9623   -0.9696   -0.5182   -0.5525

The covariance matrix for these parameters is:

ihess =

  Columns 1 through 11

    0.0024    0.0002    0.0004    0.0001   -0.0029   -0.0029   -0.0008   -0.0002   -0.0003   -0.0003   -0.0002
    0.0002    0.0014    0.0002   -0.0001   -0.0023   -0.0022   -0.0004   -0.0001   -0.0001   -0.0001   -0.0001
    0.0004    0.0002    0.0029    0.0002   -0.0010   -0.0010   -0.0007   -0.0002   -0.0002   -0.0003   -0.0002
    0.0001   -0.0001    0.0002    0.0027   -0.0008   -0.0008   -0.0004   -0.0001   -0.0001   -0.0001   -0.0001
   -0.0029   -0.0023   -0.0010   -0.0008    0.0148    0.0133   -0.0016    0.0000   -0.0003   -0.0005   -0.0010
   -0.0029   -0.0022   -0.0010   -0.0008    0.0133    0.0145   -0.0017   -0.0009   -0.0009   -0.0009   -0.0001
   -0.0008   -0.0004   -0.0007   -0.0004   -0.0016   -0.0017    0.0022    0.0009    0.0009    0.0009    0.0009
   -0.0002   -0.0001   -0.0002   -0.0001    0.0000   -0.0009    0.0009    0.0038    0.0001    0.0002    0.0004
   -0.0003   -0.0001   -0.0002   -0.0001   -0.0003   -0.0009    0.0009    0.0001    0.0029    0.0000    0.0004
   -0.0003   -0.0001   -0.0003   -0.0001   -0.0005   -0.0009    0.0009    0.0002    0.0000    0.0026    0.0004
   -0.0002   -0.0001   -0.0002   -0.0001   -0.0010   -0.0001    0.0009    0.0004    0.0004    0.0004    0.0025
   -0.0002   -0.0001   -0.0001   -0.0001   -0.0009   -0.0005    0.0008    0.0004    0.0003    0.0004    0.0000
   -0.0002   -0.0001   -0.0003   -0.0001   -0.0011   -0.0008    0.0009    0.0004    0.0004    0.0004    0.0002
    0.0000   -0.0000    0.0001    0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000   -0.0000
    0.0001    0.0000    0.0000    0.0000   -0.0001   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000
    0.0012    0.0009    0.0003   -0.0001   -0.0026   -0.0025   -0.0006   -0.0001   -0.0001   -0.0002   -0.0000

  Columns 12 through 16

   -0.0002   -0.0002    0.0000    0.0001    0.0012
   -0.0001   -0.0001   -0.0000    0.0000    0.0009
   -0.0001   -0.0003    0.0001    0.0000    0.0003
   -0.0001   -0.0001    0.0000    0.0000   -0.0001
   -0.0009   -0.0011   -0.0000   -0.0001   -0.0026
   -0.0005   -0.0008   -0.0000   -0.0000   -0.0025
    0.0008    0.0009   -0.0000   -0.0000   -0.0006
    0.0004    0.0004    0.0000    0.0000   -0.0001
    0.0003    0.0004    0.0000    0.0000   -0.0001
    0.0004    0.0004    0.0000    0.0000   -0.0002
    0.0000    0.0002   -0.0000    0.0000   -0.0000
    0.0034   -0.0000   -0.0000   -0.0000   -0.0002
   -0.0000    0.0043   -0.0000   -0.0000   -0.0001
   -0.0000   -0.0000    0.0014    0.0006    0.0005
   -0.0000   -0.0000    0.0006    0.0034    0.0007
   -0.0002   -0.0001    0.0005    0.0007    0.0064

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 49 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.278897e+04    0.000e+00    2.626e+03
User objective function returned Inf; trying a new point...
    1      39    1.007928e+04    0.000e+00    4.620e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.539872e+03    0.000e+00    9.375e+02    9.999e-01
User objective function returned Inf; trying a new point...
    3      81    8.433636e+03    0.000e+00    1.229e+03    4.999e-01
User objective function returned Inf; trying a new point...
    4      99    8.356302e+03    0.000e+00    1.330e+03    4.999e-01
User objective function returned Inf; trying a new point...
    5     121    8.283040e+03    0.000e+00    2.634e+02    4.999e-01
User objective function returned Inf; trying a new point...
    6     141    8.281457e+03    0.000e+00    2.565e+02    2.500e-01
User objective function returned Inf; trying a new point...
    7     162    8.227503e+03    0.000e+00    1.441e+02    4.999e-01
User objective function returned Inf; trying a new point...
    8     181    8.218331e+03    0.000e+00    7.941e+02    4.999e-01
User objective function returned Inf; trying a new point...
    9     203    8.199396e+03    0.000e+00    1.137e+02    5.000e-01
User objective function returned Inf; trying a new point...
   10     225    8.172224e+03    0.000e+00    1.785e+02    5.000e-01
User objective function returned Inf; trying a new point...
   11     245    8.161685e+03    0.000e+00    1.455e+02    2.500e-01
User objective function returned Inf; trying a new point...
   12     266    8.143041e+03    0.000e+00    4.614e+02    4.999e-01
User objective function returned Inf; trying a new point...
   13     285    8.135345e+03    0.000e+00    5.188e+02    4.999e-01
User objective function returned Inf; trying a new point...
   14     306    8.108997e+03    0.000e+00    1.555e+02    9.999e-01
User objective function returned Inf; trying a new point...
   15     325    8.098363e+03    0.000e+00    2.519e+02    9.999e-01
User objective function returned Inf; trying a new point...
   16     347    8.022380e+03    0.000e+00    1.721e+02    9.999e-01
User objective function returned Inf; trying a new point...
   17     367    8.020064e+03    0.000e+00    2.213e+02    4.999e-01
User objective function returned Inf; trying a new point...
   18     388    7.983747e+03    0.000e+00    2.573e+02    9.999e-01
User objective function returned Inf; trying a new point...
   19     411    7.983287e+03    0.000e+00    1.440e+02    5.000e-01
User objective function returned Inf; trying a new point...
   20     432    7.976879e+03    0.000e+00    5.747e+01    4.999e-01
User objective function returned Inf; trying a new point...
   21     452    7.975137e+03    0.000e+00    1.384e+02    1.250e-01
User objective function returned Inf; trying a new point...
   22     473    7.964747e+03    0.000e+00    1.026e+02    2.500e-01
User objective function returned Inf; trying a new point...
   23     492    7.963760e+03    0.000e+00    6.673e+01    2.500e-01
   24     515    7.960934e+03    0.000e+00    3.771e+01    1.250e-01
User objective function returned Inf; trying a new point...
   25     540    7.960584e+03    0.000e+00    3.864e+01    5.468e-02
   26     560    7.960526e+03    0.000e+00    4.535e+01    2.734e-02
   27     581    7.960301e+03    0.000e+00    2.445e+01    5.468e-02
   28     601    7.960229e+03    0.000e+00    2.574e+01    2.734e-02
   29     620    7.960196e+03    0.000e+00    2.163e+01    2.543e-02
   30     641    7.959612e+03    0.000e+00    5.732e+01    5.086e-02

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     663    7.958761e+03    0.000e+00    3.087e+01    5.086e-02
   32     686    7.958434e+03    0.000e+00    4.150e+01    8.901e-02
   33     706    7.958393e+03    0.000e+00    4.485e+01    3.693e-02
   34     728    7.958203e+03    0.000e+00    1.507e+01    3.693e-02
   35     750    7.958179e+03    0.000e+00    1.180e+01    3.693e-02
   36     769    7.958150e+03    0.000e+00    9.715e+00    1.847e-02
   37     787    7.958088e+03    0.000e+00    9.293e+00    2.379e-02
   38     805    7.958042e+03    0.000e+00    2.984e+00    2.463e-02
   39     822    7.958039e+03    0.000e+00    2.018e-01    3.794e-03
   40     839    7.958039e+03    0.000e+00    1.704e-01    6.585e-04
   41     856    7.958039e+03    0.000e+00    3.188e-02    1.321e-04

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',7.908671e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 1.7736 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

    0.0170
    0.0278
    0.0047
    0.0045
    0.0079
    0.0054
    0.0319
   -0.0009
   -0.0025
   -0.0004
   -0.0013
   -0.0023
   -0.0008
   -0.0029
    0.0001
    0.0013

Value of the log-likelihood function at convergence: -7958.0385
 
                      AIC                      BIC
              ------------------   -----------------------
                  15948.0770               16018.4279
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 3.6431e-07
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS          0.6876     0.0546    12.5892
A_SnGo         0.2354     0.0363     6.4882
A_AgeLT40      0.1273     0.0525     2.4259
A_ExpLT8       0.6526     0.0569    11.4706
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1          -0.9278     0.1176    -7.8929
Bc_2          -0.9908     0.1182    -8.3817
LV_Load        0.9443     0.0454    20.7900
Mu_12         -0.6746     0.0584   -11.5514
Mu_13         -0.7139     0.0566   -12.6087
Mu_14         -0.8347     0.0595   -14.0199
Mu_22         -0.4393     0.0498    -8.8130
Mu_23         -0.4561     0.0487    -9.3586
Mu_24         -0.8470     0.0609   -13.9047
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -0.8262     0.0341   -24.2518
C_VRC         -0.4836     0.0542    -8.9249
C_LV          -0.5734     0.0812    -7.0622
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    1.8917    0.8917
    0.8917    1.8917

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

    0.6876    0.2354    0.1273    0.6526   -0.9278   -0.9908    0.9443   -0.6746   -0.7139   -0.8347   -0.4393

  Columns 12 through 16

   -0.4561   -0.8470   -0.8262   -0.4836   -0.5734

The covariance matrix for these parameters is:

ihess =

  Columns 1 through 11

    0.0030    0.0001    0.0000    0.0005   -0.0038   -0.0038   -0.0009   -0.0003   -0.0003   -0.0003   -0.0002
    0.0001    0.0013    0.0002    0.0001   -0.0022   -0.0022   -0.0004   -0.0001   -0.0001   -0.0001   -0.0001
    0.0000    0.0002    0.0028    0.0001   -0.0015   -0.0014   -0.0001   -0.0000   -0.0001   -0.0000   -0.0001
    0.0005    0.0001    0.0001    0.0032   -0.0009   -0.0008   -0.0010   -0.0004   -0.0003   -0.0003   -0.0003
   -0.0038   -0.0022   -0.0015   -0.0009    0.0138    0.0125   -0.0006    0.0004   -0.0001   -0.0001   -0.0004
   -0.0038   -0.0022   -0.0014   -0.0008    0.0125    0.0140   -0.0007   -0.0006   -0.0007   -0.0006    0.0005
   -0.0009   -0.0004   -0.0001   -0.0010   -0.0006   -0.0007    0.0021    0.0009    0.0009    0.0008    0.0007
   -0.0003   -0.0001   -0.0000   -0.0004    0.0004   -0.0006    0.0009    0.0034    0.0000    0.0002    0.0003
   -0.0003   -0.0001   -0.0001   -0.0003   -0.0001   -0.0007    0.0009    0.0000    0.0032    0.0001    0.0004
   -0.0003   -0.0001   -0.0000   -0.0003   -0.0001   -0.0006    0.0008    0.0002    0.0001    0.0035    0.0003
   -0.0002   -0.0001   -0.0001   -0.0003   -0.0004    0.0005    0.0007    0.0003    0.0004    0.0003    0.0025
   -0.0003   -0.0001   -0.0000   -0.0003   -0.0005   -0.0001    0.0009    0.0004    0.0004    0.0004    0.0001
   -0.0003   -0.0002   -0.0001   -0.0003   -0.0004   -0.0002    0.0009    0.0004    0.0004    0.0004    0.0002
    0.0000   -0.0000    0.0000    0.0001   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.0000
    0.0000   -0.0001   -0.0000    0.0000   -0.0000   -0.0000    0.0001    0.0000   -0.0000    0.0000    0.0000
    0.0023    0.0005    0.0001    0.0004   -0.0033   -0.0032   -0.0010   -0.0004   -0.0003   -0.0004   -0.0003

  Columns 12 through 16

   -0.0003   -0.0003    0.0000    0.0000    0.0023
   -0.0001   -0.0002   -0.0000   -0.0001    0.0005
   -0.0000   -0.0001    0.0000   -0.0000    0.0001
   -0.0003   -0.0003    0.0001    0.0000    0.0004
   -0.0005   -0.0004   -0.0000   -0.0000   -0.0033
   -0.0001   -0.0002   -0.0000   -0.0000   -0.0032
    0.0009    0.0009   -0.0000    0.0001   -0.0010
    0.0004    0.0004   -0.0000    0.0000   -0.0004
    0.0004    0.0004   -0.0000   -0.0000   -0.0003
    0.0004    0.0004   -0.0000    0.0000   -0.0004
    0.0001    0.0002   -0.0000    0.0000   -0.0003
    0.0024    0.0000   -0.0000   -0.0000   -0.0003
    0.0000    0.0037   -0.0000   -0.0000   -0.0004
   -0.0000   -0.0000    0.0012    0.0005    0.0003
   -0.0000   -0.0000    0.0005    0.0029    0.0005
   -0.0003   -0.0004    0.0003    0.0005    0.0066

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
**** Integrated Choice & latent Variable Model (ICLV) ****
-------> For Sample ID: 50 
Start estimation
The negative of the log-likelihood is minimized,
which is the same as maximizing the log-likelihood.
                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
    0      17    1.177069e+04    0.000e+00    1.988e+03
User objective function returned Inf; trying a new point...
    1      39    1.053849e+04    0.000e+00    5.244e+03    2.000e+00
User objective function returned Inf; trying a new point...
    2      58    8.601952e+03    0.000e+00    3.965e+02    9.999e-01
User objective function returned Inf; trying a new point...
    3      80    8.512567e+03    0.000e+00    1.592e+03    9.999e-01
User objective function returned Inf; trying a new point...
    4      99    8.448945e+03    0.000e+00    1.255e+03    9.999e-01
User objective function returned Inf; trying a new point...
    5     121    8.370680e+03    0.000e+00    5.402e+02    9.999e-01
User objective function returned Inf; trying a new point...
    6     140    8.355984e+03    0.000e+00    2.926e+02    4.999e-01
User objective function returned Inf; trying a new point...
    7     162    8.243233e+03    0.000e+00    2.427e+02    5.000e-01
User objective function returned Inf; trying a new point...
    8     186    8.223334e+03    0.000e+00    5.075e+02    4.375e-01
User objective function returned Inf; trying a new point...
    9     205    8.208332e+03    0.000e+00    8.461e+02    4.375e-01
User objective function returned Inf; trying a new point...
   10     227    8.192834e+03    0.000e+00    6.143e+02    4.375e-01
User objective function returned Inf; trying a new point...
   11     247    8.188209e+03    0.000e+00    5.955e+02    2.187e-01
User objective function returned Inf; trying a new point...
   12     268    8.164369e+03    0.000e+00    5.270e+02    4.375e-01
User objective function returned Inf; trying a new point...
   13     287    8.158610e+03    0.000e+00    5.038e+02    2.187e-01
User objective function returned Inf; trying a new point...
   14     308    8.114376e+03    0.000e+00    1.290e+02    4.375e-01
User objective function returned Inf; trying a new point...
   15     328    8.111786e+03    0.000e+00    1.371e+02    2.187e-01
User objective function returned Inf; trying a new point...
   16     349    8.080882e+03    0.000e+00    1.127e+02    4.375e-01
User objective function returned Inf; trying a new point...
   17     372    8.051489e+03    0.000e+00    1.509e+02    7.655e-01
User objective function returned Inf; trying a new point...
   18     392    8.042259e+03    0.000e+00    1.973e+02    3.828e-01
User objective function returned Inf; trying a new point...
   19     415    8.038021e+03    0.000e+00    4.027e+02    1.914e-01
User objective function returned Inf; trying a new point...
   20     434    8.037469e+03    0.000e+00    4.071e+02    9.569e-02
   21     455    8.027871e+03    0.000e+00    1.635e+02    1.914e-01
User objective function returned Inf; trying a new point...
   22     475    8.027281e+03    0.000e+00    1.515e+02    9.569e-02
   23     496    8.020558e+03    0.000e+00    7.367e+01    1.914e-01
   24     519    8.019554e+03    0.000e+00    6.792e+01    3.349e-01
User objective function returned Inf; trying a new point...
   25     541    8.015334e+03    0.000e+00    5.956e+01    1.675e-01
User objective function returned Inf; trying a new point...
   26     564    8.014866e+03    0.000e+00    7.959e+01    8.373e-02
   27     584    8.014851e+03    0.000e+00    7.787e+01    2.093e-02
   28     604    8.013989e+03    0.000e+00    5.958e+01    1.142e-01
User objective function returned Inf; trying a new point...
   29     627    8.013224e+03    0.000e+00    2.791e+01    5.708e-02
   30     646    8.013190e+03    0.000e+00    2.374e+01    5.708e-02

                                            First-order      Norm of
 Iter F-count            f(x)  Feasibility   optimality         step
   31     668    8.012756e+03    0.000e+00    3.138e+01    5.708e-02
User objective function returned Inf; trying a new point...
   32     686    8.012564e+03    0.000e+00    3.877e+01    1.142e-01
   33     709    8.012100e+03    0.000e+00    3.235e+01    5.708e-02
   34     732    8.011867e+03    0.000e+00    1.061e+01    9.990e-02
User objective function returned Inf; trying a new point...
   35     752    8.011737e+03    0.000e+00    1.950e+01    4.995e-02
   36     769    8.011358e+03    0.000e+00    1.219e+01    7.674e-02
   37     786    8.011347e+03    0.000e+00    6.214e+00    1.436e-02
   38     803    8.011341e+03    0.000e+00    2.586e-01    9.180e-03
   39     820    8.011341e+03    0.000e+00    1.693e-02    6.745e-04
   40     837    8.011341e+03    0.000e+00    3.846e-03    1.583e-04

<a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'local_min_poss_with_constr','CSHelpWindow');">Local minimum possible. Constraints satisfied</a>.

fmincon stopped because the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'norm_curr_step_simple_fminconip','CSHelpWindow');">size of the current step</a> is less than
the selected value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'step_size_tol','CSHelpWindow');">step size tolerance</a> and constraints are 
satisfied to within the default value of the <a href = "matlab: helpview([docroot '/toolbox/optim/msg_csh/optim_msg_csh.map'],'constraint_tolerance','CSHelpWindow');">constraint tolerance</a>.

<<a href = "matlab: createExitMsg('barrier',2.000000e+00,true,true,'fmincon',9.617861e-05,'selected',1.000000e-04,0.000000e+00,'default',1.000000e-06,0.000000e+00,'',0.000000e+00);">stopping criteria details</a>>

 
Estimation took 1.7447 minutes.
 
Convergence achieved by criterion based on change in parameters.
Parameters changed less than PARAMTOL= 0.0001
You might want to check whether this is actually convergence.
The gradient vector is

grad =

   -0.0005
    0.0038
    0.0013
    0.0026
    0.0009
   -0.0005
    0.0035
   -0.0022
   -0.0004
    0.0004
   -0.0014
   -0.0008
   -0.0010
    0.0003
    0.0001
   -0.0015

Value of the log-likelihood function at convergence: -8011.3406
 
                      AIC                      BIC
              ------------------   -----------------------
                  16054.6812               16125.0321
 
 
Taking inverse of hessian for standard errors.
 
The value of grad*inv(hessian)*grad is: 7.3367e-08
 
-------------------------------------------------------------------
     RESULTS FROM THE INTEGRATED CHOICE & LATENT VARIABLE MODEL 
-------------------------------------------------------------------
 
 
STRUCTURAL MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
A_TTS          0.6479     0.0454    14.2842
A_SnGo         0.0768     0.0339     2.2658
A_AgeLT40      0.4121     0.0500     8.2415
A_ExpLT8       0.5250     0.0519    10.1097
 
 
 
 
MEASUREMENT MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
Bc_1          -1.1475     0.1269    -9.0457
Bc_2          -1.2634     0.1274    -9.9135
LV_Load        1.1478     0.0512    22.4378
Mu_12         -0.3024     0.0495    -6.1103
Mu_13         -0.7888     0.0615   -12.8174
Mu_14         -0.6052     0.0576   -10.5078
Mu_22         -0.4234     0.0525    -8.0594
Mu_23         -0.5779     0.0556   -10.3955
Mu_24         -0.5595     0.0589    -9.5011
 
 
** The first threshold point is normalised to ZERO because a constant term is getting estimated. 
 
 
 
 
CHOICE MODEL
 
                    Coeffs      
              ------------------ 
                Est         SE       Z-Stat 
C_TT          -0.8001     0.0327   -24.4865
C_VRC         -0.4740     0.0548    -8.6482
C_LV          -0.3137     0.0847    -3.7016
 
 
ESTIMATED VARIANCE COVARIANCE MATRIX.
 
Measurement Model
 

vcmatrix =

    2.3176    1.3176
    1.3176    2.3176

 
 
ESTIMATED PARAMETERS AND FULL COVARIANCE MATRIX.
The estimated values of the parameters are:

paramhat =

  Columns 1 through 11

    0.6479    0.0768    0.4121    0.5250   -1.1475   -1.2634    1.1478   -0.3024   -0.7888   -0.6052   -0.4234

  Columns 12 through 16

   -0.5779   -0.5595   -0.8001   -0.4740   -0.3137

The covariance matrix for these parameters is:

ihess =

  Columns 1 through 11

    0.0021   -0.0001    0.0000    0.0001   -0.0030   -0.0030   -0.0006   -0.0002   -0.0003   -0.0002   -0.0002
   -0.0001    0.0011    0.0002   -0.0000   -0.0023   -0.0022   -0.0001   -0.0001    0.0000   -0.0000   -0.0001
    0.0000    0.0002    0.0025    0.0003   -0.0012   -0.0013   -0.0005   -0.0002   -0.0001   -0.0001   -0.0002
    0.0001   -0.0000    0.0003    0.0027   -0.0009   -0.0010   -0.0007   -0.0002   -0.0002   -0.0001   -0.0002
   -0.0030   -0.0023   -0.0012   -0.0009    0.0161    0.0147   -0.0015    0.0001   -0.0003   -0.0006   -0.0008
   -0.0030   -0.0022   -0.0013   -0.0010    0.0147    0.0162   -0.0016   -0.0008   -0.0008   -0.0009    0.0000
   -0.0006   -0.0001   -0.0005   -0.0007   -0.0015   -0.0016    0.0026    0.0011    0.0010    0.0011    0.0011
   -0.0002   -0.0001   -0.0002   -0.0002    0.0001   -0.0008    0.0011    0.0024    0.0001    0.0002    0.0005
   -0.0003    0.0000   -0.0001   -0.0002   -0.0003   -0.0008    0.0010    0.0001    0.0038    0.0001    0.0004
   -0.0002   -0.0000   -0.0001   -0.0001   -0.0006   -0.0009    0.0011    0.0002    0.0001    0.0033    0.0004
   -0.0002   -0.0001   -0.0002   -0.0002   -0.0008    0.0000    0.0011    0.0005    0.0004    0.0004    0.0028
   -0.0002   -0.0000   -0.0001   -0.0002   -0.0008   -0.0004    0.0011    0.0005    0.0005    0.0004    0.0002
   -0.0002   -0.0001   -0.0003   -0.0003   -0.0006   -0.0004    0.0012    0.0005    0.0005    0.0005    0.0002
   -0.0001    0.0000    0.0000    0.0001    0.0001    0.0000    0.0000    0.0000    0.0000   -0.0000   -0.0000
   -0.0001    0.0000    0.0000    0.0001    0.0001    0.0000    0.0000   -0.0000    0.0001    0.0000   -0.0001
    0.0010   -0.0000   -0.0001   -0.0001   -0.0015   -0.0014   -0.0002   -0.0001   -0.0001   -0.0001   -0.0000

  Columns 12 through 16

   -0.0002   -0.0002   -0.0001   -0.0001    0.0010
   -0.0000   -0.0001    0.0000    0.0000   -0.0000
   -0.0001   -0.0003    0.0000    0.0000   -0.0001
   -0.0002   -0.0003    0.0001    0.0001   -0.0001
   -0.0008   -0.0006    0.0001    0.0001   -0.0015
   -0.0004   -0.0004    0.0000    0.0000   -0.0014
    0.0011    0.0012    0.0000    0.0000   -0.0002
    0.0005    0.0005    0.0000   -0.0000   -0.0001
    0.0005    0.0005    0.0000    0.0001   -0.0001
    0.0004    0.0005   -0.0000    0.0000   -0.0001
    0.0002    0.0002   -0.0000   -0.0001   -0.0000
    0.0031    0.0001   -0.0000   -0.0000   -0.0001
    0.0001    0.0035   -0.0000   -0.0000   -0.0001
   -0.0000   -0.0000    0.0011    0.0005   -0.0000
   -0.0000   -0.0000    0.0005    0.0030    0.0001
   -0.0001   -0.0001   -0.0000    0.0001    0.0072

 
You can access the estimated parameters as variable paramhat,
the gradient of the negative of the log-likelihood function as variable grad,
the hessian of the negative of the log-likelihood function as variable hessian,
and the inverse of the hessian as variable ihess.
The hessian is calculated by the BFGS updating procedure.
Elapsed time is 104.697948 seconds.
 
**** Simulation Ended ****
Number of samples estimated: 50 
Execution time: 0.029083 hours.
